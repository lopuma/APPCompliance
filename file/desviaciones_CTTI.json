[
    {
        "modulo": "Protecting Resources-OSRs/Log File Restrictions",
        "clave": "WTMP",
        "descripcion": "Invalid Permissions or Ownership for log file: /var/log/wtmp;   -rw-rw-r--.;  owner:  root;   group:  utmp. For more information see rule description.",
        "comprobacion": "## Se le debe quitar W al grupo.",
        "copia": "",
        "editar": "+-------------------------------------------------------------------------------+\n## Quitar permisos\n+-------------------------------------------------------------------------------+\n\nchmod g-w /var/log/wtmp\n\n+-------------------------------------------------------------------------------+\n## Dejar esta linea para REHL 7:\n+-------------------------------------------------------------------------------+\n\n## Editar:\n\nvi /lib/tmpfiles.d/var.conf\n\n## Debe quedar la linea asi:\n\nf /var/log/wtmp 0644 root utmp -\n\n+-------------------------------------------------------------------------------+\n## Dejar esta linea para REHL 6\n+-------------------------------------------------------------------------------+\n\n## Editar:\n\nvi /etc/rc.sysinit\n\n## Dejar la linea asi:\n\nchmod 0644 /var/run/utmp /var/log/wtmp",
        "refrescar": "",
        "evidencia": "clear\ndate\nhostname\nls -la /var/log/wtmp\ncat /lib/tmpfiles.d/var.conf | grep -w wtmp",
        "SO": "Linux"
    },
    {
        "modulo": "Protecting Resources -OSRs/006 Alert logs",
        "clave": "006",
        "descripcion": "Instance:$INSTANCE. File \"$filebdd\":-Wrong group: oinstall. Must be owned by oracle/dba and permissions no more than \"rw-r-----\"",
        "comprobacion": "+-------------------------------------------------------------------------------+\n## Donde $INSTANCE, es la instancia de la bases de datos a revisar.\n## Donde $filebdd, es el fichero a corregir los permisos.\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Se debe cambiar el owner y el grupo a:\n+-------------------------------------------------------------------------------+\n## Owner : oradb\n## Grupo : asmadmin\n\n# Quitar permisos de lectura a other\n\n+-------------------------------------------------------------------------------+\n## Buscar y listar ficheros con grupo oinstall, y con permisos de lectura en other\n## - Guardar el directorio, de los ficheros a modificar permisos.\n+-------------------------------------------------------------------------------+\n\n## Ejemplo\n\nfilebdd=\"/u01/app/oracle/product/19.0.0/db_1/rdbms/log/\"\n\n## FORMA RECURSIVA\n+-------------------------------------------------------------------------------+\n## Comprobar cuantos ficheros existen con grupo oinstall\n## Comprobar cuantos ficheros existen con permisos de lectura en other\n+-------------------------------------------------------------------------------+\n\nfind $filebdd -type f -group oinstall | wc -l\nfind $filebdd -type f -perm -o=r | wc -l\n\n+-------------------------------------------------------------------------------+\n## Listar los ficheros con grupo oinstall\n## Listar los ficheros con permisos de lectura en other\n+-------------------------------------------------------------------------------+\n\nfind $filebdd -type f -group oinstall | xargs -l ls -la\nfind $filebdd -type f -perm -o=r | xargs -l ls -la\n\n\n## FORMA INDIVIDUAL\n+-------------------------------------------------------------------------------+\n## Comprobar / Listar cuantos ficheros existen con grupo oinstall\n## Comprobar / Listar cuantos ficheros existen con permisos de lectura en other\n+-------------------------------------------------------------------------------+\nls -la $filebdd",
        "copia": "",
        "editar": "+-------------------------------------------------------------------------------+\n## De forma INDIVIDUAL\n+-------------------------------------------------------------------------------+\nchown oradb:asmadmin $filebdd\nchmod o-r $filebdd/*\n\n+-------------------------------------------------------------------------------+\n## De forma RECURSIVA\n+-------------------------------------------------------------------------------+\nfind  $filebdd -type f -group oinstall -exec chown oradb:asmadmin {} +\nfind  $filebdd -type f -perm -o=r -exec chmod o-r {} +\n",
        "refrescar": "",
        "evidencia": "+-------------------------------------------------------------------------------+\n## De forma INDIVIDUAL\n+-------------------------------------------------------------------------------+\nclear\ndate\nhostname\nls -la $filebdd\n\n+-------------------------------------------------------------------------------+\n## De forma RECURSIVA\n+-------------------------------------------------------------------------------+\nclear\ndate\nhostname\nfind $filebdd -type f -group oinstall | wc -l\nfind $filebdd -type f -perm -o=r | wc -l\nls -la $filebdd",
        "SO": "Bases de Datos"
    },
    {
        "modulo": "Protecting Resources -OSRs/014 LISTENER.ORA",
        "clave": "014",
        "descripcion": "Instance:$INSTANCE. File \"$filebdd\":-Wrong permission: rw-r--r--. Must be owned by oracle/dba and permissions \"rw-------\"",
        "comprobacion": "+-------------------------------------------------------------------------------+\n## Donde $INSTANCE, es la instancia de la bases de datos a revisar.\n## Donde $filebdd, es el fichero a corregir los permisos.\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Se debe cambiar el owner y el grupo a:\n+-------------------------------------------------------------------------------+\n## Owner : oradb\n## Grupo : asmadmin\n\n# Quitar permisos de lectura a other\n\n+-------------------------------------------------------------------------------+\n## Buscar y listar ficheros con grupo oinstall, y con permisos de lectura en other\n## - Guardar el directorio, de los ficheros a modificar permisos.\n+-------------------------------------------------------------------------------+\n\n## Ejemplo\n\nfilebdd=\"/u01/app/oracle/product/19.0.0/db_1/network/admin/samples/\"\n\n## FORMA RECURSIVA\n+-------------------------------------------------------------------------------+\n## Comprobar cuantos ficheros existen con grupo oinstall\n## Comprobar cuantos ficheros existen con permisos de lectura en other\n+-------------------------------------------------------------------------------+\n\nfind $filebdd -type f -group oinstall | wc -l\nfind $filebdd -type f -perm -o=r | wc -l\n\n+-------------------------------------------------------------------------------+\n## Listar los ficheros con grupo oinstall\n## Listar los ficheros con permisos de lectura en other\n+-------------------------------------------------------------------------------+\n\nfind $filebdd -type f -group oinstall | xargs -l ls -la\nfind $filebdd -type f -perm -o=r | xargs -l ls -la\n\n\n## FORMA INDIVIDUAL\n+-------------------------------------------------------------------------------+\n## Comprobar / Listar cuantos ficheros existen con grupo oinstall\n## Comprobar / Listar cuantos ficheros existen con permisos de lectura en other\n+-------------------------------------------------------------------------------+\nls -la $filebdd\n",
        "copia": "",
        "editar": "+-------------------------------------------------------------------------------+\n## De forma INDIVIDUAL\n+-------------------------------------------------------------------------------+\nchown oradb:asmadmin $filebdd\nchmod o-r $filebdd/*\n\n+-------------------------------------------------------------------------------+\n## De forma RECURSIVA\n+-------------------------------------------------------------------------------+\nfind  $filebdd -type f -group oinstall -exec chown oradb:asmadmin {} +\nfind  $filebdd -type f -perm -o=r -exec chmod o-r {} +",
        "refrescar": "",
        "evidencia": "+-------------------------------------------------------------------------------+\n## De forma INDIVIDUAL\n+-------------------------------------------------------------------------------+\nclear\ndate\nhostname\nls -la $filebdd\n\n+-------------------------------------------------------------------------------+\n## De forma RECURSIVA\n+-------------------------------------------------------------------------------+\nclear\ndate\nhostname\nfind $filebdd -type f -group oinstall | wc -l\nfind $filebdd -type f -perm -o=r | wc -l\nls -la $filebdd",
        "SO": "Bases de Datos"
    }
]
[
    {
        "modulo": "Protecting Resources-OSRs/Log File Restrictions",
        "clave": "WTMP",
        "descripcion": "Invalid Permissions or Ownership for log file: /var/log/wtmp;   -rw-rw-r--.;  owner:  root;   group:  utmp. For more information see rule description.",
        "comprobacion": "## Se le debe quitar W al grupo.\n\n+-------------------------------------------------------------------------------+\n## Comprobar que en logrotate.conf, tenga permisosa 0644\n+-------------------------------------------------------------------------------+\n\ncat /etc/logrotate.conf | grep -w wtmp -A4",
        "copia": "## Obtener usuario logueado:\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------+\n\ncp -p /etc/logrotate.conf /home/${user^^}/logrotate.conf_`date +%d%m%y`\n\n+-------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------+\n\ncp -p /etc/logrotate.conf /home/${user,,}/logrotate.conf_`date +%d%m%y`",
        "editar": "+-------------------------------------------------------------------------------+\n## Quitar permisos\n+-------------------------------------------------------------------------------+\n\nchmod g-w /var/log/wtmp\n\n+-------------------------------------------------------------------------------+\n## Dejar esta linea para REHL 7:\n+-------------------------------------------------------------------------------+\n\n## Editar:\n\nvi /lib/tmpfiles.d/var.conf\n\n## Debe quedar la linea asi:\n\nf /var/log/wtmp 0644 root utmp -\n\n+-------------------------------------------------------------------------------+\n## Dejar esta linea para REHL 6\n+-------------------------------------------------------------------------------+\n\n## Editar:\n\nvi /etc/rc.sysinit\n\n## Dejar la linea asi:\n\nchmod 0644 /var/run/utmp /var/log/wtmp\n\n+-------------------------------------------------------------------------------+\n## Corregir los permisos en logrotate.conf, en create de wtmp\n+-------------------------------------------------------------------------------+\n\nvi /etc/logrotate.conf\n\n+-------------------------------------------------------------------------------+\n## Modificar los permisos de 0664, a 0644, al fichero /var/log/wtmp\n+-------------------------------------------------------------------------------+",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\nls -la /var/log/wtmp\ncat /lib/tmpfiles.d/var.conf | grep -w wtmp\ncat /etc/logrotate.conf | grep -w wtmp -A4",
        "SO": "Linux"
    },
    {
        "modulo": "Business Use Notice/Business Use Notice Required",
        "clave": "BUN",
        "descripcion": "Missing or Incorrect Business Use Notice. It should be set in /etc/motd",
        "comprobacion": "##Debe tener el BUN actual.",
        "copia": null,
        "editar": "vi /etc/motd\n\n+-------------------------------------------------------------------------------+\n##añadir / remplazar :\n+-------------------------------------------------------------------------------+\n\n*******************************************************************************\n*                                                                             *\n*                                                                             *\n* Asisa systems must only be used for conducting Asisa business or            * \n* for purposes authorized by Asisa management.                                *\n*                                                                             *\n*                                                                             *\n*******************************************************************************",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\ncat /etc/motd",
        "SO": "Linux / Aix"
    },
    {
        "modulo": "Logging/Synchronized system clocks",
        "clave": " XNTPD",
        "descripcion": "xntpd must be running",
        "comprobacion": "",
        "copia": "",
        "editar": "",
        "refrescar": "",
        "evidencia": "",
        "SO": "Aix"
    },
    {
        "modulo": "Password Requirements/Password histexpire - System Default",
        "clave": "HISTEXPIRE",
        "descripcion": "Invalid system default histexpire set to 0, must be not less than 105",
        "comprobacion": "",
        "copia": "",
        "editar": "",
        "refrescar": "",
        "evidencia": "",
        "SO": "Aix"
    },
    {
        "modulo": "Password Requirements/Password MAX Age",
        "clave": "MAXAGE",
        "descripcion": null,
        "comprobacion": null,
        "copia": null,
        "editar": null,
        "refrescar": null,
        "evidencia": null,
        "SO": "Aix"
    },
    {
        "modulo": "Password Requirements/Password MIN Length - System Default",
        "clave": "MINLENGTH",
        "descripcion": "Invalid Password Min Length setting of 8, should be not less than 15",
        "comprobacion": null,
        "copia": null,
        "editar": null,
        "refrescar": null,
        "evidencia": null,
        "SO": "Aix"
    },
    {
        "modulo": "Password Requirements/Password mindiff - System Default",
        "clave": "MINDIFF",
        "descripcion": "Invalid system default mindiff set to 1, must be not less than 4",
        "comprobacion": null,
        "copia": null,
        "editar": null,
        "refrescar": null,
        "evidencia": null,
        "SO": "Aix"
    },
    {
        "modulo": "Password Requirements/Requirement for pwd_algorithm",
        "clave": "PWD_ALGORITHM",
        "descripcion": "Incorrect or missing value of \"pwd_algorithm\" in /etc/security/login.cfg. It Must be set to ssha512",
        "comprobacion": "",
        "copia": "",
        "editar": "",
        "refrescar": "",
        "evidencia": "",
        "SO": "Aix"
    },
    {
        "modulo": "Protecting Resources-OSRs/CRON Command Group Permissions",
        "clave": "OSRCRON",
        "descripcion": "Invalid permissions for CRON command: $fileCRON, Permissions: -rwxrwxr-x, Group: $grupo, Permissions for GROUP must be set to r-x or more stringent if owned by group not considered as privileged (see Allowed Groups policy parameter).",
        "comprobacion": "+-------------------------------------------------------------------------------+\n## El desvio trata de quitarle W a GROUP, a los ficheros / directorios, que se ejecutan en CRON\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Hay que tener en cuenta el tipo de owner que pertenece, cada fichero o directorio BASE.\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Ya sea de tipo '/C/F/S'\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Si es /C/, se pasa a excepcion con RISK e IMPACT\n## por favor revisar la seccion de RISK e IMPACT\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Si es de tipo /F/S/, se debe preguntar al owner, si podemos modificar los permisos\n## Revisar ('PERMISSIONS'), antes de cualquier cambio.\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Buscar y comprobar los fichero y directorios a cambiar permisos. \n+-------------------------------------------------------------------------------+\n\n## FICHERO / DIRECTORIO DEL CRON:\n---\nls -ld $directory\nls -l $fileCRON",        
        "copia": "",
        "editar": "",
        "refrescar": "",
        "evidencia": "",
        "SO": "Aix"
    },
    {
        "modulo": "Protecting Resources-OSRs/CRON Command WW Permissions",
        "clave": "OSRsCRON",
        "descripcion": "Invalid permissions or ownership for CRON command: $fileCRON, Permissions: -rwxrwxr-x, Group: $grupo, Owner: $usuario, Permissions for OTHER must be set to r-x or more stringent. Must have allowed owner (see policy parameters: Allowed Owners + Allowed Groups members).",
        "comprobacion": "+-------------------------------------------------------------------------------+\n## El desvio trata de quitarle permisos w a OTHER o cambiar el owner, a los ficheros / directorios, de los mandatos que se ejecutan en CRON.\n## (consulte los parámetros de política: Propietarios permitidos + Miembros de grupos permitidos).\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Hay que tener en cuenta el tipo de owner que pertenece, cada fichero o directorio BASE.\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Ya sea de tipo '/C/F/S'\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Si es /C/, se pasa a excepcion con RISK e IMPACT\n## por favor revisar la seccion de RISK e IMPACT\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Si es de tipo /F/S/, se debe preguntar al owner, si podemos modificar los permisos\n## Revisar ('PERMISSIONS'), antes de cualquier cambio.\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Buscar y comprobar los fichero y directorios a cambiar permisos. \n+-------------------------------------------------------------------------------+\n\n## FICHERO / DIRECTORIO DEL CRON:\n---\nls -ld $directory\nls -l $fileCRON",
        "copia": null,
        "editar": null,
        "refrescar": null,
        "evidencia": null,
        "SO": "Aix"
    },
    {
        "modulo": "Protecting Resources-OSRs/OSR /var/adm/cron files restrictions",
        "clave": "",
        "descripcion": "/var/adm/cron/XXXXX, Owner: root, Group: sys, Permissions: -rw-r--r---, must be --- for other. Should be owned by privileged owner and group.",
        "comprobacion": "",
        "copia": "",
        "editar": "",
        "refrescar": "",
        "evidencia": "",
        "SO": "Aix"
    },
    {
        "modulo": "Protecting Resources-OSRs/OSR /var/ct/RMstart.log restrictions",
        "clave": "",
        "descripcion": "/var/ct/XXXXX, Owner: root, Group: system, Permissions: 0644, must be 640 or more restrictive. Should be owned by privileged owner and group.",
        "comprobacion": "",
        "copia": "",
        "editar": "",
        "refrescar": "",
        "evidencia": "",
        "SO": "Aix"
    },
    {
        "modulo": "Protecting Resources-OSRs/OSR /var/spool/cron/crontabs files restrictions",
        "clave": "",
        "descripcion": "/var/spool/cron/crontabs/XXXXX, Owner: $usuario, Group: $grupo, Permissions: -rw-r--r---, settings for other must be --- (0).",
        "comprobacion": "",
        "copia": "",
        "editar": "",
        "refrescar": "",
        "evidencia": "",
        "SO": "Aix"
    },
    {
        "modulo": "Protecting Resources-OSRs/smit.transaction Restrictions",
        "clave": "",
        "descripcion": "Invalid Permissions or Ownership for File: /home/root/smit.transaction, Owner: root, Text Permissions: -rw-r--r---, must only be readable or writeable by root. Should be owned by root.",
        "comprobacion": "",
        "copia": "",
        "editar": "",
        "refrescar": "",
        "evidencia": "",
        "SO": "Aix"
    },
    {
        "modulo": "Network Settings//etc/inetd.conf - exec",
        "clave": "ENTRY EXEC",
        "descripcion": "exec entry must be removed or disabled in /etc/inetd.conf",
        "comprobacion": null,
        "copia": null,
        "editar": null,
        "refrescar": null,
        "evidencia": null,
        "SO": "Aix"
    },
    {
        "modulo": "Network Settings//etc/inetd.conf - ntalk",
        "clave": "ENTRY NTALK",
        "descripcion": "ntalk entry must be removed or disabled in /etc/inetd.conf",
        "comprobacion": null,
        "copia": null,
        "editar": null,
        "refrescar": null,
        "evidencia": null,
        "SO": "Aix"
    },
    {
        "modulo": "Network Settings//etc/inetd.conf - time",
        "clave": "ENTRY TIME",
        "descripcion": "time entry must be removed or disabled in /etc/inetd.conf",
        "comprobacion": null,
        "copia": null,
        "editar": null,
        "refrescar": null,
        "evidencia": null,
        "SO": "Aix"
    },
    {
        "modulo": "Network Settings//etc/inittab - piobe",
        "clave": "PIOBE",
        "descripcion": "File /etc/inittab have piobe service.",
        "comprobacion": null,
        "copia": null,
        "editar": null,
        "refrescar": null,
        "evidencia": null,
        "SO": "Aix"
    },
    {
        "modulo": "Network Settings//etc/inittab - qdaemon",
        "clave": "QDAEMON",
        "descripcion": "File /etc/inittab have qdaemon service.",
        "comprobacion": null,
        "copia": null,
        "editar": null,
        "refrescar": null,
        "evidencia": null,
        "SO": "Aix"
    },
    {
        "modulo": "Network Settings//etc/inittab - writesrv",
        "clave": "WRITESRV",
        "descripcion": "File /etc/inittab have writesrv service.",
        "comprobacion": null,
        "copia": null,
        "editar": null,
        "refrescar": null,
        "evidencia": null,
        "SO": "Aix"
    },
    {
        "modulo": "Network Settings/On syslog clients, disable remote message collection",
        "clave": "SYSLOGD",
        "descripcion": "syslogd must be run with the -r flag",
        "comprobacion": null,
        "copia": null,
        "editar": null,
        "refrescar": null,
        "evidencia": null,
        "SO": "Aix"
    },
    {
        "modulo": "Network Settings/tcpip aixmibd entry",
        "clave": "AIXMIBD",
        "descripcion": "Entry start /usr/sbin/aixmibd \"$src_running\" must be removed from /etc/rc.tcpip file",
        "comprobacion": null,
        "copia": null,
        "editar": null,
        "refrescar": null,
        "evidencia": null,
        "SO": "Aix"
    },
    {
        "modulo": "Network Settings/tcpip hostmibd entry",
        "clave": "HOSTMIBD",
        "descripcion": "Entry start /usr/sbin/hostmibd \"$src_running\" must be removed from /etc/rc.tcpip file",
        "comprobacion": null,
        "copia": null,
        "editar": null,
        "refrescar": null,
        "evidencia": null,
        "SO": "Aix"
    },
    {
        "modulo": "Network Settings/tcpip snmpmibd entry",
        "clave": "SNMPMIBD",
        "descripcion": "Entry start /usr/sbin/snmpmibd \"$src_running\" must be removed from /etc/rc.tcpip file",
        "comprobacion": null,
        "copia": null,
        "editar": null,
        "refrescar": null,
        "evidencia": null,
        "SO": "Aix"
    },
    {
        "modulo": "Network Settings/tcpip snmpd entry",
        "clave": "SNMPD",
        "descripcion": "Entry start /usr/sbin/snmpd \"$src_running\" must be removed from /etc/rc.tcpip file",
        "comprobacion": null,
        "copia": null,
        "editar": null,
        "refrescar": null,
        "evidencia": null,
        "SO": "Aix"
    },
    {
        "modulo": "Protecting Resources-OSRs/OSR /etc/security files restrictions",
        "clave": "OSR /ETC/SECURITY",
        "descripcion": "$file,$directory en /ETC/SECURITY, Owner: root, Group: tdp, Permissions: drwxr-xr-x-, settings for other must be r-x or more stringent. Should be owned by privileged owner and group.",
        "comprobacion": "debe ser propieda de root y grupo root·\n## Relacionado con la pregunta: \n\n Protecting Resources-OSRs/OSR Directory Restrictions",
        "copia": null,
        "editar": null,
        "refrescar": null,
        "evidencia": null,
        "SO": "Aix"
    },
    {
        "modulo": "Protecting Resources-OSRs/OSR Directory Restrictions",
        "clave": "",
        "descripcion": "Invalid OSR ACL for /etc/security/adsm, Owner: root, Group: tdp, Permissions: drwxr-xr-x-, must not be world-writable or have incorrect ownership",
        "comprobacion": "debe ser propieda de root y grupo root·\n## Relacionado con la pregunta: \n\nProtecting Resources-OSRs/OSR /etc/security files restrictions",
        "copia": null,
        "editar": null,
        "refrescar": null,
        "evidencia": null,
        "SO": "Aix"
    },
    {
        "modulo": "Protecting Resources-OSRs/OSR /OPT Files Restrictions",
        "clave": "OSROPT",
        "descripcion": "Invalid permissions for $fileOPT, Octal permissions: 0777, Text Permissions: -rwxrwxrwx;  May not have execute permissions on any files and no write for others.",
        "comprobacion": "+-------------------------------------------------------------------------------+\n## Aplica a ficheros del directorio /OPT\n+-------------------------------------------------------------------------------+\n\n## El desvio trata de quitarle escritura a OTHER, a ficheros que tienen escritura y ejecucion que cuelgan en el directorio /OPT y sub-directorios.\n\n+-------------------------------------------------------------------------------+\n## Hay que tener en cuenta el tipo de owner que pertenece, cada fichero o directorio BASE.\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Ya sea de tipo '/C/F/S/'\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Si es /C/, se pasa a excepcion con RISK e IMPACT\n(Por favor revisar la seccion de RISK e IMPACT)\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Si es de tipo /F/S/, se debe preguntar al owner, si podemos modificar los permisos\n## Revisar ('PERMISSIONS'), antes de cualquier cambio.\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Buscar y comprobar los fichero a cambiar permisos.\n+-------------------------------------------------------------------------------+\n\n## FICHEROS FORMA RECURVISA:\n---\necho \"ficheros con permisos w en other : \";find $fileOPT -type f -perm -o=wx | wc -l\nfind $fileOPT -type f -perm -o=wx | xargs -l ls -l\n\n## FICHERO\n---\nls -l $fichero\n\n+-------------------------------------------------------------------------------+\n## Pregunta RELACIONADAS\n+-------------------------------------------------------------------------------+\n\nProtecting Resources-mixed/Ensure sticky bit is set on all world-writable directories",
        "copia": null,
        "editar": "+-------------------------------------------------------------------------------+\n## Se puede quitar de forma 'RECURSIVA' o por 'INDIVIDUAL'\n\n## VARIABLES:\n## $fileOPT : es la variable del directorio base de los ficheros a cambiar permisos.\n## $fichero : es la variable, del fichero a cambiar permiso.\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Asi quitamos de permisos de W a Other, en los ficheros('RECURSIVO'):\n+-------------------------------------------------------------------------------+\n\nfind $fileOPT -type f -perm -o=wx -exec chmod o-w {} \\;\n\n+-------------------------------------------------------------------------------+\n## Asi quitamos permisos, de W a other de forma('INDIVIDUAL'):\n+-------------------------------------------------------------------------------+\n\nchmod o-w $fichero",
        "refrescar": null,
        "evidencia": "+-------------------------------------------------------------------------------+\n## De forma ('RECURSIVA'):\n+-------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nfind $fileOPT -type f -perm -o=wx | wc -l\nls -ld $fileOPT\n\n+-------------------------------------------------------------------------------+\n## De forma('INDIVIDUAL'):\n+-------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -l $fichero",
        "SO": "Aix"
    },
    {
        "modulo": "Network Settings/default core dumps restriction",
        "clave": "CORE DUMPS",
        "descripcion": "core dumps should be disabled by default. Current settings: stanza=default, attribute=core, value=2097151\n\ncore dumps should be disabled by default. Current settings: stanza=default, attribute=core_hard, value=",
        "comprobacion": null,
        "copia": null,
        "editar": null,
        "refrescar": null,
        "evidencia": null,
        "SO": "Aix"
    },
    {
        "modulo": "Network Settings/X-server access control",
        "clave": "X-SERVER",
        "descripcion": "Fileset X11.apps.config must not own file /usr/lpp/X11/bin/xhost.",
        "comprobacion": null,
        "copia": null,
        "editar": null,
        "refrescar": null,
        "evidencia": null,
        "SO": "Aix"
    },
    {
        "modulo": "Protecting Resources-OSRs/OSR /TMP Files Restrictions",
        "clave": "OSRTMP",
        "descripcion": "Invalid permissions for $fileTMP  Octal permissions: 0777  Text Permissions: -rwxrwxrwx-;  May not have execute permissions on any files and no write for others.",
        "comprobacion": "+-------------------------------------------------------------------------------+\n## Aplica a ficheros del directorio /TMP\n+-------------------------------------------------------------------------------+\n\n## El desvio trata de quitarle escritura a OTHER, a ficheros que tienen escritura y ejecucion que cuelgan en el directorio /TMP y sub-directorios.\n\n+-------------------------------------------------------------------------------+\n## Hay que tener en cuenta el tipo de owner que pertenece, cada fichero o directorio BASE.\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Ya sea de tipo '/C/F/S/'\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Si es /C/, se pasa a excepcion con RISK e IMPACT\n(Por favor revisar la seccion de RISK e IMPACT)\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Si es de tipo /F/S/, si podemos modificar los permisos de W a OTHER\n## Revisar ('PERMISSIONS'), antes de cualquier cambio.\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Buscar y comprobar los fichero a cambiar permisos.\n+-------------------------------------------------------------------------------+\n\n## FICHEROS FORMA RECURVISA:\n---\necho \"ficheros con permisos W en OTHER : \";find /tmp/ -type f -perm -o=wx | wc -l\n\n##Listar\n\nfind /tmp/ -type f -perm -o=wx | xargs -l ls -l\n\n## FICHERO INDIVIDUAL\n---\nls -l /tmp/$fichero\n\n+-------------------------------------------------------------------------------+\n## Pregunta RELACIONADAS\n+-------------------------------------------------------------------------------+\n\nProtecting Resources-mixed/Ensure sticky bit is set on all world-writable directories",
        "copia": null,
        "editar": "+-------------------------------------------------------------------------------+\n## Se puede quitar de forma 'RECURSIVA' o por 'INDIVIDUAL'\n\n## VARIABLES:\n## $fichero : es la variable, del fichero a cambiar permiso.\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Asi quitamos de permisos de W a Other, en los ficheros('RECURSIVO'):\n+-------------------------------------------------------------------------------+\n\nfind /tmp/ -type f -perm -o=wx -exec chmod o-w {} \\;\n\n+-------------------------------------------------------------------------------+\n## Asi quitamos permisos, de W a other de forma('INDIVIDUAL'):\n+-------------------------------------------------------------------------------+\n\nchmod o-w $fichero",        
        "refrescar": null,
        "evidencia": "+-------------------------------------------------------------------------------+\n## De forma ('RECURSIVA'):\n+-------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nfind /tmp/ -type f -perm -o=wx | wc -l\nls -ld /tmp/\n\n+-------------------------------------------------------------------------------+\n## De forma('INDIVIDUAL'):\n+-------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -l $fichero",
        "SO": "Aix"
    },
    {
        "modulo": "Protecting Resources-OSRs/OSR /VAR Files Restrictions",
        "clave": "OSRVAR",
        "descripcion": "Invalid permissions for $fileVAR  Octal permissions: 0777  Text Permissions: -rwxrwxrwx;  May not have execute permissions on any files and no write for others.",
        "comprobacion": "+-------------------------------------------------------------------------------+\n## Aplica a ficheros del directorio /VAR\n+-------------------------------------------------------------------------------+\n\n## El desvio trata de quitarle escritura a OTHER, a ficheros que tienen escritura y ejecucion que cuelgan en el directorio /VAR y sub-directorios.\n\n+-------------------------------------------------------------------------------+\n## Hay que tener en cuenta el tipo de owner que pertenece, cada fichero o directorio BASE.\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Ya sea de tipo '/C/F/S/'\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Si es /C/, se pasa a excepcion con RISK e IMPACT\n(Por favor revisar la seccion de RISK e IMPACT)\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Si es de tipo /F/S/, se debe preguntar al owner, si podemos modificar los permisos\n## Revisar ('PERMISSIONS'), antes de cualquier cambio.\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Buscar y comprobar los fichero a cambiar permisos.\n+-------------------------------------------------------------------------------+\n\n## FICHEROS FORMA RECURVISA:\n---\necho \"ficheros con permisos w en other : \";find $fileVAR -type f -perm -o=wx | wc -l\nfind $fileVAR -type f -perm -o=wx | xargs -l ls -l\n\n## FICHERO\n---\nls -l $fichero\n\n+-------------------------------------------------------------------------------+\n## Pregunta RELACIONADAS\n+-------------------------------------------------------------------------------+\n\nProtecting Resources-mixed/Ensure sticky bit is set on all world-writable directories",        "copia": null,
        "editar": "+-------------------------------------------------------------------------------+\n## Se puede quitar de forma 'RECURSIVA' o por 'INDIVIDUAL'\n\n## VARIABLES:\n## $fileVAR : es la variable del directorio base de los ficheros a cambiar permisos.\n## $fichero : es la variable, del fichero a cambiar permiso.\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Asi quitamos de permisos de W a Other, en los ficheros('RECURSIVO'):\n+-------------------------------------------------------------------------------+\n\nfind $fileVAR -type f -perm -o=wx -exec chmod o-w {} \\;\n\n+-------------------------------------------------------------------------------+\n## Asi quitamos permisos, de W a other de forma('INDIVIDUAL'):\n+-------------------------------------------------------------------------------+\n\nchmod o-w $fichero",        
        "refrescar": null,
        "evidencia": "+-------------------------------------------------------------------------------+\n## De forma ('RECURSIVA'):\n+-------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nfind $fileVAR -type f -perm -o=wx | wc -l\nls -ld $fileVAR\n\n+-------------------------------------------------------------------------------+\n## De forma('INDIVIDUAL'):\n+-------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -l $fichero",        "SO": "Linux"
    },
    {
        "modulo": "Protecting Resources-OSRs/OSR /var/tmp/hostmibd.log restrictions",
        "clave": "OSRVARTMP",
        "descripcion": "/var/tmp/hostmibd.log, Owner: root, Group: system, Permissions: 0644, must be 640 or more restrictive. Should be owned by privileged owner and group.",
        "comprobacion": null,
        "copia": null,
        "editar": null,
        "refrescar": null,
        "evidencia": null,
        "SO": "Aix"
    },
    {
        "modulo": "Protecting Resources-OSRs/smit.log Restrictions",
        "clave": "SMIT.LOG",
        "descripcion": "Invalid Permissions or Ownership for File: /smit.log, Owner: root, Text Permissions: -rw-r--r---, must only be readable or writeable by root. Should be owned by root.",
        "comprobacion": null,
        "copia": null,
        "editar": null,
        "refrescar": null,
        "evidencia": null,
        "SO": "Aix"
    },
    {
        "modulo": "Protecting Resources-OSRs/smit.script Restrictions",
        "clave": "SMIT.SCRIPT",
        "descripcion": "Invalid Permissions or Ownership for File: /smit.script, Owner: root, Text Permissions: -rw-r--r---, must only be readable or writeable by root. Should be owned by root.",
        "comprobacion": null,
        "copia": null,
        "editar": null,
        "refrescar": null,
        "evidencia": null,
        "SO": "Aix"
    },
    {
        "modulo": "Protecting Resources-OSRs/smit.transaction Restrictions",
        "clave": "SMIT.TRANSACTION",
        "descripcion": "Invalid Permissions or Ownership for File: /smit.transaction, Owner: root, Text Permissions: -rw-r--r---, must only be readable or writeable by root. Should be owned by root.",
        "comprobacion": null,
        "copia": null,
        "editar": null,
        "refrescar": null,
        "evidencia": null,
        "SO": "Aix"
    },
    {
        "modulo": "Network Settings/Disable NIS client",
        "clave": "",
        "descripcion": "",
        "comprobacion": "",
        "copia": "",
        "editar": "",
        "refrescar": "",
        "evidencia": "",
        "SO": "Aix"
    },
    {
        "modulo": "protecting Resources-OSRs/SUDO Command WW Permissions",
        "clave": "COMMAND",
        "descripcion": "Invalid WW permissions for command file/directory: $fd_sudo  Permissions: drwxr-xrwx  Permissions for OTHER must be set to r-x or more stringent.",
        "comprobacion": "+-------------------------------------------------------------------------------+\n## Guardamos en la variable fd_sudo, el file/directory a cambiar permisos\n## Antes de seguir, buscar el file/directory en - * COMMAND * -\n+-------------------------------------------------------------------------------+\n\nfd_sudo=\"\"\n\n+-------------------------------------------------------------------------------+\n## Localizar la plantilla de SUDO, que tenga implementada el file/directory\n## Debemos mirar en la plantilla, si el file/directory, no se crean con los permisos de W en OTHER\n+-------------------------------------------------------------------------------+\n\ncd /etc/sudoers.d/\n\ngrep -irw $fd_sudo\n\n+-------------------------------------------------------------------------------+\n## Comprobar los permisos del file/directory:\n## No deben tener permisos de ESCRITURA en  OTHER\n## Si es de tipo /C/, se debe excepcionar: revisar RISK e IMPACT\n+-------------------------------------------------------------------------------+\n\nls -ld $fd_sudo",
        "copia": null,
        "editar": "+-------------------------------------------------------------------------------+\n## Quitar permisos de W a other al file/directory de SUDO\n+-------------------------------------------------------------------------------+\n\nchmod o-w $fd_sudo",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\nls -ld $fd_sudo",
        "SO": "Linux"
    },
    {
        "modulo": "Network Settings/Prohibited Processes",
        "clave": "INETD",
        "descripcion": "INETD Process pcnfsd prohibited if not required to support application\nRPC Process pcnfsd prohibited if not required to support application",
        "comprobacion": "",
        "copia": "",
        "editar": "",
        "refrescar": "",
        "evidencia": "",
        "SO": "Aix"
    }
]

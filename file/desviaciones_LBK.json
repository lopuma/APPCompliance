[
    {
        "modulo": "Protecting Resources-OSRs/Log File Restrictions",
        "clave": "WTMP",
        "descripcion": "Invalid Permissions or Ownership for log file: /var/log/wtmp;   -rw-rw-r--.;  owner:  root;   group:  utmp. For more information see rule description.",
        "comprobacion": "## Se le debe quitar W al grupo.\n\n+-------------------------------------------------------------------------------+\n## Comprobar que en logrotate.conf, tenga permisosa 0644\n+-------------------------------------------------------------------------------+\n\ncat /etc/logrotate.conf | grep -w wtmp -A4",
        "copia": "## Obtener usuario logueado:\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------+\n\ncp -p /etc/logrotate.conf /home/${user^^}/logrotate.conf_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------+\n\ncp -p /etc/logrotate.conf /home/${user,,}/logrotate.conf_`date +%d%m%y_%T`",
        "editar": "+-------------------------------------------------------------------------------+\n## Quitar permisos\n+-------------------------------------------------------------------------------+\n\nchmod g-w /var/log/wtmp\n\n+-------------------------------------------------------------------------------+\n## Dejar esta linea para REHL 7:\n+-------------------------------------------------------------------------------+\n\n## Editar:\n\nvi /lib/tmpfiles.d/var.conf\n\n## Debe quedar la linea asi:\n\nf /var/log/wtmp 0644 root utmp -\n\n+-------------------------------------------------------------------------------+\n## Dejar esta linea para REHL 6\n+-------------------------------------------------------------------------------+\n\n## Editar:\n\nvi /etc/rc.sysinit\n\n## Dejar la linea asi:\n\nchmod 0644 /var/run/utmp /var/log/wtmp\n\n+-------------------------------------------------------------------------------+\n## Corregir los permisos en logrotate.conf, en create de wtmp\n+-------------------------------------------------------------------------------+\n\nvi /etc/logrotate.conf\n\n+-------------------------------------------------------------------------------+\n## Modificar los permisos de 0664, a 0644, al fichero /var/log/wtmp\n+-------------------------------------------------------------------------------+",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\nls -la /var/log/wtmp\ncat /lib/tmpfiles.d/var.conf | grep -w wtmp\ncat /etc/logrotate.conf | grep -w wtmp -A4",
        "SO": "Linux"
    },
    {
        "modulo": "Business Use Notice/Business Use Notice Required",
        "clave": "BUN",
        "descripcion": "Missing or Incorrect Business Use Notice. It should be set in /etc/motd",
        "comprobacion": "##Debe tener el BUN actual.",
        "copia": null,
        "editar": "vi /etc/motd\n\n+-------------------------------------------------------------------------------+\n##añadir / remplazar :\n+-------------------------------------------------------------------------------+## CMOS\n+-------------------------------------------------------------------------------+\n\n+------------------------------------------------------------------------------+\n| Liberbank systems must only be used for conducting Liberbank business or for |\n| purposes authorized by Liberbank management                                  |\n| Use is subject to audit at any time by IBM management.                       |\n+------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## LINUX\n+-------------------------------------------------------------------------------+\n\n*    *-------------------------------------------------------------------*    *\n*    * Liberbank systems must only be used for conducting Liberbank      *    *\n*    * business or for purposes authorized by Liberbank management.      *    *\n*    *                                                                   *    *\n*    * It is mandatory to comply with all the requirements               *    *\n*    * listed in the applicable security policy and only process         *    *\n*    * or store the data classes approved for this asset type.           *    *\n*    *                                                                   *    *\n*    * Use is subject to audit at any time by IBM management.            *    *\n*    *                                                                   *    *\n*    *-------------------------------------------------------------------*    *",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\ncat /etc/motd",
        "SO": "Linux"
    },
    {
        "modulo": "Network Settings/Ensure nfs-utils is not enabled and active",
        "clave": "NFS",
        "descripcion": "Ensure nfs is not active. Command: systemctl is-active nfs\nEnsure nfs is not enabled. Command: systemctl is-enabled nfs",
        "comprobacion": "+-------------------------------------------------------------------------------+\n## No es un servicio requerido, por lo que se puede deshabilitar.\n## Antes de nada comprobar que no tenga: shares/filesystem compartiendo.\n## Debe salir vacio\n+-------------------------------------------------------------------------------+\n\ncat /etc/exports\n\n+-------------------------------------------------------------------------------+\n## En el caso de tener shares/filesystem, contactar con el SOPORTE TECNICO.\n+-------------------------------------------------------------------------------+\n\nsystemctl status nfs\n\n+-------------------------------------------------------------------------------+\n## Debe salir disable en todo :\n(/usr/lib/systemd/system/nfs-server.service; disabled; vendor preset: disabled)\n+-------------------------------------------------------------------------------+",
        "copia": null,
        "editar": "systemctl stop nfs.service\nsystemctl disable nfs.service",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\nsystemctl status nfs.service",
        "SO": "Linux"
    },
    {
        "modulo": "Protecting Resources-mixed/Ensure sticky bit is set on all world-writable directories",
        "clave": "STICKY",
        "descripcion": "Sticky bit is not set on world-writable directory: $directory",
        "comprobacion": "+-------------------------------------------------------------------------------+\n## Aplica a directorios y sub-directorios\n+-------------------------------------------------------------------------------+\n\n## El desvio trata de aplicar sticky a directorios y sub-directorios, pero en este desvio corregiremos permisos de escritura en OTHER.\n\n+-------------------------------------------------------------------------------+\n## Hay que tener en cuenta el tipo de owner que pertenece, cada directorio BASE.\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Ya sea de tipo '/C/F/S'\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Si es /C/, se pasa a excepcion con RISK e IMPACT\n## por favor revisar la seccion de RISK e IMPACT\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Si es de tipo /F/S/, se debe preguntar al owner, si podemos modificar los permisos\n## Revisar ('PERMISSIONS'), antes de cualquier cambio.\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Buscar y comprobar los directorios a cambiar permisos. \n+-------------------------------------------------------------------------------+\n\n## DIRECTORIOS FORMA RECURVISA:\n\necho  \"directorios con permisos w en other : \";find $directory -type d -perm -o=wx | wc -l\nfind $directory -type d -perm -o=wx | xargs -l ls -ld\n\n## DIRECTORIOS FORMA INDIVIDUAL:\n---\nls -ld $directory\n\n+-------------------------------------------------------------------------------+\n## Pregunta RELACIONADAS\n+-------------------------------------------------------------------------------+\n\nProtecting Resources-OSRs/OSR \\TMP Files Restrictions\nProtecting Resources-OSRs/OSR \\OPT Files Restrictions\nProtecting Resources-OSRs/OSR \\ETC Restrictions\nProtecting Resources-OSRs/OSR \\VAR Files Restrictions",
        "copia": null,
        "editar": "+-------------------------------------------------------------------------------+\n## Se puede quitar de forma 'recursiva' o por 'individual'\n## $directory : es la variable del directorio raiz a cambiar permisos.\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Asi quitamos de permisos de W a Other, en los directorios('RECURSIVO'):\n+-------------------------------------------------------------------------------+\n\nfind $directory -type d -perm -o=wx -exec chmod o-w {} \\;\n\n+-------------------------------------------------------------------------------+\n## Asi quitamos permisos, de W a other de forma('INDIVIDUAL'):\n+-------------------------------------------------------------------------------+\n\nchmod o-w $directory",
        "refrescar": null,
        "evidencia": "+-------------------------------------------------------------------------------+\n## De forma ('RECURSIVA'):\n+-------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nfind $directory -type d -perm -o=wx | wc -l\nls -ld $directory\n\n+-------------------------------------------------------------------------------+\n## De forma ('INDIVIDUAL'):\n+-------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -ld $directory",
        "SO": "Linux"
    },
    {
        "modulo": "Protecting Resources-OSRs/OSR /TMP Files Restrictions",
        "clave": "OSRTMP",
        "descripcion": "Invalid permissions for $fileTMP  Octal permissions: 0777  Text Permissions: -rwxrwxrwx-;  May not have execute permissions on any files and no write for others.",
        "comprobacion": "+-------------------------------------------------------------------------------+\n## Aplica a ficheros del directorio /TMP\n+-------------------------------------------------------------------------------+\n\n## El desvio trata de quitarle escritura a OTHER, a ficheros que cuelgan en el directorio /TMP y sub-directorios.\n\n+-------------------------------------------------------------------------------+\n## Hay que tener en cuenta el tipo de owner que pertenece, cada fichero o directorio BASE.\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Ya sea de tipo '/C/F/S'\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Si es /C/, se pasa a excepcion con RISK e IMPACT\n## por favor revisar la seccion de RISK e IMPACT\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Si es de tipo /F/S/, se debe preguntar al owner, si podemos modificar los permisos\n## Revisar ('PERMISSIONS'), antes de cualquier cambio.\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Buscar y comprobar los fichero a cambiar permisos.\n## Añadir a la variable 'fichero=', el fichero a corregor permisos\n+-------------------------------------------------------------------------------+\n\n## FICHEROS FORMA RECURVISA:\n---\necho \"ficheros con permisos w en other : \";find $fileTMP -type f -perm -o=wx | wc -l\nfind $fileTMP -type f -perm -o=wx | xargs -l ls -l\n\n## FICHEROS\n---\nls -l $fichero\n\n+-------------------------------------------------------------------------------+\n## Pregunta RELACIONADAS\n+-------------------------------------------------------------------------------+\n\nProtecting Resources-mixed/Ensure sticky bit is set on all world-writable directories",
        "copia": null,
        "editar": "+-------------------------------------------------------------------------------+\n## Se puede quitar de forma 'RECURSIVA' o por 'INDIVIDUAL'\n## $fileTMP : es la variable del directorio base de los ficheros a cambiar permisos.\n## $fichero : es la variable, del fichero a cambiar permiso.\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Asi quitamos de permisos de W a Other, en los ficheros('RECURSIVO'):\n+-------------------------------------------------------------------------------+\n\nfind $fileTMP -type f -perm -o=wx -exec chmod o-w {} \\;\n\n+-------------------------------------------------------------------------------+\n## Asi quitamos permisos, de W a other de forma('INDIVIDUAL'):\n## Añadir en la variable 'fichero=', el fichero a cambiar el permiso.\n+-------------------------------------------------------------------------------+\n\nchmod o-w $fichero",  
        "refrescar": null,
        "evidencia": "+-------------------------------------------------------------------------------+\n## De forma ('RECURSIVA'):\n+-------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nfind $fileTMP -type f -perm -o=wx | wc -l\nls -ld $fileTMP\n\n+-------------------------------------------------------------------------------+\n## De forma('INDIVIDUAL'):\n+-------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -l $fichero",
        "SO": "Linux"
    },
    {
        "modulo": "Protecting Resources-OSRs/CRON Full Path Restriction",
        "clave": "CRON",
        "descripcion": "Missing path: $MissingPath. path must be used for commands in CRON.",
        "comprobacion": "+-------------------------------------------------------------------------------+\n## Entrar al Servidor\n## Y buscar el PATH del fichero/s\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Guardamos en la variable '$MissingPath', fichero que le falta el PATH\n+-------------------------------------------------------------------------------+\n\nMissingPath=\"\"\n\nfind / -name \"$MissingPath\"\n\n+-------------------------------------------------------------------------------+\n## Buscar en los ficheros del CRON, el fichero $MissingPath, para añadir el path correcto.\n+-------------------------------------------------------------------------------+\n\ncd /var/spool/cron/\ngrep -i \"$MissingPath\" *\n\ncrontab -l | grep -i \"$MissingPath\"",
        "copia": "cp -p 'FICHERO DEL CRON' /home/$(logname)/\"$MissingPath\"_`date +%d%m%y_%T`",
        "editar": "+-------------------------------------------------------------------------------+\n## Editar y Añadir en el fichero cron, el path coorrecto\n+-------------------------------------------------------------------------------+\n\nvi /var/spool/cron/root\n\n+-------------------------------------------------------------------------------+\n## --> EJEMPLO\n+-------------------------------------------------------------------------------+\n\n/usr/bin/$MissingPath",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\ncat /var/spool/cron/root | grep -i \"$MissingPath\"",
        "SO": "Linux"
    },
    {
        "modulo": "Password Requirements/Password MIN Age Shadow",
        "clave": "MINAGE",
        "descripcion": "Account $account has invalid Password Min Age setting of null  should be set to Customer Required Setting: 1. Account Type: Customer",
        "comprobacion": "+-------------------------------------------------------------------------------+\n## Todas las cuentas, ya sean /C/F/S, deben tener el MINAGE a 1.\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Excepto las cuentas del PAM de LBK\n+-------------------------------------------------------------------------------+\n\nAccount ibmldadm\nAccount ibmldtsm\nAccount ibmldtiv\nAccount ibmldphc\nAccount ibmldiam\nAccount ibmldebh\nAccount ibmldbd\nadmpam_sys1\n\n+-------------------------------------------------------------------------------+\n## Revisar RISK e IMPACT\n+-------------------------------------------------------------------------------+",
        "copia": null,
        "editar": "+-------------------------------------------------------------------------------+\n## Guardamos en la variable, la cuenta a aplicar MINAGE\n## Copiar la cuenta(entre las \"\")\n+-------------------------------------------------------------------------------+\n\naccount=\"\"\n\ncat /etc/passwd | grep -i $account\n\n+-------------------------------------------------------------------------------+\n## Cambiar MIANGE a 1\n+-------------------------------------------------------------------------------+\n\nchage -m 1 $account",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\nchage -l $account\ncat /etc/passwd | grep -i $account",
        "SO": "Linux"
    },
    {
        "modulo": "Encryption/Password Encryption Required",
        "clave": "SHA512",
        "descripcion": "/etc/pam.d/password-auth.\n/etc/pam.d/system-auth.\nAny file in /etc/pam.d containing \"password sufficient pam_unix.so\" stanza must carry the \"sha512 shadow\" options.\n\nIncorrect or missing pam_unix.so module stanza. For more information see coverage matrix document",
        "comprobacion": "+-------------------------------------------------------------------------------+\n## Hace referencia al parametro 'sha512 shadow ' en RHEL7 y RHEL8.\n+-------------------------------------------------------------------------------+\n\n## Saber que versión de RHEL es:\ncat /etc/*release\n\n#-*** Saber que PAM_TALLY USA ****-#\nls -ltr /lib64/security/pam_tally*\n\n#-*** Saber que PAM_FAILLOCK USA ****-#\nls -la /usr/sbin/faillock\n\n+-------------------------------------------------------------------------------+\n##--- RHEL 7 & RHEL 8 ('system-auth','password-auth')\n+-------------------------------------------------------------------------------+\n\n## Los ficheros del PAM, deben tener en el modulo 'password    sufficient    pam_unix.so', el parámetro 'sha512 shadow '\n\ncat /etc/pam.d/system-auth | egrep \"sha512|shadow\"\ncat /etc/pam.d/password-auth | egrep \"sha512|shadow\"\n\n+-------------------------------------------------------------------------------+\n## Modulo similiar : 'Password Requirements/Password History'\n+-------------------------------------------------------------------------------+",
        "copia": "## Obtener usuario logueado:\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------+\n\ncp -p /etc/pam.d/system-auth /home/${user^^}/system-auth_`date +%d%m%y_%T`\n\ncp -p /etc/pam.d/password-auth /home/${user^^}/password-auth_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------+\n\ncp -p /etc/pam.d/system-auth /home/${user,,}/system-auth_`date +%d%m%y_%T`\n\ncp -p /etc/pam.d/password-auth /home/${user,,}/password-auth_`date +%d%m%y_%T`\n",
        "editar": "+-------------------------------------------------------------------------------+\n##--- RHEL 7 & RHEL 8 ('system-auth','password-auth')\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Añadir en el modulo 'password    sufficient    pam_unix.so', el parámetro 'sha512 shadow'.\n## ('se aconseja remplazar toda la linea, del modulo 'password    sufficient    pam_unix.so').\n+-------------------------------------------------------------------------------+\n\nvi /etc/pam.d/system-auth\n\npassword    sufficient    pam_unix.so remember=8 use_authtok sha512 shadow try_first_pass\n\n+-------------------------------------------------------------------------------+\n## Lo mismo con 'password-auth'\n+-------------------------------------------------------------------------------+\n\nvi /etc/pam.d/password-auth\n",
        "refrescar": null,
        "evidencia": "+-------------------------------------------------------------------------------+\n##--- RHEL 7 & RHEL 8 ('system-auth','password-auth')\n+-------------------------------------------------------------------------------+\nclear\ndate;hostname\ncat /etc/*release | grep -i release\ncat /etc/pam.d/system-auth | egrep \"sha512|shadow\"\ncat /etc/pam.d/password-auth | egrep \"sha512|shadow\"\n",
        "SO": "Linux"
    },
    {
        "modulo": "Password Requirements/Password History",
        "clave": "REMEMBER",
        "descripcion": "PAM service file: /etc/pam.d/password-auth\nPAM service file: /etc/pam.d/system-auth\nMust have \"password sufficient pam_unix.so\" stanza with \"remember=8\" parameter. \"sufficient\" can be replaced with \"required\".",
        "comprobacion": "+-------------------------------------------------------------------------------+\n## Hace referencia al 'remember' en RHEL7 y RHEL8.\n+-------------------------------------------------------------------------------+\n\n## Saber que versión de RHEL es:\ncat /etc/*release\n\n#-***# Saber que PAM_TALLY USA #****-#\nls -ltr /lib64/security/pam_tally*\n\n#-*** Saber que PAM_FAILLOCK USA ****-#\nls -la /usr/sbin/faillock\n\n+-------------------------------------------------------------------------------+\n##--- RHEL 7 & RHEL 8 ('system-auth','password-auth')\n+-------------------------------------------------------------------------------+\n\n## Los ficheros del PAM, deben tener en el modulo 'password    sufficient    pam_unix.so', el parámetro 'remember=8'\n\ncat /etc/pam.d/system-auth | grep remember\ncat /etc/pam.d/password-auth | grep remember\n\n+-------------------------------------------------------------------------------+\n## Modulo similiar : 'Encryption/Password Encryption Required'\n+-------------------------------------------------------------------------------+",
        "copia": "## Obtener usuario logueado:\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------+\n\ncp -p /etc/pam.d/system-auth /home/${user^^}/system-auth_`date +%d%m%y_%T`\n\ncp -p /etc/pam.d/password-auth /home/${user^^}/password-auth_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------+\n\ncp -p /etc/pam.d/system-auth /home/${user,,}/system-auth_`date +%d%m%y_%T`\n\ncp -p /etc/pam.d/password-auth /home/${user,,}/password-auth_`date +%d%m%y_%T`\n",
        "editar": "+-------------------------------------------------------------------------------+\n##--- RHEL 7 & RHEL 8 ('system-auth','password-auth')\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Añadir en el modulo 'password    sufficient    pam_unix.so', el parámetro 'remember=8'.\n## ('se aconseja remplazar toda la linea, del modulo 'password    sufficient    pam_unix.so').\n+-------------------------------------------------------------------------------+\n\nvi /etc/pam.d/system-auth\n\npassword    sufficient    pam_unix.so remember=8 use_authtok sha512 shadow try_first_pass\n\n+-------------------------------------------------------------------------------+\n## Lo mismo con 'password-auth'\n+-------------------------------------------------------------------------------+\n\nvi /etc/pam.d/password-auth\n",
        "refrescar": null,
        "evidencia": "+-------------------------------------------------------------------------------+\n##--- RHEL 7 & RHEL 8 ('system-auth','password-auth')\n+-------------------------------------------------------------------------------+\nclear\ndate;hostname\ncat /etc/*release | grep -i release\ncat /etc/pam.d/system-auth | egrep \"remember\" \ncat /etc/pam.d/password-auth | egrep \"remember\"\n",
        "SO": "Linux"
    },
    {
        "modulo": "Logging/Ntpd has secure defaults",
        "clave": "NTPD",
        "descripcion": "Key defaults for both ip4 and ip6 must be set to: nomodify notrap nopeer noquery. Configuration file /etc/ntp.conf",
        "comprobacion": null,
        "copia": "##Obtener usuario logueado:\n\nuser=$(logname)\n\n##-------------------------------------------------------------------------------\n##Backup con usuario en MAYÚSCULAS\n##-------------------------------------------------------------------------------\n\ncp -p /etc/ntp.conf /home/${user^^}/ntp_`date +%d%m%y_%T`\n\n##-------------------------------------------------------------------------------\n##Backup con usuario en minúsculas\n##-------------------------------------------------------------------------------\n\ncp -p /etc/ntp.conf /home/${user,,}/ntp_`date +%d%m%y_%T`\n",
        "editar": "+-------------------------------------------------------------------------------+\n##Añadir / Remplazar\n+-------------------------------------------------------------------------------+\n\nvi /etc/ntp.conf\n\n# En permit the source to query or modify the service on this system.\n\nrestrict default kod nomodify notrap nopeer noquery\nrestrict -6 default kod nomodify notrap nopeer noquery\n\n+-------------------------------------------------------------------------------+\n##Y por debajo de\n+-------------------------------------------------------------------------------+\n\n# the administrative functions.\n\nrestrict 127.0.0.1\nrestrict -6 ::1",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\ncat /etc/ntp.conf | grep -i restrict",
        "SO": "Linux"
    },
    {
        "modulo": "Password Requirements/Password MAX Age /etc/shadow",
        "clave": "MAXAGE",
        "descripcion": null,
        "comprobacion": null,
        "copia": null,
        "editar": null,
        "refrescar": null,
        "evidencia": null,
        "SO": "Linux"
    },
    {
        "modulo": "Network Settings/TCP Configuration Files Restrictions",
        "clave": "SYSCTL",
        "descripcion": "Incorrect /etc/sysctl.conf",
        "comprobacion": null,
        "copia": null,
        "editar": "+-------------------------------------------------------------------------------+\n## Para hacer el cambio:\n+-------------------------------------------------------------------------------+\n\n/sbin/sysctl -w net.ipv4.conf.all.secure_redirects=0\n/sbin/sysctl -w net.ipv4.conf.default.secure_redirects=0\n/sbin/sysctl -w net.ipv4.conf.all.log_martians=1\n/sbin/sysctl -w net.ipv4.conf.default.log_martians=1\n/sbin/sysctl -w net.ipv4.conf.all.rp_filter=1\n/sbin/sysctl -w net.ipv4.conf.default.rp_filter=1\n/sbin/sysctl -w net.ipv6.conf.all.accept_ra=0\n/sbin/sysctl -w net.ipv6.conf.default.accept_ra=0\n/sbin/sysctl -w net.ipv6.conf.all.accept_redirects=0\n/sbin/sysctl -w net.ipv6.conf.default.accept_redirects=0\n/sbin/sysctl -w net.ipv4.ip_forward=0\n/sbin/sysctl -w net.ipv4.conf.default.accept_source_route=0\n/sbin/sysctl -w net.ipv4.conf.all.accept_source_route=0",
        "refrescar": "sysctl -p",
        "evidencia": "clear\ndate\nhostname\n/sbin/sysctl -a |grep -i \"net.ipv4.conf.all.accept_source_route\"\n/sbin/sysctl -a |grep -i \"net.ipv4.conf.all.secure_redirects\"\n/sbin/sysctl -a |grep -i \"net.ipv4.conf.default.secure_redirects\"\n/sbin/sysctl -a |grep -i \"net.ipv4.conf.all.log_martians\"\n/sbin/sysctl -a |grep -i \"net.ipv4.conf.default.log_martians\"\n/sbin/sysctl -a |grep -i \"net.ipv4.conf.all.rp_filter\"\n/sbin/sysctl -a |grep -i \"net.ipv4.conf.default.rp_filter\"\n/sbin/sysctl -a |grep -i \"net.ipv4.conf.default.accept_source_route\"\n/sbin/sysctl -a |grep -i \"net.ipv6.conf.all.accept_ra\"\n/sbin/sysctl -a |grep -i \"net.ipv6.conf.default.accept_ra\"\n/sbin/sysctl -a |grep -i \"net.ipv6.conf.all.accept_redirects\"\n/sbin/sysctl -a |grep -i \"net.ipv6.conf.default.accept_redirects\"\n/sbin/sysctl -a |grep -i \"net.ipv4.ip_forward\"",
        "SO": "Linux"
    },
    {
        "modulo": "System Settings/MaxAuthTries Restriction",
        "clave": "MAXAUTHTRIES",
        "descripcion": "SSH Config File: /etc/ssh/sshd_config; Invalid setting (value: -1) in parameter 'MaxAuthTries': must be set to 5 or less.",
        "comprobacion": "## Antes de corregir se debe comprobar que no estén los valores correctos por defecto\n\n+-------------------------------------------------------------------------------+\n## Valor por defecto correcto es : 5\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Muestra el valor por defecto\n+-------------------------------------------------------------------------------+\n\n/usr/sbin/sshd -T|grep -i MaxAuthTries\n\n+-------------------------------------------------------------------------------+\n## Valor definido en el servidor, no debe estar comentado(#), o no debe estar vació\n+-------------------------------------------------------------------------------+\n\ncat /etc/ssh/sshd_config | grep -i MaxAuthTries",
        "copia": "## Obtener usuario logueado:\n\nuser=$(logname)\n\n## LINUX\n+-------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/${user^^}/sshd_config_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/${user,,}/sshd_config_`date +%d%m%y_%T`",
        "editar": "+-------------------------------------------------------------------------------+\n## Añadir el valor 5, al parámetro MaxAuthTries\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Debe quedar algo asi:\n\nMaxAuthTries 5\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Editar\n+-------------------------------------------------------------------------------+\n\nvi /etc/ssh/sshd_config",
        "refrescar": "+-------------------------------------------------------------------------------+\n## LINUX\n+-------------------------------------------------------------------------------+\n\nsystemctl stop sshd\nsystemctl start sshd\n\n+-------------------------------------------------------------------------------+\n## AIX\n+-------------------------------------------------------------------------------+\n\nstopsrc -s sshd;sleep 2;startsrc -s sshd",
        "evidencia": "+-------------------------------------------------------------------------------+\n## LINUX / AIX\n+-------------------------------------------------------------------------------+\nclear\ndate\nhostname\n/usr/sbin/sshd -T|grep -i MaxAuthTries\ncat /etc/ssh/sshd_config | grep -i MaxAuthTries",
        "SO": "Linux / Aix"
    },
    {
        "modulo": "Business Use Notice/PrintMotd Restriction",
        "clave": "PRINTMOTD",
        "descripcion": "SSH Config File: /etc/ssh/sshd_config; Invalid setting (value: -1) in parameter 'PrintMotd': must be set to Yes or less.",
        "comprobacion": "## Antes de corregir se debe comprobar que no estén los valores correctos por defecto\n\n+-------------------------------------------------------------------------------+\n## Valor por defecto correcto es : Yes\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Muestra el valor por defecto\n+-------------------------------------------------------------------------------+\n\n/usr/sbin/sshd -T|grep -i PrintMotd\n\n+-------------------------------------------------------------------------------+\n## Valor definido en el servidor, no debe estar comentado(#), o no debe estar vació\n+-------------------------------------------------------------------------------+\n\ncat /etc/ssh/sshd_config | grep -i PrintMotd",
        "copia": "## Obtener usuario logueado:\n\nuser=$(logname)\n\n## LINUX\n+-------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/${user^^}/sshd_config_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/${user,,}/sshd_config_`date +%d%m%y_%T`",
        "editar": "+-------------------------------------------------------------------------------+\n## Añadir el valor Yes, al parámetro PrintMotd\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Debe quedar algo asi:\n\nPrintMotd Yes\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Editar\n+-------------------------------------------------------------------------------+\n\nvi /etc/ssh/sshd_config",
        "refrescar": "+-------------------------------------------------------------------------------+\n## LINUX\n+-------------------------------------------------------------------------------+\n\nsystemctl stop sshd\nsystemctl start sshd\n\n+-------------------------------------------------------------------------------+\n## AIX\n+-------------------------------------------------------------------------------+\n\nstopsrc -s sshd;sleep 2;startsrc -s sshd",
        "evidencia": "+-------------------------------------------------------------------------------+\n## LINUX / AIX\n+-------------------------------------------------------------------------------+\nclear\ndate\nhostname\n/usr/sbin/sshd -T|grep -i PrintMotd\ncat /etc/ssh/sshd_config | grep -i PrintMotd",
        "SO": "Linux / Aix"
    },
    {
        "modulo": "AD.1.9.1.3 Protecting Resources - User Resources",
        "clave": "IBMSINIT.SH",
        "descripcion": "File /etc/profile.d/IBMsinit.sh must exist, be readable by all users, and contain at least:\nif [ $UID -gt 199 ]; then\numask 077\nfi",
        "comprobacion": "+-------------------------------------------------------------------------------+\n## Debe existir y con permisos 755 :\n+-------------------------------------------------------------------------------+\n\nls -la /etc/profile.d/IBMsinit.sh\n\n+-------------------------------------------------------------------------------+\n## Debe debe tener el script de UMASK:\n\nif [ $UID -gt 199 ]; then\numask 077\nfi\n\n+-------------------------------------------------------------------------------+\n\ncat /etc/profile.d/IBMsinit.sh\n\n+-------------------------------------------------------------------------------+\n## Debe tener implementado la invocacion a la llamada del fichero.\n. /etc/profile.d/IBMsinit.sh\n+-------------------------------------------------------------------------------+\n\ncat /etc/profile | grep -i \"IBMsinit.sh\"",        
        "copia": "## Obtener usuario logueado:\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------+\n\ncp -p /etc/profile.d/IBMsinit.sh /home/${user^^}/IBMsinit.sh_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------+\n\ncp -p /etc/profile.d/IBMsinit.sh /home/${user,,}/IBMsinit.sh_`date +%d%m%y_%T`",
        "editar": "+-------------------------------------------------------------------------------+\n## Creamos fichero y asignamos los permisos correctos.\n+-------------------------------------------------------------------------------+\n\ntouch /etc/profile.d/IBMsinit.sh\nchmod 0755 /etc/profile.d/IBMsinit.sh\n\n+-------------------------------------------------------------------------------+\n## Editar y añadir el siguiente SCRIPT:\n+-------------------------------------------------------------------------------+\n\nvi /etc/profile.d/IBMsinit.sh\n\n#--------- begin IBMsinit.sh ---------#\nif [ $UID -gt 199 ]; then\numask 077\nfi\n#--------- end IBMsinit.sh  ---------#\n\n+-------------------------------------------------------------------------------+\n## Ademas debemos implementar la invocacion a la llamada del fichero.\n## La invocacion se implementa despues de un script de UMASK.\n+-------------------------------------------------------------------------------+\n\nvi /etc/profile\n\n. /etc/profile.d/IBMsinit.sh",
        "refrescar": "",
        "evidencia": "clear\ndate\nhostname\ncat /etc/profile.d/IBMsinit.sh\ncat /etc/profile  | grep -i  IBMsinit.sh\nls -l /etc/profile.d/IBMsinit.sh",
        "SO": "Linux"
    },
    {
        "modulo": "AD.1.9.1.4 Protecting Resources - User Resources",
        "clave": "IBMSINIT.CSH",
        "descripcion": "File /etc/profile.d/IBMsinit.csh must exist, be readable by all users, and contain at least:\nif ($uid > 199) then\n    umask 077\nendif",
        "comprobacion": "+-------------------------------------------------------------------------------+\n## Debe existir y con permisos 755 :\n+-------------------------------------------------------------------------------+\n\nls -la /etc/profile.d/IBMsinit.csh\n\n+-------------------------------------------------------------------------------+\n## Debe debe tener el script de UMASK:\n\nif ($uid > 199) then\n    umask 077\nendif\n\n+-------------------------------------------------------------------------------+\n\ncat /etc/profile.d/IBMsinit.csh\n\n+-------------------------------------------------------------------------------+\n## Debe tener implementado la invocacion a la llamada del fichero.\nsource /etc/profile.d/IBMsinit.csh\n+-------------------------------------------------------------------------------+\n\ncat /etc/csh.login | grep -i \"IBMsinit.csh\"",          
        "copia": "## Obtener usuario logueado:\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------+\n\ncp -p /etc/profile.d/IBMsinit.csh /home/${user^^}/IBMsinit.csh_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------+\n\ncp -p /etc/profile.d/IBMsinit.csh /home/${user,,}/IBMsinit.csh_`date +%d%m%y_%T`\n",
        "editar": "+-------------------------------------------------------------------------------+\n## Creamos fichero y asignamos los permisos correctos.\n+-------------------------------------------------------------------------------+\n\ntouch /etc/profile.d/IBMsinit.csh\nchmod 0755 /etc/profile.d/IBMsinit.csh\n\n+-------------------------------------------------------------------------------+\n## Editar y añadir el siguiente SCRIPT:\n+-------------------------------------------------------------------------------+\n\nvi /etc/profile.d/IBMsinit.csh\n\n#--------- begin IBMsinit.csh ---------#\nif ($uid > 199) then\n    umask 077\nendif\n#--------- end IBMsinit.csh  ---------#\n\n+-------------------------------------------------------------------------------+\n## Ademas debemos implementar la invocacion a la llamada del fichero.\n## La invocacion se implementa en la ultima linea.\n+-------------------------------------------------------------------------------+\n\nvi  /etc/csh.login\n\nsource /etc/profile.d/IBMsinit.csh",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\ncat /etc/profile.d/IBMsinit.csh\ncat /etc/csh.login  | grep -i  IBMsinit.csh\nls -l /etc/profile.d/IBMsinit.csh",
        "SO": "Linux"
    },
    {
        "modulo": "Network Settings/Prohibited Processes",
        "clave": "PROCESSES",
        "descripcion": "Process netstat -anlp prohibited if not required to support application",
        "comprobacion": "+-------------------------------------------------------------------------------+\n## Revisar 'SERVICES'\n+-------------------------------------------------------------------------------+",
        "copia": "",
        "editar": "",
        "refrescar": "",
        "evidencia": "",
        "SO": "Linux"
    },
    {
        "modulo": "IZ.1.9.1.3 Protecting Resources - User Resources",
        "clave": "",
        "descripcion": "File /etc/profile.d/IBMsinit.sh must exist, be readable by all users, and contain at least:\nif [ $UID -gt 199 ]; then\numask 077\nfi",
        "comprobacion": "+-------------------------------------------------------------------------------+\n## Igual al MODULO : \n+-------------------------------------------------------------------------------+\n\nAD.1.9.1.3 Protecting Resources - User Resources",
        "copia": "## Obtener usuario logueado:\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------+\n\ncp -p /etc/profile.d/IBMsinit.sh /home/${user^^}/IBMsinit.sh_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------+\n\ncp -p /etc/profile.d/IBMsinit.sh /home/${user,,}/IBMsinit.sh_`date +%d%m%y_%T`",
        "editar": "+-------------------------------------------------------------------------------+\n## Creamos fichero y asignamos los permisos correctos.\n+-------------------------------------------------------------------------------+\n\ntouch /etc/profile.d/IBMsinit.sh\nchmod 0755 /etc/profile.d/IBMsinit.sh\n\n+-------------------------------------------------------------------------------+\n## Editar y añadir el siguiente SCRIPT:\n+-------------------------------------------------------------------------------+\n\nvi /etc/profile.d/IBMsinit.sh\n\n#--------- begin IBMsinit.sh ---------#\nif [ $UID -gt 199 ]; then\numask 077\nfi\n#--------- end IBMsinit.sh  ---------#\n\n+-------------------------------------------------------------------------------+\n## Ademas debemos implementar la invocacion a la llamada del fichero.\n## La invocacion se implementa despues de un script de UMASK.\n+-------------------------------------------------------------------------------+\n\nvi /etc/profile\n\n. /etc/profile.d/IBMsinit.sh",
        "refrescar": "",
        "evidencia": "clear\ndate\nhostname\ncat /etc/profile.d/IBMsinit.sh\ncat /etc/profile  | grep -i  IBMsinit.sh\nls -l /etc/profile.d/IBMsinit.sh",
        "SO": "Linux"
    },
    {
        "modulo": "IZ.1.9.1.4 Protecting Resources - User Resources",
        "clave": "",
        "descripcion": "File /etc/profile.d/IBMsinit.sh must exist, be readable by all users, and contain at least:\nif [ $UID -gt 199 ]; then\numask 077\nfi",
        "comprobacion": "+-------------------------------------------------------------------------------+\n## Igual al MODULO : \n+-------------------------------------------------------------------------------+\n\nAD.1.9.1.4 Protecting Resources - User Resources",
        "copia": "## Obtener usuario logueado:\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------+\n\ncp -p /etc/profile.d/IBMsinit.csh /home/${user^^}/IBMsinit.csh_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------+\n\ncp -p /etc/profile.d/IBMsinit.csh /home/${user,,}/IBMsinit.csh_`date +%d%m%y_%T`\n",
        "editar": "+-------------------------------------------------------------------------------+\n## Creamos fichero y asignamos los permisos correctos.\n+-------------------------------------------------------------------------------+\n\ntouch /etc/profile.d/IBMsinit.csh\nchmod 0755 /etc/profile.d/IBMsinit.csh\n\n+-------------------------------------------------------------------------------+\n## Editar y añadir el siguiente SCRIPT:\n+-------------------------------------------------------------------------------+\n\nvi /etc/profile.d/IBMsinit.csh\n\n#--------- begin IBMsinit.csh ---------#\nif ($uid > 199) then\n    umask 077\nendif\n#--------- end IBMsinit.csh  ---------#\n\n+-------------------------------------------------------------------------------+\n## Ademas debemos implementar la invocacion a la llamada del fichero.\n## La invocacion se implementa en la ultima linea.\n+-------------------------------------------------------------------------------+\n\nvi  /etc/csh.login\n\nsource /etc/profile.d/IBMsinit.csh",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\ncat /etc/profile.d/IBMsinit.csh\ncat /etc/csh.login  | grep -i  IBMsinit.csh\nls -l /etc/profile.d/IBMsinit.csh",
        "SO": "Linux"
    },
    {
        "modulo": "Protecting Resources-OSRs/Set gpgcheck in yum file",
        "clave": "GPGCHECK",
        "descripcion": "Set gpgcheck=1 in /etc/yum.conf file",
        "comprobacion": "+-------------------------------------------------------------------------------+\n## Ejecute el siguiente mandato y verifique que `gpgcheck` está establecido en 1\n+-------------------------------------------------------------------------------+\n\ngrep -w gpgcheck /etc/yum.conf\n\n## debe devolver: gpgcheck= 1\n\n+-------------------------------------------------------------------------------+\n## Ejecute el siguiente mandato y verifique que todas las instancias de `gpgcheck` devueltas están establecidas en ' \"1\" o simplemente nada.\n+-------------------------------------------------------------------------------+\n\ngrep -w gpgcheck /etc/yum.repos.d/* ",
        "copia": "## Obtener usuario logueado:\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------+\n\ncp -p /etc/yum.conf /home/${user^^}/yum_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------+\n\ncp -p /etc/yum.conf /home/${user,,}/yum_`date +%d%m%y_%T`\n",
        "editar": "+-------------------------------------------------------------------------------+\n## Edite `/etc/yum.conf` y establezca `gpgcheck=1`\n## En la sección [main], necesario para estar presente.\n+-------------------------------------------------------------------------------+\n\nvi /etc/yum.conf\n\n+-------------------------------------------------------------------------------+\n## Edite los archivos anómalos en `/etc/yum.repos.d/*` \n## Y establezca todas las instancias de `gpgcheck` en `1`, o simplemente elimine la línea.\n+-------------------------------------------------------------------------------+\n\ncd /etc/yum.repos.d/\n\nls -la",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\ngrep -w gpgcheck /etc/yum.conf\ngrep -w gpgcheck /etc/yum.repos.d/*",
        "SO": "Linux"
    },
    {
        "modulo": "IZ.1.8.12.8 Protecting Resources - OSRs",
        "clave": "",
        "descripcion": "Set gpgcheck=1 in /etc/yum.conf file",
        "comprobacion": "+-------------------------------------------------------------------------------+\n## Igual al MODULO : \n+-------------------------------------------------------------------------------+\n\nProtecting Resources-OSRs/Set gpgcheck in yum file\n\n+-------------------------------------------------------------------------------+\n## Ejecute el siguiente mandato y verifique que `gpgcheck` está establecido en 1\n+-------------------------------------------------------------------------------+\n\ngrep -w gpgcheck /etc/yum.conf\n\n## debe devolver: gpgcheck= 1\n\n+-------------------------------------------------------------------------------+\n## Ejecute el siguiente mandato y verifique que todas las instancias de `gpgcheck` devueltas están establecidas en ' \"1\" o simplemente nada.\n+-------------------------------------------------------------------------------+\n\ngrep -w gpgcheck /etc/yum.repos.d/* ",
        "copia": "## Obtener usuario logueado:\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------+\n\ncp -p /etc/yum.conf /home/${user^^}/yum_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------+\n\ncp -p /etc/yum.conf /home/${user,,}/yum_`date +%d%m%y_%T`\n",
        "editar": "+-------------------------------------------------------------------------------+\n## Edite `/etc/yum.conf` y establezca `gpgcheck=1`\n## En la sección [main], necesario para estar presente.\n+-------------------------------------------------------------------------------+\n\nvi /etc/yum.conf\n\n+-------------------------------------------------------------------------------+\n## Edite los archivos anómalos en `/etc/yum.repos.d/*` \n## Y establezca todas las instancias de `gpgcheck` en `1`, o simplemente elimine la línea.\n+-------------------------------------------------------------------------------+\n\ncd /etc/yum.repos.d/\n\nls -la",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\ngrep -w gpgcheck /etc/yum.conf\ngrep -w gpgcheck /etc/yum.repos.d/*",
        "SO": "Linux"
    }
]
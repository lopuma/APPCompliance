[
{
"modulo" : "Protecting Resources-OSRs/Log File Restrictions",
"descripcion" : "Invalid Permissions or Ownership for log file: /var/log/wtmp;   -rw-rw-r--.;  owner:  root;   group:  utmp. For more information see rule description.",
"comprobacion" : "##Se le debe quitar W al grupo.",
"copia" : "",
"editar" : "##Quitar permisos:\nchmod g-w /var/log/wtmp\n\n##dejar esta linea para REHL 7:\n\nvi /lib/tmpfiles.d/var.conf\nf /var/log/wtmp 0644 root utmp -\n\n##dejar esta linea para REHL 6\n\nvi /etc/rc.sysinit\nchmod 0644 /var/run/utmp /var/log/wtmp",
"refrescar" : "",
"evidencia" : "clear\ndate\nhostname\nls -la /var/log/wtmp",
"SO":"Linux"
},
{
"modulo" : "Business Use Notice/Business Use Notice Required",
"descripcion" : "Missing or Incorrect Business Use Notice. It should be set in /etc/motd",
"comprobacion" : "##Debe tener el BUN actual.",
"copia" : "",
"editar" : "vi /etc/motd\n\n##Añadir :\n\nThis system should be used for conducting IBM Cloud business or for purposes authorized by IBM Cloud management.\nIt is mandatory to comply with all the requirements listed in the applicable security policy and only process or store the data classes approved for this asset type. Use is subject to audit at any time by IBM Cloud management",
"refrescar" : "",
"evidencia" : "clear\ndate\nhostname\ncat /etc/motd",
"SO":"Linux"
},
{
"modulo" : "Network Settings/Ensure nfs-utils is not enabled and active",
"descripcion" : "Ensure nfs is not enabled. Command: systemctl is-enabled nfs",
"comprobacion" : "##No es un servicio requerido, por lo que se puede deshabilitar.\n##Antes de nada comprobar que no tenga: shares/filesystem compartiendo.\n##Debe salir vacio:\n\ncat /etc/export\n\n##En el caso de tener shares/filesystem, contactar con el SOPORTE TECNICO.",
"copia" : "",
"editar" : "systemctl stop nfs.service\nsystemctl disabled nfs.service",
"refrescar" : "",
"evidencia" : "clear\ndate\nhostname\nsystemctl status nfs.service",
"SO":"Linux"
},
{
"modulo" : "Protecting Resources-mixed/Ensure sticky bit is set on all world-writable directories",
"descripcion" : "Sticky bit is not set on world-writable directory: $directory",
"comprobacion" : "##Hay que tener en cuenta el tipo de owner al que pertenece, cada directorio RAIZ.\n\n##Ya sea de tipo '/C/F/S'\nSi es /C/, se pasa a excepcion con RISK e IMPACT\n##por favor revisar la seccion de RISK e IMPACT\n\n##Si es de tipo /F/S, se debe preguntar al owner, si podemos modificar los permisos(REVISAR DIRECTORY).",
"copia" : "",
"editar" : "##Se puede quitar de forma 'recursiva' o por 'individual'\n$directory : es la variable del directorio raiz a cambiar permisos.\n\n##Asi quitamos de permisos de W a Other, en los directorios('recursivo'):\n\nfind $directory -type d -perm -o=w -exec chmod o-w {} +\n\n##Asi quitamos de permisos de W a Other, en los ficheros('recursivo'):\n\nfind $directory -type f -perm -o=w -exec chmod o-w {} +\n\n\nAsi quitamos permisos, de W a other de forma('individual'):\n\nchmod o-w $directory",
"refrescar" : "",
"evidencia" : "##De forma ('recursiva'):\n\nclear\ndate\nhostname\nfind $directory -type d -perm -o=wx | wc -l\nfind $directory -type f -perm -o=wx | wc -l\nls -ld $directory\n\n##De forma('individual'):\n\nls -ld $directory",
"SO":"Linux"
},
{
"modulo" : "Protecting Resources-OSRs/CRON Full Path Restriction",
"descripcion" : "Missing $MissingPath path: null. $MissingPath path must be used for commands in CRON.",
"comprobacion" : "## Entrar al Servidor\n## Mirar cual es el PATH del fichero/s\n\nfind / -name '$MissingPath'\n##Donde '$MissingPath', es la variable del fichero que le falta el path\n\n##Buscar en los ficheros del CRON, el fichero $MissingPath, para añadir el path correcto.\n\ncat /var/spool/cron/crontabs  | grep -i \"$MissingPath\"\ncat /var/spool/cron/root | grep -i \"$MissingPath\"\ncat /var/spool/cron/tabs/root  | grep -i \"$MissingPath\"\ncat /etc/crontab | grep -i \"$MissingPath\"",
"copia" : "cp -p 'FICHERO DEL CRON' /home/$(logname)/\"$MissingPath\"_`date +%d%m%y`",
"editar" : "vi /var/spool/cron/root\n\n##insertar EJEMPLO:\n/usr/bin/$MissingPath",
"refrescar" : "",
"evidencia" : "clear\ndate\nhostname\ncat /var/spool/cron/root | grep -i \"$MissingPath\"",
"SO":"Linux"
},
{
"modulo" : "",
"descripcion" : "",
"comprobacion" : "",
"copia" : "",
"editar" : "",
"refrescar" : "",
"evidencia" : "",
"SO":"Linux"
},
{
"modulo" : "",
"descripcion" : "",
"comprobacion" : "",
"copia" : "",
"editar" : "",
"refrescar" : "",
"evidencia" : "",
"SO":"Linux"
},
{
"modulo" : "",
"descripcion" : "",
"comprobacion" : "",
"copia" : "",
"editar" : "",
"refrescar" : "",
"evidencia" : "",
"SO":"Linux"
},
{
"modulo" : "",
"descripcion" : "",
"comprobacion" : "",
"copia" : "",
"editar" : "",
"refrescar" : "",
"evidencia" : "",
"SO":"Linux"
},
{
"modulo" : "",
"descripcion" : "",
"comprobacion" : "",
"copia" : "",
"editar" : "",
"refrescar" : "",
"evidencia" : "",
"SO":"Linux"
},
{
"modulo" : "",
"descripcion" : "",
"comprobacion" : "",
"copia" : "",
"editar" : "",
"refrescar" : "",
"evidencia" : "",
"SO":"Linux"
},
{
"modulo" : "",
"descripcion" : "",
"comprobacion" : "",
"copia" : "",
"editar" : "",
"refrescar" : "",
"evidencia" : "",
"SO":"Linux"
}
]

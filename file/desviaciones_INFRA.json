[
    {
        "modulo": "Protecting Resources-OSRs/Log File Restrictions",
        "clave": "WTMP",
        "descripcion": "Invalid Permissions or Ownership for log file: /var/log/wtmp;   -rw-rw-r--.;  owner:  root;   group:  utmp. For more information see rule description.",
        "comprobacion": "## Se le debe quitar W al grupo.\n\n+-------------------------------------------------------------------------------------+\n## Comprobar que en logrotate.conf, tenga permisosa 0644\n+-------------------------------------------------------------------------------------+\n\ncat /etc/logrotate.conf | grep -w wtmp -A4\n\ncat /etc/logrotate.d/* | grep -w wtmp -A4",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/logrotate.conf /home/${user^^}/logrotate.conf_`date +%d%m%y`\ncp -p /etc/logrotate.d/wtmp /home/${user^^}/logrotate_wtmp_`date +%d%m%y`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/logrotate.conf /home/${user,,}/logrotate.conf_`date +%d%m%y`\ncp -p /etc/logrotate.d/wtmp /home/${user,,}/logrotate_wtmp_`date +%d%m%y`",
        "editar": "+-------------------------------------------------------------------------------------+\n## Quitar permisos al fichero\n+-------------------------------------------------------------------------------------+\n\nchmod g-w /var/log/wtmp\n\n+-------------------------------------------------------------------------------------+\n## Dejar esta linea para REHL 7:\n+-------------------------------------------------------------------------------------+\n\n## Editar:\n\nvi /lib/tmpfiles.d/var.conf\n\n## Debe quedar la linea asi:\n\nf /var/log/wtmp 0644 root utmp -\n\n+-------------------------------------------------------------------------------------+\n## Dejar esta linea para REHL 6\n+-------------------------------------------------------------------------------------+\n\n## Editar:\n\nvi /etc/rc.sysinit\n\n## Dejar la linea asi:\n\nchmod 0644 /var/run/utmp /var/log/wtmp\n\n+-------------------------------------------------------------------------------------+\n## Corregir los permisos en logrotate.conf O en /etc/logrotate.d/wtmp, en create de wtmp\n+-------------------------------------------------------------------------------------+\n\nvi /etc/logrotate.conf\n\nvi /etc/logrotate.d/wtmp\n\n+-------------------------------------------------------------------------------------+\n## Modificar los permisos de 0664, a 0644, al fichero /var/log/wtmp\n+-------------------------------------------------------------------------------------+",
        "refrescar": null,
        "evidencia": "+-------------------------------------------------------------------------------------+\n## RHEL 6\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -la /var/log/wtmp\ncat cat /etc/rc.sysinit | grep -w 'wtmp'\ncat /etc/logrotate.conf | grep -w wtmp -A4\n\n+-------------------------------------------------------------------------------------+\n## RHEL 7\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -la /var/log/wtmp\ncat /lib/tmpfiles.d/var.conf | grep -w wtmp\ncat /etc/logrotate.conf | grep -w wtmp -A4\n",
        "SO": "Linux"
    },
    {
        "modulo": "Network Settings/On syslog clients, disable remote message collection",
        "clave": "SYSLOGD",
        "descripcion": "syslogd must be run with the -r flag",
        "comprobacion": "/usr/sbin/syslogd , debe tener un - al final",
        "copia": null,
        "editar": "chssys -s syslogd -a \"-r\"",
        "refrescar": "stopsrc -s syslogd; sleep 1; startsrc -s syslogd",
        "evidencia": "clear\ndate\nuname -a\nps -ef |grep \"syslogd\"\n\n// El distintivo -r debe estar presente al final de la salida.//",
        "SO": "Aix"
    },
    {
        "modulo": "E.1.5.24.1 Network Settings",
        "clave": "",
        "descripcion": "syslogd must be run with the -r flag",
        "comprobacion": "/usr/sbin/syslogd , debe tener un - al final",
        "copia": null,
        "editar": "chssys -s syslogd -a \"-r\"",
        "refrescar": "stopsrc -s syslogd; sleep 1; startsrc -s syslogd",
        "evidencia": "clear\ndate\nuname -a\nps -ef |grep \"syslogd\"\n\n// El distintivo -r debe estar presente al final de la salida.//",
        "SO": "Aix"
    },
    {
        "modulo": "Protecting Resources-OSRs/smit.log Restrictions",
        "clave": "SMIT.LOG",
        "descripcion": "Invalid Permissions or Ownership for File: /smit.log, Owner: root, Text Permissions: -rw-r--r---, must only be readable or writeable by root. Should be owned by root.",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Desvio similar al modulo : \n+-------------------------------------------------------------------------------------+\n\nProtecting Resources-OSRs/smit.script Restrictions\nProtecting Resources-OSRs/smit.transaction Restrictions\n",
        "copia": null,
        "editar": "chmod g-r,o-r /smit.log\n\n+-------------------------------------------------------------------------------------+\n## Corregir similares:\n+-------------------------------------------------------------------------------------+\n\nchmod g-r,o-r /smit.script\nchmod g-r,o-r /smit.transaction",
        "refrescar": null,
        "evidencia": "clear\ndate\nuname -a\nls -ls /smit.log\nls -ls /smit.script\nls -ls /smit.script",
        "SO": "Aix"
    },
    {
        "modulo": "Protecting Resources-OSRs/smit.transaction Restrictions",
        "clave": "SMIT.TRANSACTION",
        "descripcion": "Invalid Permissions or Ownership for File: /smit.transaction, Owner: root, Text Permissions: -rw-r--r---, must only be readable or writeable by root. Should be owned by root.",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Desvio similar al modulo : \n+-------------------------------------------------------------------------------------+\n\nProtecting Resources-OSRs/smit.log Restrictions\nProtecting Resources-OSRs/smit.script Restrictions\n",
        "copia": null,
        "editar": "chmod g-r,o-r /smit.transaction\n\n+-------------------------------------------------------------------------------------+\n## Corregir similares:\n+-------------------------------------------------------------------------------------+\n\nchmod g-r,o-r /smit.script\nchmod g-r,o-r /smit.log",
        "refrescar": null,
        "evidencia": "clear\ndate\nuname -a\nls -ls /smit.log\nls -ls /smit.script\nls -ls /smit.transaction",
        "SO": "Aix"
    },
    {
        "modulo": "E.1.8.9.1 Protecting Resources - OSRs",
        "clave": "",
        "descripcion": "Invalid Permissions or Ownership for File: /smit.log, Owner: root, Text Permissions: -rw-r--r---, must only be readable or writeable by root. Should be owned by root.",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Desvio similar al modulo : \n+-------------------------------------------------------------------------------------+\n\nProtecting Resources-OSRs/smit.script Restrictions\nProtecting Resources-OSRs/smit.transaction Restrictions\n",
        "copia": null,
        "editar": "chmod g-r,o-r /smit.log\n\n+-------------------------------------------------------------------------------------+\n## Corregir similares:\n+-------------------------------------------------------------------------------------+\n\nchmod g-r,o-r /smit.script\nchmod g-r,o-r /smit.transaction",
        "refrescar": null,
        "evidencia": "clear\ndate\nuname -a\nls -ls /smit.log\nls -ls /smit.script\nls -ls /smit.script",
        "SO": "Aix"
    },
    {
        "modulo": "Filesystem Configuration/nodev option set on /tmp partition",
        "clave": "NODEVTMP",
        "descripcion": "Ensure nodev option set on /tmp partition if it exist",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## PREGUNTAS RELACIONADAS:\n\nFilesystem Configuration/nodev option set on \\tmp partition\nFilesystem Configuration/nosuid option set on \\tmp partition\nFilesystem Configuration/noexec option set on \\tmp partition\n+-------------------------------------------------------------------------------------+\n\n## Si existe una partición de `/tmp`, ejecute el siguiente comando \n## Y verifique que la opción `nodev` esté establecida en `/tmp`\n\n## Puede estar montado como filesystem de disco o filesystem de ram\n\n+-------------------------------------------------------------------------------------+\n## FS de DISCO\n+-------------------------------------------------------------------------------------+\n\nmount | grep /tmp\n\n## En /dev/mapper/ de tipo /tmp (rw, nosuid, nodev, noexec, relatime)\n\n+-------------------------------------------------------------------------------------+\n## FS de RAM\n+-------------------------------------------------------------------------------------+\n\nmount | grep /tmp\n\n## En tmpfs de tipo /tmp (rw, nosuid, nodev, noexec, relatime)",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/fstab /home/${user^^}/nodevtmp_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/fstab /home/${user,,}/nodevtmp_`date +%d%m%y_%T`\n",
        "editar": "+-------------------------------------------------------------------------------------+\n## Edite `/etc/fstab` \n## Para añadir `nodev ` a las opciones de montaje de `/tmp:\n+-------------------------------------------------------------------------------------+\n\nvi /etc/fstab\n\n+-------------------------------------------------------------------------------------+\n## Debe tener la siguiente linea o similar en:\n## Se puede añadir toda la configuracion (noexec,nodev,nosuid)\n+-------------------------------------------------------------------------------------+\n\n/tmp              ext4    defaults,noexec,nodev,nosuid        1 2\n\n+-------------------------------------------------------------------------------------+\n## Despues de guardar la configuracion,  ejecute el siguiente mandato para volver a montar `/tmp`:\n+-------------------------------------------------------------------------------------+\n\nmount -o remount,nodev,nosuid,noexec /tmp",
        "refrescar": "mount -o remount,nodev,nosuid,noexec /tmp",
        "evidencia": "clear\ndate\nhostname\nmount | grep /tmp",
        "SO": "Linux"
    },
    {
        "modulo": "Filesystem Configuration/nosuid option set on /tmp partition",
        "clave": "NOSUIDTMP",
        "descripcion": "Ensure nosuid option set on /tmp partition if it exist",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## PREGUNTAS RELACIONADAS:\n\nFilesystem Configuration/nodev option set on \\tmp partition\nFilesystem Configuration/nosuid option set on \\tmp partition\nFilesystem Configuration/noexec option set on \\tmp partition\n+-------------------------------------------------------------------------------------+\n\n## Si existe una partición de `/tmp`, ejecute el siguiente comando \n## Y verifique que la opción `nosuid` esté establecida en `/tmp`\n\n## Puede estar montado como filesystem de disco o filesystem de ram\n\n+-------------------------------------------------------------------------------------+\n## FS de DISCO\n+-------------------------------------------------------------------------------------+\n\nmount | grep /tmp\n\n## En /dev/mapper/ de tipo /tmp (rw, nosuid,nodev,noexec, relatime)\n\n+-------------------------------------------------------------------------------------+\n## FS de RAM\n+-------------------------------------------------------------------------------------+\n\nmount | grep /tmp\n\n## En tmpfs de tipo /tmp (rw, nosuid,nodev,noexec, relatime)",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/fstab /home/${user^^}/nosuidtmp_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/fstab /home/${user,,}/nosuidtmp_`date +%d%m%y_%T`\n",
        "editar": "+-------------------------------------------------------------------------------------+\n## Edite `/etc/fstab` \n## Para añadir `nosuid ` a las opciones de montaje de `/tmp:\n+-------------------------------------------------------------------------------------+\n\nvi /etc/fstab\n\n+-------------------------------------------------------------------------------------+\n## Debe tener la siguiente linea o similar en:\n## Se puede añadir toda la configuracion (noexec,nodev,nosuid)\n+-------------------------------------------------------------------------------------+\n\n/tmp              ext4    defaults,noexec,nosuid,nodev        1 2\n\n+-------------------------------------------------------------------------------------+\n## Despues de guardar la configuracion,  ejecute el siguiente mandato para volver a montar `/tmp`:\n+-------------------------------------------------------------------------------------+\n\nmount -o remount,nodev,nosuid,noexec /tmp",
        "refrescar": "mount -o remount,nodev,nosuid,noexec /tmp",
        "evidencia": "clear\ndate\nhostname\nmount | grep /tmp",
        "SO": "Linux"
    },
    {
        "modulo": "Filesystem Configuration/noexec option set on /tmp partition",
        "clave": "NOEXECTMP",
        "descripcion": "Ensure noexec option set on /tmp partition if it exist",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## PREGUNTAS RELACIONADAS:\n\nFilesystem Configuration/nodev option set on \\tmp partition\nFilesystem Configuration/nosuid option set on \\tmp partition\nFilesystem Configuration/noexec option set on \\tmp partition\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Servidores que no se deben corregir : \n+-------------------------------------------------------------------------------------+\n\nes01qpc020itdrm y es06qpc020itdrm\n\n+-------------------------------------------------------------------------------------+\n## Si existe una partición de `/tmp`, ejecute el siguiente comando \n## Y verifique que la opción `noexec` esté establecida en `/tmp`\n\n## Puede estar montado como filesystem de disco o filesystem de ram\n\n+-------------------------------------------------------------------------------------+\n## FS de DISCO\n+-------------------------------------------------------------------------------------+\n\nmount | grep /tmp\n\n## En /dev/mapper/ de tipo /tmp (rw, nosuid,nodev,noexec, relatime)\n\n+-------------------------------------------------------------------------------------+\n## FS de RAM\n+-------------------------------------------------------------------------------------+\n\nmount | grep /tmp\n\n## En tmpfs de tipo /tmp (rw, nosuid,nodev,noexec, relatime)",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/fstab /home/${user^^}/noexectmp_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/fstab /home/${user,,}/noexectmp_`date +%d%m%y_%T`\n",
        "editar": "+-------------------------------------------------------------------------------------+\n## Edite `/etc/fstab` \n## Para añadir `noexec` a las opciones de montaje de `/tmp:\n+-------------------------------------------------------------------------------------+\n\nvi /etc/fstab\n\n+-------------------------------------------------------------------------------------+\n## Debe tener la siguiente linea o similar en:\n## Se puede añadir toda la configuracion (noexec,nodev,nosuid)\n+-------------------------------------------------------------------------------------+\n\n/tmp              ext4    defaults,nosuid,nodev,noexec       1 2\n\n+-------------------------------------------------------------------------------------+\n## Despues de guardar la configuracion,  ejecute el siguiente mandato para volver a montar `/tmp`:\n+-------------------------------------------------------------------------------------+\n\nmount -o remount,nodev,nosuid,noexec /tmp",
        "refrescar": "mount -o remount,nodev,nosuid,noexec /tmp",
        "evidencia": "clear\ndate\nhostname\nmount | grep /tmp",
        "SO": "Linux"
    },
    {
        "modulo": "Filesystem Configuration/nodev option set on /home partition",
        "clave": "NODEVHOME",
        "descripcion": "Ensure nodev option set on /home partition if it exist",
        "comprobacion": "## Si existe una partición de `/home`, ejecute el siguiente comando \n## Y verifique que la opción `nodev` esté establecida en `/home`\n\nmount | grep /home\n\n## En /dev/xvdf1 on /home type ext4 (rw,nodev,relatime,data=ordered)",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/fstab /home/${user^^}/nodevhome_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/fstab /home/${user,,}/nodevhome_`date +%d%m%y_%T`\n",
        "editar": "+-------------------------------------------------------------------------------------+\n## Edite `/etc/fstab` \n## Para añadir `nodev ` al cuarto campo (opciones de montaje) para la partición \"/home\":\n+-------------------------------------------------------------------------------------+\n\nvi /etc/fstab\n\n## Debe tener la siguiente linea o similar\n\n/dev/mapper/rhel-lv_home /home    ext4    defaults,nodev  1 2\n\n+-------------------------------------------------------------------------------------+\n## Despues de guardar la configuracion, ejecute el siguiente mandato para volver a montar `/home`:\n+-------------------------------------------------------------------------------------+\n\nmount -o remount,nodev /home",
        "refrescar": "mount -o remount,nodev /home",
        "evidencia": "clear\ndate\nhostname\nmount | grep /home",
        "SO": "Linux"
    },
    {
        "modulo": "IZ.C.1.1.14 Filesystem Configuration",
        "clave": "IZ.C.1.1.14",
        "descripcion": "Ensure nodev option set on /home partition if it exist",
        "comprobacion": "## Si existe una partición de `/home`, ejecute el siguiente comando \n## Y verifique que la opción `nodev` esté establecida en `/home`\n\nmount | grep /home\n\n## En /dev/xvdf1 on /home type ext4 (rw,nodev,relatime,data=ordered)",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/fstab /home/${user^^}/nodevhome_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/fstab /home/${user,,}/nodevhome_`date +%d%m%y_%T`\n",
        "editar": "+-------------------------------------------------------------------------------------+\n## Edite `/etc/fstab` \n## Para añadir `nodev ` al cuarto campo (opciones de montaje) para la partición \"/home\":\n+-------------------------------------------------------------------------------------+\n\nvi /etc/fstab\n\n## Debe tener la siguiente linea\n\n/dev/mapper/rhel-lv_home /home    ext4    defaults,nodev  1 2\n\n+-------------------------------------------------------------------------------------+\n## Despues de guardar la configuracion,  ejecute el siguiente mandato para volver a montar `/home`:\n+-------------------------------------------------------------------------------------+\n\nmount -o remount,nodev /home",
        "refrescar": "mount -o remount,nodev /home",
        "evidencia": "clear\ndate\nhostname\nmount | grep /home",
        "SO": "Linux"
    },
    {
        "modulo": "Filesystem Configuration/noexec option set on /dev/shm partition",
        "clave": "NOEXECSHM",
        "descripcion": "Ensure noexec option set on /dev/shm partition if it exist",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Servidores que no se deben corregir : \n+-------------------------------------------------------------------------------------+\n\nes01qpc020itdrm y es06qpc020itdrm\n\n+-------------------------------------------------------------------------------------+\n## Despues de guardar la configuracion,  ejecute el siguiente mandato\n## Y verifique que la opción `noexec` esté establecida en `/dev/shm` si existe como partición:\n\nmount | grep /dev/shm\n\n## En tmpfs on /dev/shm type tmpfs (rw,nosuid,nodev,noexec,relatime)",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/fstab /home/${user^^}/noexecshm_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/fstab /home/${user,,}/noexecshm_`date +%d%m%y_%T`\n",
        "editar": "+-------------------------------------------------------------------------------------+\n## Edite `/etc/fstab` \n## Para añadir `noexec` al cuarto campo (opciones de montaje) para la partición `/dev/shm`:\n+-------------------------------------------------------------------------------------+\n\nvi /etc/fstab\n\n## Debe tener la siguiente linea, si no existe *AÑADIRLA*\n\ntmpfs   /dev/shm        tmpfs           defaults,nodev,nosuid,noexec,relatime     0 0\n\n+-------------------------------------------------------------------------------------+\n## Despues de guardar la configuracion,  ejecute el siguiente mandato para volver a montar `/dev/shm`:\n+-------------------------------------------------------------------------------------+\n\nmount -o remount,nodev,nosuid,noexec,relatime /dev/shm",
        "refrescar": "mount -o remount,nodev,nosuid,noexec,relatime /dev/shm",
        "evidencia": "clear\ndate\nhostname\nmount | grep /dev/shm",
        "SO": "Linux"
    },
    {
        "modulo": "Filesystem Configuration/Disable filesystem type cramfs",
        "clave": "CRAMFS",
        "descripcion": "Filesystem type \"cramfs\" is enabled. It should be disabled if not needed",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Despues de guardar la configuracion,  ejecute los siguientes mandatos y verifique que la salida sea la indicada:\n+-------------------------------------------------------------------------------------+\n\nmodprobe -n -v cramfs \n\n+-------------------------------------------------------------------------------------+\n## SALIDA : 'install /bin/true'\n##('esta linea deshabilita el sistema de archivos cramfs')\n+-------------------------------------------------------------------------------------+\n\nlsmod | grep cramfs\n\n+-------------------------------------------------------------------------------------+\n## SALIDA ('No debe devolver nada')\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Relacionado con los modulos : \n+-------------------------------------------------------------------------------------+\n\nFilesystem Configuration/Disable filesystem type squashfs\nFilesystem Configuration/Disable filesystem type udf",
        "copia": null,
        "editar": "+-------------------------------------------------------------------------------------+\n## Crear archivo de configuración:\n+-------------------------------------------------------------------------------------+\n\ntouch /etc/modprobe.d/CIS.conf\nchmod 644 /etc/modprobe.d/CIS.conf\n\n+-------------------------------------------------------------------------------------+\n## Edite el fichero de configuración.\n+-------------------------------------------------------------------------------------+\n\nvi /etc/modprobe.d/CIS.conf\n\n+-------------------------------------------------------------------------------------+\n## Y añada la siguiente linea:\n+-------------------------------------------------------------------------------------+\n\ninstall cramfs /bin/true\n\n+-------------------------------------------------------------------------------------+\n## Y añadir las siguientes lineas de los modulos relacionados:\n+-------------------------------------------------------------------------------------+\n\ninstall squashfs /bin/true\ninstall udf /bin/true",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\nmodprobe -n -v udf\nmodprobe -n -v squashfs\nmodprobe -n -v cramfs",
        "SO": "Linux"
    },
    {
        "modulo": "Filesystem Configuration/Disable filesystem type squashfs",
        "clave": "SQUASHFS",
        "descripcion": "Filesystem type \"squashfs\" is enabled. It should be disabled if not needed",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Despues de guardar la configuracion,  ejecute los siguientes mandatos y verifique que la salida sea la indicada:\n+-------------------------------------------------------------------------------------+\n\nmodprobe -n -v squashfs \n\n+-------------------------------------------------------------------------------------+\n## SALIDA : 'install /bin/true'\n##('esta linea deshabilita el sistema de archivos squashfs')\n+-------------------------------------------------------------------------------------+\n\nlsmod | grep squashfs\n\n+-------------------------------------------------------------------------------------+\n## SALIDA ('No debe devolver nada')\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Relacionado con los modulos : \n+-------------------------------------------------------------------------------------+\n\nFilesystem Configuration/Disable filesystem type cramfs\nFilesystem Configuration/Disable filesystem type udf",
        "copia": null,
        "editar": "+-------------------------------------------------------------------------------------+\n## Crear archivo de configuración:\n+-------------------------------------------------------------------------------------+\n\ntouch /etc/modprobe.d/CIS.conf\nchmod 644 /etc/modprobe.d/CIS.conf\n\n+-------------------------------------------------------------------------------------+\n## Edite el fichero de configuración.\n+-------------------------------------------------------------------------------------+\n\nvi /etc/modprobe.d/CIS.conf\n\n+-------------------------------------------------------------------------------------+\n## Y añada la siguiente linea:\n+-------------------------------------------------------------------------------------+\n\ninstall squashfs /bin/true\n\n+-------------------------------------------------------------------------------------+\n## Y añadir las siguientes lineas de los modulos relacionados:\n+-------------------------------------------------------------------------------------+\n\ninstall cramfs /bin/true\ninstall udf /bin/true",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\nmodprobe -n -v udf\nmodprobe -n -v squashfs\nmodprobe -n -v cramfs",
        "SO": "Linux"
    },
    {
        "modulo": "Filesystem Configuration/Disable filesystem type udf",
        "clave": "UDF",
        "descripcion": "Filesystem type \"udf\" is enabled. It should be disabled if not needed",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Despues de guardar la configuracion,  ejecute los siguientes mandatos y verifique que la salida sea la indicada:\n+-------------------------------------------------------------------------------------+\n\nmodprobe -n -v udf \n\n+-------------------------------------------------------------------------------------+\n## SALIDA : 'install /bin/true'\n##('esta linea deshabilita el sistema de archivos udf')\n+-------------------------------------------------------------------------------------+\n\nlsmod | grep udf\n\n+-------------------------------------------------------------------------------------+\n## SALIDA ('No debe devolver nada')\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Relacionado con los modulos : \n+-------------------------------------------------------------------------------------+\n\nFilesystem Configuration/Disable filesystem type squashfs\nFilesystem Configuration/Disable filesystem type cramfs",
        "copia": null,
        "editar": "+-------------------------------------------------------------------------------------+\n## Crear archivo de configuración:\n+-------------------------------------------------------------------------------------+\n\ntouch /etc/modprobe.d/CIS.conf\nchmod 644 /etc/modprobe.d/CIS.conf\n\n+-------------------------------------------------------------------------------------+\n## Edite el fichero de configuración.\n+-------------------------------------------------------------------------------------+\n\nvi /etc/modprobe.d/CIS.conf\n\n+-------------------------------------------------------------------------------------+\n## Y añada la siguiente linea:\n+-------------------------------------------------------------------------------------+\n\ninstall udf /bin/true\n\n+-------------------------------------------------------------------------------------+\n## Y añadir las siguientes lineas de los modulos relacionados:\n+-------------------------------------------------------------------------------------+\n\ninstall cramfs /bin/true\ninstall squashfs /bin/true",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\nmodprobe -n -v udf\nmodprobe -n -v squashfs\nmodprobe -n -v cramfs",
        "SO": "Linux"
    },
    {
        "modulo": "Password Requirements/Automatic Logoff support shells",
        "clave": "SHELL LOGINS",
        "descripcion": "/usr/bin/tmux.\n/bin/tmux.\nEnsure that /etc/shells only allows users to select shells which support time out.",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Si los shells están indicados como desaparecidos, añádalos a /etc/shells.\n## Si cualquier shell se indica como no conforme, elimínelas.\n+-------------------------------------------------------------------------------------+\n\ncat /etc/shells | grep -i tmux",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/shells /home/${user^^}/shells_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/shells /home/${user,,}/shells__`date +%d%m%y_%T`\n",
        "editar": "+-------------------------------------------------------------------------------------+\n## Comentar las shells que no dan soporte a time out\n+-------------------------------------------------------------------------------------+\n\nvi /etc/shells",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\ncat /etc/shells | grep -i tmux\n",
        "SO": "Linux"
    },
    {
        "modulo": "Protecting Resources-OSRs/Set gpgcheck in yum file",
        "clave": "GPGCHECK",
        "descripcion": "Set gpgcheck=1 in /etc/yum.conf file",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Despues de guardar la configuracion,  ejecute el siguiente mandato y verifique que `gpgcheck` está establecido en 1\n+-------------------------------------------------------------------------------------+\n\ngrep -w gpgcheck /etc/yum.conf\n\n## debe devolver: gpgcheck= 1\n\n+-------------------------------------------------------------------------------------+\n## Despues de guardar la configuracion,  ejecute el siguiente mandato y verifique que todas las instancias de `gpgcheck` devueltas están establecidas en ' \"1\" o simplemente nada.\n+-------------------------------------------------------------------------------------+\n\ngrep -w gpgcheck /etc/yum.repos.d/* ",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/yum.conf /home/${user^^}/yum_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/yum.conf /home/${user,,}/yum_`date +%d%m%y_%T`\n",
        "editar": "+-------------------------------------------------------------------------------------+\n## Edite `/etc/yum.conf` y establezca `gpgcheck=1`\n## En la sección [main], necesario para estar presente.\n+-------------------------------------------------------------------------------------+\n\nvi /etc/yum.conf\n\n+-------------------------------------------------------------------------------------+\n## Edite los archivos anómalos en `/etc/yum.repos.d/*` \n## Y establezca todas las instancias de `gpgcheck` en `1`, o simplemente elimine la línea.\n+-------------------------------------------------------------------------------------+\n\ncd /etc/yum.repos.d/\n\nls -la",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\ngrep -w gpgcheck /etc/yum.conf\ngrep -w gpgcheck /etc/yum.repos.d/*",
        "SO": "Linux"
    },
    {
        "modulo": "Password Requirements/Password MIN Age Shadow",
        "clave": "MINAGE",
        "descripcion": "Account $account has invalid Password Min Age setting of null  should be set to Customer Required Setting: 1. Account Type: Customer",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Todas las cuentas, ya sean /C/F/S, deben tener el MINAGE a 1.\n+-------------------------------------------------------------------------------------+",        
        "copia": null,
        "editar": "+-------------------------------------------------------------------------------------+\n## Cambiar MIANGE a 1\n+-------------------------------------------------------------------------------------+\n\nchage -m 1 $account",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\nchage -l $account\ncat /etc/passwd | grep -i $account",
        "SO": "Linux"
    },
    {
        "modulo": "AD.1.1.3.2 Password Requirements",
        "clave": "",
        "descripcion": "Account $account has invalid Password Min Age setting of null  should be set to Customer Required Setting: 1. Account Type: Customer",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Todas las cuentas, ya sean /C/F/S, deben tener el MINAGE a 1.\n+-------------------------------------------------------------------------------------+",        
        "copia": null,
        "editar": "+-------------------------------------------------------------------------------------+\n## Cambiar MIANGE a 1\n+-------------------------------------------------------------------------------------+\n\nchage -m 1 $account",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\nchage -l $account\ncat /etc/passwd | grep -i $account",
        "SO": "Linux"
    },
    {
        "modulo": "AD.1.9.1.3 Protecting Resources - User Resources",
        "clave": "UMASK IBMSINIT.SH",
        "descripcion": "File /etc/profile.d/IBMsinit.sh must exist, be readable by all users, and contain at least:\nif [ $UID -gt 199 ]; then\numask 077\nfi",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Debe existir y con permisos 755 :\n+-------------------------------------------------------------------------------------+\n\nls -la /etc/profile.d/IBMsinit.sh\n\n+-------------------------------------------------------------------------------------+\n## Debe debe tener el script de UMASK:\n\nif [ $UID -gt 199 ]; then\numask 077\nfi\n\n+-------------------------------------------------------------------------------------+\n\ncat /etc/profile.d/IBMsinit.sh\n\n+-------------------------------------------------------------------------------------+\n## Debe tener implementado la invocacion a la llamada del fichero.\n. /etc/profile.d/IBMsinit.sh\n+-------------------------------------------------------------------------------------+\n\ncat /etc/profile | grep -i \"IBMsinit.sh\"",        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/profile.d/IBMsinit.sh /home/${user^^}/IBMsinit.sh_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/profile.d/IBMsinit.sh /home/${user,,}/IBMsinit.sh_`date +%d%m%y_%T`",
        "editar": "+-------------------------------------------------------------------------------------+\n## Creamos fichero y asignamos los permisos correctos.\n+-------------------------------------------------------------------------------------+\n\ntouch /etc/profile.d/IBMsinit.sh\nchmod 0755 /etc/profile.d/IBMsinit.sh\n\n+-------------------------------------------------------------------------------------+\n## Editar y añadir el siguiente SCRIPT:\n+-------------------------------------------------------------------------------------+\n\nvi /etc/profile.d/IBMsinit.sh\n\n#--------- begin IBMsinit.sh --------#\nif [ $UID -gt 199 ]; then\numask 077\nfi\n#--------- end IBMsinit.sh  ---------#\n\n+-------------------------------------------------------------------------------------+\n## Ademas debemos implementar la invocacion a la llamada del fichero.\n## La invocacion se implementa despues de un script de UMASK.\n+-------------------------------------------------------------------------------------+\n\nvi /etc/profile\n\n. /etc/profile.d/IBMsinit.sh",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\ncat /etc/profile.d/IBMsinit.sh\ncat /etc/profile  | grep -i  IBMsinit.sh\nls -l /etc/profile.d/IBMsinit.sh",
        "SO": "Linux"
    },
    {
        "modulo": "AD.1.9.1.4 Protecting Resources - User Resources",
        "clave": "UMASK IBMSINIT.CSH",
        "descripcion": "File /etc/profile.d/IBMsinit.csh must exist, be readable by all users, and contain at least:\nif ($uid > 199) then\n    umask 077\nendif",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Debe existir y con permisos 755 :\n+-------------------------------------------------------------------------------------+\n\nls -la /etc/profile.d/IBMsinit.csh\n\n+-------------------------------------------------------------------------------------+\n## Debe debe tener el script de UMASK:\n\nif ($uid > 199) then\n    umask 077\nendif\n\n+-------------------------------------------------------------------------------------+\n\ncat /etc/profile.d/IBMsinit.csh\n\n+-------------------------------------------------------------------------------------+\n## Debe tener implementado la invocacion a la llamada del fichero.\nsource /etc/profile.d/IBMsinit.csh\n+-------------------------------------------------------------------------------------+\n\ncat /etc/csh.login | grep -i \"IBMsinit.csh\"",          "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/profile.d/IBMsinit.csh /home/${user^^}/IBMsinit.csh_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/profile.d/IBMsinit.csh /home/${user,,}/IBMsinit.csh_`date +%d%m%y_%T`\n",
        "editar": "+-------------------------------------------------------------------------------------+\n## Creamos fichero y asignamos los permisos correctos.\n+-------------------------------------------------------------------------------------+\n\ntouch /etc/profile.d/IBMsinit.csh\nchmod 0755 /etc/profile.d/IBMsinit.csh\n\n+-------------------------------------------------------------------------------------+\n## Editar y añadir el siguiente SCRIPT:\n+-------------------------------------------------------------------------------------+\n\nvi /etc/profile.d/IBMsinit.csh\n\n#--------- end IBMsinit.csh  ---------#\nif ($uid > 199) then\n    umask 077\nendif\n#--------- end IBMsinit.csh  ---------#\n\n+-------------------------------------------------------------------------------------+\n## Ademas debemos implementar la invocacion a la llamada del fichero.\n## La invocacion se implementa en la ultima linea.\n+-------------------------------------------------------------------------------------+\n\nvi  /etc/csh.login\n\nsource /etc/profile.d/IBMsinit.csh",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\ncat /etc/profile.d/IBMsinit.csh\ncat /etc/csh.login  | grep -i  IBMsinit.csh\nls -l /etc/profile.d/IBMsinit.csh",
        "SO": "Linux"
    },
    {
        "modulo": "Protecting Resources-OSRs/IBMsinit Permission Restriction",
        "clave": "OSR IBMSINIT",
        "descripcion": "Invalid permissions for /etc/profile.d/IBMsinit.csh, /etc/profile.d/IBMsinit.sh\nOwner: root, Group: root, Permissions: -rw-r--r--. should be for  \"other\"  of r-x, for \"group\"  of r-x",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Deben existir /etc/profile.d/IBMsinit.sh, /etc/profile.d/IBMsinit.csh y con permisos 755.\n+-------------------------------------------------------------------------------------+\n\nls -l /etc/profile.d/IBMsinit.sh\nls -l /etc/profile.d/IBMsinit.csh\n\n+-------------------------------------------------------------------------------------+\n## Relacionado con :\n+-------------------------------------------------------------------------------------+\n\nAD.1.9.1.3 Protecting Resources - User Resources\nAD.1.9.1.4 Protecting Resources - User Resources",
        "copia": null,
        "editar": "+-------------------------------------------------------------------------------------+\n## Creamos fichero y asignamos los permisos correctos.\n+-------------------------------------------------------------------------------------+\n\ntouch /etc/profile.d/IBMsinit.sh\nchmod 0755 /etc/profile.d/IBMsinit.sh\n\ntouch /etc/profile.d/IBMsinit.csh\nchmod 0755 /etc/profile.d/IBMsinit.csh\n\n",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\nls -l /etc/profile.d/IBMsinit.sh\nls -l /etc/profile.d/IBMsinit.csh",
        "SO": "Linux"
    },
    {
        "modulo": "AD.1.8.12.6 Protecting Resources - OSRs",
        "clave": "OSR IBMSINIT.SH",
        "descripcion": "Invalid permissions for /etc/profile.d/IBMsinit.sh\nOwner: root, Group: root, Permissions: -rw-r--r--. should be for  \"other\"  of r-x, for \"group\"  of r-x",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## MODULO SIMILAR : Protecting Resources-OSRs/IBMsinit Permission Restriction\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Deben existir /etc/profile.d/IBMsinit.sh y con permisos 755.\n+-------------------------------------------------------------------------------------+\n\nls -l /etc/profile.d/IBMsinit.sh\n\n+-------------------------------------------------------------------------------------+\n## Relacionado con :\n+-------------------------------------------------------------------------------------+\n\nAD.1.9.1.3 Protecting Resources - User Resources\nAD.1.9.1.4 Protecting Resources - User Resources",
        "copia": null,
        "editar": "+-------------------------------------------------------------------------------------+\n## Creamos fichero y asignamos los permisos correctos.\n+-------------------------------------------------------------------------------------+\n\ntouch /etc/profile.d/IBMsinit.sh\nchmod 0755 /etc/profile.d/IBMsinit.sh\n",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\nls -l /etc/profile.d/IBMsinit.sh",
        "SO": "Linux"
    },
    {
        "modulo": "AD.1.8.12.7 Protecting Resources - OSRs",
        "clave": "OSR IBMSINIT.SH",
        "descripcion": "Invalid permissions for /etc/profile.d/IBMsinit.csh\nOwner: root, Group: root, Permissions: -rw-r--r--. should be for  \"other\"  of r-x, for \"group\"  of r-x",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## MODULO SIMILAR : Protecting Resources-OSRs/IBMsinit Permission Restriction\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Deben existir /etc/profile.d/IBMsinit.csh y con permisos 755.\n+-------------------------------------------------------------------------------------+\n\nls -l /etc/profile.d/IBMsinit.csh\n\n+-------------------------------------------------------------------------------------+\n## Relacionado con :\n+-------------------------------------------------------------------------------------+\n\nAD.1.9.1.3 Protecting Resources - User Resources\nAD.1.9.1.4 Protecting Resources - User Resources",
        "copia": null,
        "editar": "+-------------------------------------------------------------------------------------+\n## Creamos fichero y asignamos los permisos correctos.\n+-------------------------------------------------------------------------------------+\n\ntouch /etc/profile.d/IBMsinit.csh\nchmod 0755 /etc/profile.d/IBMsinit.csh\n",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\nls -l /etc/profile.d/IBMsinit.csh",
        "SO": "Linux"
    },
    {
        "modulo": "Network Settings/TCP Configuration Files Restrictions",
        "clave": "SYSCTL",
        "descripcion": "Incorrect /etc/sysctl.conf",
        "comprobacion": "+-------------------------------------------------------------------------------------+\nLos valores por defecto en `/sbin/sysctl`, deben estar establecidos.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Existen server, que la configuracion se realiza desde el fichero de configuracion `/etc/sysctl.conf`, es erroneo se debe establecer valores por defecto.\n+-------------------------------------------------------------------------------------+",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/sysctl.conf /home/${user^^}/sysctl.conf_`date +%d%m%y`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/sysctl.conf /home/${user,,}/sysctl.conf_`date +%d%m%y`",
        "editar": "+-------------------------------------------------------------------------------------+\n## Para hacer el cambio:\n+-------------------------------------------------------------------------------------+\n\n/sbin/sysctl -w net.ipv4.conf.all.secure_redirects=0\n/sbin/sysctl -w net.ipv4.conf.default.secure_redirects=0\n/sbin/sysctl -w net.ipv4.conf.all.log_martians=1\n/sbin/sysctl -w net.ipv4.conf.default.log_martians=1\n/sbin/sysctl -w net.ipv4.conf.all.rp_filter=1\n/sbin/sysctl -w net.ipv4.conf.default.rp_filter=1\n/sbin/sysctl -w net.ipv4.ip_forward=0\n/sbin/sysctl -w net.ipv4.conf.all.accept_source_route=0\n/sbin/sysctl -w net.ipv4.conf.default.accept_source_route=0\n/sbin/sysctl -w net.ipv4.conf.all.accept_redirects=0\n/sbin/sysctl -w net.ipv6.conf.all.accept_ra=0\n/sbin/sysctl -w net.ipv6.conf.default.accept_ra=0\n/sbin/sysctl -w net.ipv6.conf.all.accept_redirects=0\n/sbin/sysctl -w net.ipv6.conf.default.accept_redirects=0\n",
        "refrescar": "sysctl -p",
        "evidencia": "clear\ndate\nhostname\n/sbin/sysctl -a |grep -i \"net.ipv4.conf.all.secure_redirects\"\n/sbin/sysctl -a |grep -i \"net.ipv4.conf.default.secure_redirects\"\n/sbin/sysctl -a |grep -i \"net.ipv4.conf.all.log_martians\"\n/sbin/sysctl -a |grep -i \"net.ipv4.conf.default.log_martians\"\n/sbin/sysctl -a |grep -i \"net.ipv4.conf.all.rp_filter\"\n/sbin/sysctl -a |grep -i \"net.ipv4.conf.default.rp_filter\"\n/sbin/sysctl -a |grep -i \"net.ipv4.conf.all.accept_source_route\"\n/sbin/sysctl -a |grep -i \"net.ipv4.conf.default.accept_source_route\"\n/sbin/sysctl -a |grep -i \"net.ipv4.ip_forward\"\n/sbin/sysctl -a |grep -i \"net.ipv4.conf.all.accept_redirects\"\n/sbin/sysctl -a |grep -i \"net.ipv6.conf.all.accept_ra\"\n/sbin/sysctl -a |grep -i \"net.ipv6.conf.default.accept_ra\"\n/sbin/sysctl -a |grep -i \"net.ipv6.conf.all.accept_redirects\"\n/sbin/sysctl -a |grep -i \"net.ipv6.conf.default.accept_redirects\"\n",
        "SO": "Linux"
    },
    {
        "modulo": "Password Requirements/Automatic Logoff IBMsinit sh TMOUT",
        "clave": "TMOUT",
        "descripcion": "/etc/profile.d/IBMsinit.sh Default: Set systems to terminate a session after 21600 seconds of inactivity. File must  contain \"TMOUT=21600\" followed by \"export TMOUT\". A shorter time frame may be specified.",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## En /etc/profile.d/IBMsinit.sh, al final del SCRIPT de UMASK\n## Debe tener un TMOUT\n(\"TMOUT solo debe estar implementado en 'IBMsinit.sh'\")\n+-------------------------------------------------------------------------------------+\n\ncat /etc/profile.d/IBMsinit.sh\n\n+-------------------------------------------------------------------------------------+\n## SET muestra el valor por defecto\n+-------------------------------------------------------------------------------------+\n\nset | grep OUT",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/profile.d/IBMsinit.sh /home/${user^^}/IBMsinit.sh_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/profile.d/IBMsinit.sh /home/${user,,}/IBMsinit.sh_`date +%d%m%y_%T`\n",
        "editar": "+-------------------------------------------------------------------------------------+\n## Editar y Añadir al final del SCRIPT de UMASK\n+-------------------------------------------------------------------------------------+\n\nvi /etc/profile.d/IBMsinit.sh\n\nTMOUT=21600\nexport TMOUT",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\ncat /etc/profile.d/IBMsinit.sh\nset | grep OUT",
        "SO": "Linux"
    },
    {
        "modulo": "AD.1.8.7.2 Protecting Resources - OSRs",
        "clave": "WTMP",
        "descripcion": "Invalid Permissions or Ownership for log file: /var/log/wtmp;   -rw-rw-r--.;  owner:  root;   group:  utmp. For more information see rule description.",
        "comprobacion": "## Se le debe quitar W al grupo.\n\n+-------------------------------------------------------------------------------------+\n## Comprobar que en logrotate.conf, tenga permisosa 0644\n+-------------------------------------------------------------------------------------+\n\ncat /etc/logrotate.conf | grep -w wtmp -A4\n\ncat /etc/logrotate.d/* | grep -w wtmp -A4",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/logrotate.conf /home/${user^^}/logrotate.conf_`date +%d%m%y`\ncp -p /etc/logrotate.d/wtmp /home/${user^^}/logrotate_wtmp_`date +%d%m%y`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/logrotate.conf /home/${user,,}/logrotate.conf_`date +%d%m%y`\ncp -p /etc/logrotate.d/wtmp /home/${user,,}/logrotate_wtmp_`date +%d%m%y`",
        "editar": "+-------------------------------------------------------------------------------------+\n## Quitar permisos al fichero\n+-------------------------------------------------------------------------------------+\n\nchmod g-w /var/log/wtmp\n\n+-------------------------------------------------------------------------------------+\n## Dejar esta linea para REHL 7:\n+-------------------------------------------------------------------------------------+\n\n## Editar:\n\nvi /lib/tmpfiles.d/var.conf\n\n## Debe quedar la linea asi:\n\nf /var/log/wtmp 0644 root utmp -\n\n+-------------------------------------------------------------------------------------+\n## Dejar esta linea para REHL 6\n+-------------------------------------------------------------------------------------+\n\n## Editar:\n\nvi /etc/rc.sysinit\n\n## Dejar la linea asi:\n\nchmod 0644 /var/run/utmp /var/log/wtmp\n\n+-------------------------------------------------------------------------------------+\n## Corregir los permisos en logrotate.conf O en /etc/logrotate.d/wtmp, en create de wtmp\n+-------------------------------------------------------------------------------------+\n\nvi /etc/logrotate.conf\n\nvi /etc/logrotate.d/wtmp\n\n+-------------------------------------------------------------------------------------+\n## Modificar los permisos de 0664, a 0644, al fichero /var/log/wtmp\n+-------------------------------------------------------------------------------------+",
        "refrescar": null,
        "evidencia": "+-------------------------------------------------------------------------------------+\n## RHEL 6\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -la /var/log/wtmp\ncat cat /etc/rc.sysinit | grep -w 'wtmp'\ncat /etc/logrotate.conf | grep -w wtmp -A4\n\n+-------------------------------------------------------------------------------------+\n## RHEL 7\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -la /var/log/wtmp\ncat /lib/tmpfiles.d/var.conf | grep -w wtmp\ncat /etc/logrotate.conf | grep -w wtmp -A4\n",
        "SO": "Linux"
    },
    {
        "modulo": "Password Requirements/Private Key Passphrase",
        "clave": "NOT PASSPHRASE",
        "descripcion": "SSH Private Key: $file_idrsa not passphrase protected",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## En este tipo de desviaciones, las claves privadas(\"id_rsa\")\n## Deben tener una frase de paso (passphrase) : \"Proc-Type: 4,ENCRYPTED\"\n\n## Puede no tener un passphrase, siempre que la clave_publica(authorized_keys), tenga un FROM.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Guardamos en la variable, el fichero id_rsa a revisar\n## Antes de seguir, revisar -* ID_RSA *-\n+-------------------------------------------------------------------------------------+\n\nfile_idrsa=\"\"\n\n+-------------------------------------------------------------------------------------+\n## Revisamos si tiene una FRASE DE PASO\n## Debe ser solo accesible al owner\n+-------------------------------------------------------------------------------------+\n\nls -la $file_idrsa\ncat $file_idrsa\n\n## PUEDEN EXISTIR 3 OPCIONES DIFERENTES:\n\n## --> OPCION 1\n+-------------------------------------------------------------------------------------+\n## Si el fichero id_rsa es de root, no debe tener un fichero id_rsa.\n## Pasamos directamente a renombrar el fichero id_rsa para owner root.\n## ('SI HAY DUDAS, consultarlo con el tecnico')\n+-------------------------------------------------------------------------------------+\n\n## --> OPCION 2\n+-------------------------------------------------------------------------------------+\n## Si el fichero id_rsa, pertenece a otro owner o grupo que no sea root.\n## Si es de TIPO /F/S (sistemas / aplicativo)\n## se debe contactar con el owner o grupo del fichero.\n## - Si se va a excepcionar nos deben especificar un RISK e IMPACT.\n\n## - Si se va a corregir.\n## Revisar ('ID_RSA'), antes de cualquier cambio.\n\n## Si es de TIPO /C/ (customer)\n## - Se debe excepcionar.\n## Por favor revisar la sección de RISK e IMPACT.\n+-------------------------------------------------------------------------------------+\n\n## --> OPCION 3\n+-------------------------------------------------------------------------------------+\n## Si el fichero id_rsa, pertenece a otro owner o grupo que no sea root.\n## Si es de tipo /E/. /I/\n## - Si es una cuenta 'externa' y no existe en el servidor, se puede renombrar.\n## - Si la cuenta existe, se debe notificar al owner de la cuenta.\n\n## Se le debe notificar que se ha renombrado el fichero y que si lo utiliza debe,\n## Crear un fichero id_rsa con una frase de paso (passphrase).  \n## Revisar ('ID_RSA'), antes de cualquier cambio.\n+-------------------------------------------------------------------------------------+",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n## LINUX\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p $file_idrsa /home/${user^^}/id_rsa_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p $file_idrsa /home/${user,,}/id_rsa_`date +%d%m%y_%T`\n\n##AIX\n+-------------------------------------------------------------------------------------+\n## Backup\n+-------------------------------------------------------------------------------------+\ncp -p \"$file_idrsa\" /home/$user/id_rsa_`date +%d%m%y_%T`",
        "editar": "## --> OPCION 1\n+-------------------------------------------------------------------------------------+\n## Para ficheros id_rsas, con owner root\n+-------------------------------------------------------------------------------------+\n\nmv /home/root/.ssh/id_rsa /home/root/.ssh/id_rsa.save\n\n\n## --> OPCION 2\n+-------------------------------------------------------------------------------------+\n## Para otros ficheros id_rsas.\n## De tipo /F/S/.\n## Para implementar una FRASE DE PASO, se debe eliminar el fichero y crear uno nuevo si no recuerda si puso una passphrase\n\n## Al crear con la opcion -P (ssh-keygen -t rsa -P \"frase_depaso\")\n\n## Si no se indica la opcion, al crear la clave privada lo pregunta : (Enter passphrase (empty for no passphrase):).\n+-------------------------------------------------------------------------------------+\n\nrm $file_idrsa\n\n+-------------------------------------------------------------------------------------+\n## Si recuerda la frase de paso (passphrase), o es vacia, se puede crear o modificar con la siguientes opciones\n+-------------------------------------------------------------------------------------+\n\nssh-keygen -o -p -f keyfile\n\n## --> OPCION 3\n+-------------------------------------------------------------------------------------+\n## Para otros ficheros id_rsas, sin owner o account externas.\n## De tipo /E/I/\n\n## Si no existe la cuenta se puede renombrar\n\n## Si existe la cuenta, se le debe indicar que debe crear una nueva clave privada o modifcar e implementar un frase de paso (passphrase)(\"OPCION 2\")\n+-------------------------------------------------------------------------------------+\n\nmv $file_idrsa $file_idrsa.save",
        "refrescar": null,
        "evidencia": "## --> OPCION 1\n+-------------------------------------------------------------------------------------+\n## Para ficheros id_rsas, con owner root.\n+-------------------------------------------------------------------------------------+\nclear\ndate\nhostname\nls -la /home/root/.ssh/id_rsas\nls -la /home/root/.ssh/id_rsas.save\n\n\n## --> OPCION 2\n+-------------------------------------------------------------------------------------+\n## Para otros ficheros id_rsas.\n## De tipo /F/S/.\n+-------------------------------------------------------------------------------------+\nclear\ndate\nuname -a\ncat $file_idrsa | grep -i 'ENCRYPTED' \n\n\n## --> OPCION 3\n+-------------------------------------------------------------------------------------+\n## Para otros ficheros id_rsas, sin owner o account externas.\n## De tipo /E/I/.\n+-------------------------------------------------------------------------------------+\nclear\ndate\nuname -a\nls -la $file_idrsa\nls -la $file_idrsa.save",
        "SO": "Linux / Aix"
    },
    {
        "modulo": "IZ.1.4.6.3 System Settings",
        "clave": "",
        "descripcion": "/etc/profile.d/IBMsinit.sh Default: Set systems to terminate a session after 21600 seconds of inactivity. File must  contain \"TMOUT=21600\" followed by \"export TMOUT\". A shorter time frame may be specified.",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## En /etc/profile.d/IBMsinit.sh, al final del SCRIPT de UMASK\n## Debe tener un TMOUT\n(\"TMOUT solo debe estar implementado en 'IBMsinit.sh'\")\n+-------------------------------------------------------------------------------------+\n\ncat /etc/profile.d/IBMsinit.sh\n\n+-------------------------------------------------------------------------------------+\n## SET muestra el valor por defecto\n+-------------------------------------------------------------------------------------+\n\nset | grep OUT",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/profile.d/IBMsinit.sh /home/${user^^}/IBMsinit.sh_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/profile.d/IBMsinit.sh /home/${user,,}/IBMsinit.sh_`date +%d%m%y_%T`\n",
        "editar": "+-------------------------------------------------------------------------------------+\n## Editar y Añadir al final del SCRIPT de UMASK\n+-------------------------------------------------------------------------------------+\n\nvi /etc/profile.d/IBMsinit.sh\n\nTMOUT=21600\nexport TMOUT",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\ncat /etc/profile.d/IBMsinit.sh\nset | grep OUT",
        "SO": "Linux"
    },
    {
        "modulo": "Protecting Resources-mixed/Ensure sticky bit is set on all world-writable directories",
        "clave": "STICKY",
        "descripcion": "Sticky bit is not set on world-writable directory: $directory",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Aplica a directorios y sub-directorios\n+-------------------------------------------------------------------------------------+\n\n## El desvio trata de aplicar sticky a directorios y sub-directorios, pero en este desvio corregiremos permisos de escritura en OTHER.\n\n+-------------------------------------------------------------------------------------+\n## Hay que tener en cuenta el tipo de owner que pertenece, cada directorio BASE.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Ya sea de tipo '/C/F/S'\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es /C/, se pasa a excepcion con RISK e IMPACT\n## por favor revisar la seccion de RISK e IMPACT\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es de tipo /F/S/, se debe preguntar al owner, si podemos modificar los permisos\n## Revisar ('PERMISSIONS'), antes de cualquier cambio.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Buscar y comprobar los directorios a cambiar permisos. \n+-------------------------------------------------------------------------------------+\n\n## DIRECTORIOS FORMA RECURVISA:\n---\n\n## Busca y muestra el total de directorios:\necho  \"directorios con permisos w en other : \";find $directory -type d -perm -o=wx | wc -l\n\n##Busca y enlista los directorios\nfind $directory -type d -perm -o=wx | xargs -l ls -ld\n\n## DIRECTORIOS FORMA INDIVIDUAL:\n---\nls -ld $directory\n\n+-------------------------------------------------------------------------------------+\n## Pregunta RELACIONADAS\n+-------------------------------------------------------------------------------------+\n\nProtecting Resources-OSRs/OSR \\TMP Files Restrictions\nProtecting Resources-OSRs/OSR \\OPT Files Restrictions\nProtecting Resources-OSRs/OSR \\ETC Restrictions\nProtecting Resources-OSRs/OSR \\VAR Files Restrictions",
        "copia": null,
        "editar": "+-------------------------------------------------------------------------------------+\n## Se puede quitar de forma 'RECURSIVA' o por 'INDIVIDUAL'\n\n## $directory : es la variable del directorio raiz a cambiar permisos.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Asi quitamos de permisos de W a Other, en los directorios('RECURSIVO'):\n+-------------------------------------------------------------------------------------+\n\nfind $directory -type d -perm -o=wx -exec chmod o-w {} \\;\n\n+-------------------------------------------------------------------------------------+\n## Asi quitamos permisos, de W a other de forma('INDIVIDUAL'):\n+-------------------------------------------------------------------------------------+\n\nchmod o-w $directory",
        "refrescar": null,
        "evidencia": "+-------------------------------------------------------------------------------------+\n## De forma ('RECURSIVA'):\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nfind $directory -type d -perm -o=wx | wc -l\nls -ld $directory\n\n+-------------------------------------------------------------------------------------+\n## De forma ('INDIVIDUAL'):\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -ld $directory",
        "SO": "Linux"
    },
    {
        "modulo": "Network Settings/Ensure LDAP Server is not enabled",
        "clave": "LDAP",
        "descripcion": "Ensure  LDAP Server is not enabled. Command: systemctl is-enabled slapd",
        "comprobacion": null,
        "copia": null,
        "editar": null,
        "refrescar": null,
        "evidencia": null,
        "SO": "Linux"
    },
    {
        "modulo": "Password Requirements//etc/profile IBMsinit sh",
        "clave": "TMOUT IBMSINIT.SH",
        "descripcion": "/etc/profile should not set/reset the time out control after '. /etc/profile.d/IBMsinit.sh' invocation.\n\n/etc/profile must trigger an invocation of '. /etc/profile.d/IBMsinit.sh', and does not set/reset the time out control after that invocation.",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## No deben existir 2 controles TMOUT en el servidor.\n\n## Revisar en /etc/profile, si tiene un TMOUT definido, se debe quitar\n\n## Si no existe la llamada a a IBMSinit.sh, se debe añadir\n+-------------------------------------------------------------------------------------+\n\ncat /etc/profile | egrep -i \"TMOUT|IBMsinit.sh\"\n\n+-------------------------------------------------------------------------------------+\n## En /etc/profile.d/IBMsinit.sh, al final del SCRIPT de UMASK\n## Debe tener un TMOUT:\n+-------------------------------------------------------------------------------------+\n\ncat /etc/profile.d/IBMsinit.sh",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/profile.d/IBMsinit.sh /home/${user^^}/IBMsinit.sh_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/profile.d/IBMsinit.sh /home/${user,,}/IBMsinit.sh_`date +%d%m%y_%T`\n",
        "editar": "+-------------------------------------------------------------------------------------+\n## Eliminar/Comentar la entrada TMOUT en /etc/profile.\n\n## Añadir '. /etc/profile.d/IBMsinit.sh', por debajo de un UMASK\n+-------------------------------------------------------------------------------------+\n\nvi /etc/profile",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\ncat /etc/profile | egrep -i \"TMOUT|IBMSinit.sh\"\ncat /etc/profile.d/IBMsinit.sh",
        "SO": "Linux"
    },
    {
        "modulo": "Password Requirements/Automatic Logoff IBMsinit csh autologout",
        "clave": "AUTOLOGOUT",
        "descripcion": "/etc/profile.d/IBMsinit.csh Default: Set systems to terminate a session after 360 minutes of inactivity. File must contain \"set autologout=360\". A shorter time frame may be specified.",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## En /etc/profile.d/IBMsinit.csh, al final del SCRIPT de UMASK\n## Debe tener un autologout\n(\"autologout solo debe estar implementado en 'IBMsinit.csh'\")\n+-------------------------------------------------------------------------------------+\n\ncat /etc/profile.d/IBMsinit.csh",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/profile.d/IBMsinit.csh /home/${user^^}/IBMsinit.csh_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/profile.d/IBMsinit.csh /home/${user,,}/IBMsinit.csh_`date +%d%m%y_%T`\n",
        "editar": "+-------------------------------------------------------------------------------------+## Editar y Añadir al final de SCRIPT de UMASK\n+-------------------------------------------------------------------------------------+\n\nvi /etc/profile.d/IBMsinit.csh\n\nset autologout=360",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\ncat /etc/profile.d/IBMsinit.csh",
        "SO": "Linux"
    },
    {
        "modulo": "Network Settings/CDE installed",
        "clave": "CDE",
        "descripcion": "Fileset X11. CDE must not be installed.",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Se puede desinstalar los CDE, ya que estan fuera de soporte, hay desisntalar todos los filesets, que nos muestra el comando\n+-------------------------------------------------------------------------------------+\n\nlslpp -L |grep -i CDE",
        "copia": null,
        "editar":"+-------------------------------------------------------------------------------------+\n## De esta manera se desinstala los filesets de CDE, copiar uno en uno, y el que no este añadirlo\n+-------------------------------------------------------------------------------------+\n\ninstallp -g -u X11.Dt.ToolTalk\ninstallp -g -u X11.Dt.adt\ninstallp -g -u X11.Dt.bitmaps\ninstallp -g -u X11.Dt.compat\ninstallp -g -u X11.Dt.helpinfo\ninstallp -g -u X11.Dt.helpmin\ninstallp -g -u X11.Dt.helprun\ninstallp -g -u X11.Dt.lib\ninstallp -g -u X11.Dt.rte\ninstallp -g -u X11.Dt.xdt2cde",
        "refrescar": null,
        "evidencia": "clear\ndate\nuname -a\nlslpp -L |grep -i CDE",
        "SO": "Aix"
    },
    {
        "modulo": "Password Requirements/Login Retries",
        "clave": "PAM_TALLY",
        "descripcion": "Non of the Login Retrie options was found in file:\n/etc/pam.d/password-auth\n/etc/pam.d/system-auth",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Hace referencia al 'pam_tally2.so' en RHEL 7, y al 'pam_faillock.so'  en RHEL 8.\n+-------------------------------------------------------------------------------------+\n\n## Saber que versión de RHEL es:\ncat /etc/*release\n\n#-*** Saber que PAM_TALLY USA (RHEL 7) ****-#\nls -ltr /lib64/security/pam_tally*\n\n#-*** Saber que PAM_FAILLOCK USA (RHEL 8) ****-#\nls -la /usr/sbin/faillock\n\n+-------------------------------------------------------------------------------------+\n##--- RHEL 7('system-auth','password-auth')\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Los ficheros del PAM, deben tener los parámetros:\n\n## - `auth        required      pam_tally2.so deny=5`\n## - `account     required      pam_tally2.so`\n+-------------------------------------------------------------------------------------+\n\ncat /etc/pam.d/system-auth | grep pam_tally\ncat /etc/pam.d/password-auth | grep pam_tally\n\n+-------------------------------------------------------------------------------------+\n##--- RHEL 8 ('system-auth','password-auth')\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Los ficheros del PAM, deben tener los parámetros:\n\n## - `auth        required        pam_faillock.so preauth silent deny=5 unlock_time=0`\n## - `auth        [default=die] pam_faillock.so authfail deny=5 unlock_time=0`\n\n## - `account     required      pam_faillock.so`\n+-------------------------------------------------------------------------------------+\n\ncat /etc/pam.d/system-auth | grep pam_faillock.so\ncat /etc/pam.d/password-auth | grep pam_faillock.so\n\n",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/pam.d/system-auth /home/${user^^}/system-auth_`date +%d%m%y_%T`\n\ncp -p /etc/pam.d/password-auth /home/${user^^}/password-auth_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/pam.d/system-auth /home/${user,,}/system-auth_`date +%d%m%y_%T`\n\ncp -p /etc/pam.d/password-auth /home/${user,,}/password-auth_`date +%d%m%y_%T`\n",
        "editar": "+-------------------------------------------------------------------------------------+\n##--- RHEL 7 ('system-auth','password-auth')\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Añadir en el modulo 'auth required', el parámetro 'pam_tally2.so'\n## Se debe añadir en la primero linea del modulo auth\n## ('se aconseja remplazar la linea del modulo')\n+-------------------------------------------------------------------------------------+\n\nvi /etc/pam.d/system-auth\n\nauth        required      pam_tally2.so deny=5\n\n+-------------------------------------------------------------------------------------+\n## Añadir en el modulo 'account required', el parámetro 'pam_tally2.so'.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Se debe añadir en la primera linea del modulo account.\n## ('se aconseja remplazar la linea del modulo').\n+-------------------------------------------------------------------------------------+\n\naccount     required      pam_tally2.so\n\n+-------------------------------------------------------------------------------------+\n## Lo mismo con 'password-auth'\n+-------------------------------------------------------------------------------------+\n\nvi /etc/pam.d/password-auth\n\n+-------------------------------------------------------------------------------------+\n##--- RHEL 8 ('system-auth','password-auth')\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Añadir en el modulo 'auth required', el parámetro 'pam_faillock.so'\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Se debe añadir en la primera linea del modulo auth.\n## ('se aconseja remplazar la linea del modulo').\n+-------------------------------------------------------------------------------------+\n\nvi /etc/pam.d/system-auth\n\nauth        required        pam_faillock.so preauth silent deny=5 unlock_time=0\n\n+-------------------------------------------------------------------------------------+\n## Ademas se debe añadir la siguiente linea, por encima de 'auth required pam_deny.so'\n+-------------------------------------------------------------------------------------+\n\nauth        [default=die] pam_faillock.so authfail deny=5 unlock_time=0\n\n+-------------------------------------------------------------------------------------+\n## Añadir en el modulo 'account required', el parámetro 'pam_faillock.so'.\n## Se debe añadir en la primera linea del modulo account.\n## ('se aconseja remplazar la linea del modulo').\n+-------------------------------------------------------------------------------------+\n\naccount     required      pam_faillock.so\n\n+-------------------------------------------------------------------------------------+\n## Lo mismo con 'password-auth'\n+-------------------------------------------------------------------------------------+\n\nvi /etc/pam.d/password-auth\n\n",
        "refrescar": null,
        "evidencia": "+-------------------------------------------------------------------------------------+\n##--- RHEL 7('system-auth','password-auth')\n+-------------------------------------------------------------------------------------+\nclear\ndate;hostname\ncat /etc/*release | grep -i release\ncat /etc/pam.d/system-auth | egrep \"pam_tally\" \ncat /etc/pam.d/password-auth | egrep \"pam_tally\"\n\n+-------------------------------------------------------------------------------------+\n##--- RHEL 8 ('system-auth','password-auth')\n+-------------------------------------------------------------------------------------+\nclear\ndate;hostname\ncat /etc/*release | grep -i release\ncat /etc/pam.d/system-auth | egrep \"pam_faillock\" \ncat /etc/pam.d/password-auth | egrep \"pam_faillock\"",
        "SO": "Linux"
    },
    {
    "modulo": "AD.1.1.13.1.0 Password Requirements",
    "clave": "LISTFILE.SO",
    "descripcion": "For Red Hat\n/etc/pam.d/system-auth and /etc/pam.d/password-auth must exist and include these settings\nauth required /$LIB/security/$ISA/pam_listfile.so item=user sense=deny file=/etc/security/$FILENAME onerr=succeed",
    "comprobacion": "+-------------------------------------------------------------------------------------+\n## Hace referencia al 'pam_listfile.so' en RHEL 7, y RHEL 8.\n+-------------------------------------------------------------------------------------+\n\n## Saber que versión de RHEL es:\ncat /etc/*release\n\n#-*** Saber que PAM_TALLY USA (RHEL 7) ****-#\nls -ltr /lib64/security/pam_tally*\n\n#-*****#buscar que LIB usa#******-#\nfind /lib*/security/ -name pam_listfile.so \n\n+-------------------------------------------------------------------------------------+\n##--- RHEL 7 & RHEL 8('system-auth')\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Los ficheros del PAM, deben tener en el modulo 'auth required', el parámetro 'pam_listfile.so'\n+-------------------------------------------------------------------------------------+\n\ncat /etc/pam.d/system-auth | grep pam_listfile.so",
    "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/pam.d/system-auth /home/${user^^}/system-auth_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/pam.d/system-auth /home/${user,,}/system-auth_`date +%d%m%y_%T`\n\n",
    "editar": "+-------------------------------------------------------------------------------------+\n##--- RHEL 7 & RHEL 8('system-auth')\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Añadir en el modulo 'auth required', el parámetro 'pam_listfile.so'\n## Se debe añadir en la primero linea del modulo auth\n## ('se aconseja remplazar la linea del modulo')\n+-------------------------------------------------------------------------------------+\n\nvi /etc/pam.d/system-auth\n\nauth        required      /lib/security/pam_listfile.so item=user sense=deny file=/etc/security/$FILENAME onerr=succeed",
    "refrescar": null,
    "evidencia": "+-------------------------------------------------------------------------------------+\n##--- RHEL 7 & RHEL 8('system-auth','password-auth')\n+-------------------------------------------------------------------------------------+\nclear\ndate;hostname\ncat /etc/*release | grep -i release\ncat /etc/pam.d/system-auth | egrep \"pam_listfile.so\"",
    "SO": "Linux"    
    },
    {
        "modulo": "Protecting Resources-OSRs/OSR /VAR Files Restrictions",
        "clave": "OSRVAR",
        "descripcion": "Invalid permissions for $fileVAR  Octal permissions: 0777  Text Permissions: -rwxrwxrwx;  May not have execute permissions on any files and no write for others.",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Aplica a ficheros del directorio /VAR\n+-------------------------------------------------------------------------------------+\n\n## El desvio trata de quitarle escritura a OTHER, a ficheros que tienen escritura y ejecucion que cuelgan en el directorio /VAR y sub-directorios.\n\n+-------------------------------------------------------------------------------------+\n## Hay que tener en cuenta el tipo de owner que pertenece, cada fichero o directorio BASE.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Ya sea de tipo '/C/F/S/'\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es /C/, se pasa a excepcion con RISK e IMPACT\n(Por favor revisar la seccion de RISK e IMPACT)\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es de tipo /F/S/, se debe preguntar al owner, si podemos modificar los permisos\n## Revisar ('PERMISSIONS'), antes de cualquier cambio.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Buscar y comprobar los fichero a cambiar permisos.\n+-------------------------------------------------------------------------------------+\n\n## FICHEROS FORMA RECURVISA:\n---\necho \"ficheros con permisos w en other : \";find $fileVAR -type f -perm -o=wx | wc -l\nfind $fileVAR -type f -perm -o=wx | xargs -l ls -l\n\n## FICHERO\n---\nls -l $fichero\n\n+-------------------------------------------------------------------------------------+\n## Pregunta RELACIONADAS\n+-------------------------------------------------------------------------------------+\n\nProtecting Resources-mixed/Ensure sticky bit is set on all world-writable directories",        "copia": null,
        "editar": "+-------------------------------------------------------------------------------------+\n## Se puede quitar de forma 'RECURSIVA' o por 'INDIVIDUAL'\n\n## VARIABLES:\n## $fileVAR : es la variable del directorio base de los ficheros a cambiar permisos.\n## $fichero : es la variable, del fichero a cambiar permiso.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Asi quitamos de permisos de W a Other, en los ficheros('RECURSIVO'):\n+-------------------------------------------------------------------------------------+\n\nfind $fileVAR -type f -perm -o=wx -exec chmod o-w {} \\;\n\n+-------------------------------------------------------------------------------------+\n## Asi quitamos permisos, de W a other de forma('INDIVIDUAL'):\n+-------------------------------------------------------------------------------------+\n\nchmod o-w $fichero",        
        "refrescar": null,
        "evidencia": "+-------------------------------------------------------------------------------------+\n## De forma ('RECURSIVA'):\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nfind $fileVAR -type f -perm -o=wx | wc -l\nls -ld $fileVAR\n\n+-------------------------------------------------------------------------------------+\n## De forma('INDIVIDUAL'):\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -l $fichero",        "SO": "Linux"
    },
    {
        "modulo": "AD.1.8.22.2 Protecting Resources - OSRs",
        "clave": "",
        "descripcion": "Invalid permissions for $fileVAR  Octal permissions: 0777  Text Permissions: -rwxrwxrwx;  May not have execute permissions on any files and no write for others.",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Aplica a ficheros del directorio /VAR\n+-------------------------------------------------------------------------------------+\n\n## El desvio trata de quitarle escritura a OTHER, a ficheros que tienen escritura y ejecucion que cuelgan en el directorio /VAR y sub-directorios.\n\n+-------------------------------------------------------------------------------------+\n## Hay que tener en cuenta el tipo de owner que pertenece, cada fichero o directorio BASE.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Ya sea de tipo '/C/F/S/'\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es /C/, se pasa a excepcion con RISK e IMPACT\n(Por favor revisar la seccion de RISK e IMPACT)\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es de tipo /F/S/, se debe preguntar al owner, si podemos modificar los permisos\n## Revisar ('PERMISSIONS'), antes de cualquier cambio.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Buscar y comprobar los fichero a cambiar permisos.\n+-------------------------------------------------------------------------------------+\n\n## FICHEROS FORMA RECURVISA:\n---\necho \"ficheros con permisos w en other : \";find $fileVAR -type f -perm -o=wx | wc -l\nfind $fileVAR -type f -perm -o=wx | xargs -l ls -l\n\n## FICHERO\n---\nls -l $fichero\n\n+-------------------------------------------------------------------------------------+\n## Pregunta RELACIONADAS\n+-------------------------------------------------------------------------------------+\n\nProtecting Resources-mixed/Ensure sticky bit is set on all world-writable directories",        "copia": null,
        "editar": "+-------------------------------------------------------------------------------------+\n## Se puede quitar de forma 'RECURSIVA' o por 'INDIVIDUAL'\n\n## VARIABLES:\n## $fileVAR : es la variable del directorio base de los ficheros a cambiar permisos.\n## $fichero : es la variable, del fichero a cambiar permiso.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Asi quitamos de permisos de W a Other, en los ficheros('RECURSIVO'):\n+-------------------------------------------------------------------------------------+\n\nfind $fileVAR -type f -perm -o=wx -exec chmod o-w {} \\;\n\n+-------------------------------------------------------------------------------------+\n## Asi quitamos permisos, de W a other de forma('INDIVIDUAL'):\n+-------------------------------------------------------------------------------------+\n\nchmod o-w $fichero",        
        "refrescar": null,
        "evidencia": "+-------------------------------------------------------------------------------------+\n## De forma ('RECURSIVA'):\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nfind $fileVAR -type f -perm -o=wx | wc -l\nls -ld $fileVAR\n\n+-------------------------------------------------------------------------------------+\n## De forma('INDIVIDUAL'):\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -l $fichero",        "SO": "Linux"
    },
    {
        "modulo": "Business Use Notice/Business Use Notice Required",
        "clave": "BUN",
        "descripcion": "Missing or Incorrect Business Use Notice. It should be set in /etc/motd",
        "comprobacion": "##Debe tener el BUN actual.",
        "copia": null,
        "editar": "vi /etc/motd\n\n##añadir / remplazar :\n\n* *--------------------------------------------------------------* *\n* * This system should be used for conducting IBM's              * *\n* * business or for purposes authorized by IBM management.       * *\n* *                                                              * *\n* * It is mandatory to comply with all the requirements          * *\n* * listed in the applicable security policy and only process    * *\n* * or store the data classes approved for this asset type.      * *\n* *                                                              * *\n* * Use is subject to audit at any time by IBM management.       * *\n* *                                                              * *\n* *--------------------------------------------------------------* *",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\ncat /etc/motd",
        "SO": "Linux"
    },
    {
        "modulo": "E.2.0.1 Business Use Notice",
        "clave": "BUN",
        "descripcion": "Missing or Incorrect Business Use Notice. It should be set in /etc/motd",
        "comprobacion": "##Debe tener el BUN actual.",
        "copia": null,
        "editar": "vi /etc/motd\n\n##añadir / remplazar :\n\n* *--------------------------------------------------------------* *\n* * This system should be used for conducting IBM's              * *\n* * business or for purposes authorized by IBM management.       * *\n* *                                                              * *\n* * It is mandatory to comply with all the requirements          * *\n* * listed in the applicable security policy and only process    * *\n* * or store the data classes approved for this asset type.      * *\n* *                                                              * *\n* * Use is subject to audit at any time by IBM management.       * *\n* *                                                              * *\n* *--------------------------------------------------------------* *",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\ncat /etc/motd",
        "SO": "Linux"
    },
    {
        "modulo": "Password Requirements/Password History",
        "clave": "PAM REMEMBER",
        "descripcion": "PAM service file: /etc/pam.d/password-auth\nPAM service file: /etc/pam.d/system-auth\nMust have \"password sufficient pam_unix.so\" stanza with \"remember=8\" parameter. \"sufficient\" can be replaced with \"required\".",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Hace referencia al 'remember' en RHEL 7 y RHEL 8.\n+-------------------------------------------------------------------------------------+\n\n## Saber que versión de RHEL es:\ncat /etc/*release\n\n#-***# Saber que PAM_TALLY USA (RHEL 7) #****-#\nls -ltr /lib64/security/pam_tally*\n\n#-*** Saber que PAM_FAILLOCK USA (RHEL 8) ****-#\nls -la /usr/sbin/faillock\n\n+-------------------------------------------------------------------------------------+\n##--- RHEL 7 & RHEL 8 ('system-auth','password-auth')\n+-------------------------------------------------------------------------------------+\n\n## Los ficheros del PAM, deben tener en el modulo 'password    sufficient    pam_unix.so', el parámetro 'remember=8'\n\ncat /etc/pam.d/system-auth | grep remember\ncat /etc/pam.d/password-auth | grep remember\n\n+-------------------------------------------------------------------------------------+\n## Modulo similiar : 'Encryption/Password Encryption Required'\n+-------------------------------------------------------------------------------------+",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/pam.d/system-auth /home/${user^^}/system-auth_`date +%d%m%y_%T`\n\ncp -p /etc/pam.d/password-auth /home/${user^^}/password-auth_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/pam.d/system-auth /home/${user,,}/system-auth_`date +%d%m%y_%T`\n\ncp -p /etc/pam.d/password-auth /home/${user,,}/password-auth_`date +%d%m%y_%T`\n",
        "editar": "+-------------------------------------------------------------------------------------+\n##--- RHEL 7 & RHEL 8 ('system-auth','password-auth')\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Añadir en el modulo 'password    sufficient    pam_unix.so', el parámetro 'remember=8'.\n## ('se aconseja remplazar toda la linea, del modulo 'password    sufficient    pam_unix.so').\n+-------------------------------------------------------------------------------------+\n\nvi /etc/pam.d/system-auth\n\npassword    sufficient    pam_unix.so remember=8 use_authtok sha512 shadow try_first_pass\n\n+-------------------------------------------------------------------------------------+\n## Lo mismo con 'password-auth'\n+-------------------------------------------------------------------------------------+\n\nvi /etc/pam.d/password-auth\n",
        "refrescar": null,
        "evidencia": "+-------------------------------------------------------------------------------------+\n##--- RHEL 7 & RHEL 8 ('system-auth','password-auth')\n+-------------------------------------------------------------------------------------+\nclear\ndate;hostname\ncat /etc/*release | grep -i release\ncat /etc/pam.d/system-auth | egrep \"remember\" \ncat /etc/pam.d/password-auth | egrep \"remember\"\n",
        "SO": "Linux"
    },
    {
        "modulo": "Encryption/Password Encryption Required",
        "clave": "PAM SHA512",
        "descripcion": "/etc/pam.d/password-auth.\n/etc/pam.d/system-auth.\nAny file in /etc/pam.d containing \"password sufficient pam_unix.so\" stanza must carry the \"sha512 shadow\" options.\n\nIncorrect or missing pam_unix.so module stanza. For more information see coverage matrix document",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Hace referencia al parametro 'sha512 shadow ' en RHEL 7 y RHEL 8.\n+-------------------------------------------------------------------------------------+\n\n## Saber que versión de RHEL es:\n\ncat /etc/*release\n\n+-------------------------------------------------------------------------------------+\n##--- RHEL 7 & RHEL 8 ('system-auth','password-auth')\n## Los ficheros del PAM, deben tener en el modulo 'password    sufficient    pam_unix.so', el parámetro 'sha512 shadow '\n## Ademas deben ser LINK de 'system-auth-ac', 'password-auth-ac'.\n+-------------------------------------------------------------------------------------+\n\ncat /etc/pam.d/system-auth | egrep \"sha512|shadow\"\ncat /etc/pam.d/password-auth | egrep \"sha512|shadow\"\nls -la /etc/pam.d/system-auth\nls -la /etc/pam.d/password-auth\n\n+-------------------------------------------------------------------------------------+\n## Si la configuracion anterior es valida. revisar que no hayan BACKUPS de los ficheros del PAM\n\n## Ficheros .ori, .bck, .backup, -local, o todo aquel que sea una copia de, 'system-auth', 'password-auth', o de 'system-auth-ac', 'password-auth-ac'\n+-------------------------------------------------------------------------------------+\n\ncd /etc/pam.d/\nls -la system-*\nls -la password-*\n\n+-------------------------------------------------------------------------------------+\n## Mover los BACKUPS al home\n+-------------------------------------------------------------------------------------+\n## Hacer link entre 'system-auth' y 'system-auth-ac', o 'password-auth' y 'password-auth-ac', SI ES NECESARIO\n\n## El siguiente comando, es para los ficheros del PAM, sean LINK.\n+-------------------------------------------------------------------------------------+\n\nrm -r system-auth\nln -s system-auth-ac system-auth\n\nrm -r password-auth\nln -s password-auth-ac password-auth\n\n+-------------------------------------------------------------------------------------+\n## Modulo similiar : 'Password Requirements/Password History'\n+-------------------------------------------------------------------------------------+",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/pam.d/system-auth /home/${user^^}/system-auth_`date +%d%m%y_%T`\n\ncp -p /etc/pam.d/password-auth /home/${user^^}/password-auth_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/pam.d/system-auth /home/${user,,}/system-auth_`date +%d%m%y_%T`\n\ncp -p /etc/pam.d/password-auth /home/${user,,}/password-auth_`date +%d%m%y_%T`\n",
        "editar": "+-------------------------------------------------------------------------------------+\n##--- RHEL 7 & RHEL 8 ('system-auth','password-auth')\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Añadir en el modulo 'password    sufficient    pam_unix.so', el parámetro 'sha512 shadow'.\n## ('se aconseja remplazar toda la linea, del modulo 'password    sufficient    pam_unix.so').\n+-------------------------------------------------------------------------------------+\n\nvi /etc/pam.d/system-auth\n\npassword    sufficient    pam_unix.so remember=8 use_authtok sha512 shadow try_first_pass\n\n+-------------------------------------------------------------------------------------+\n## Lo mismo con 'password-auth'\n+-------------------------------------------------------------------------------------+\n\nvi /etc/pam.d/password-auth\n",
        "refrescar": null,
        "evidencia": "clear\ndate;hostname\ncat /etc/*release | grep -i release\ncat /etc/pam.d/system-auth | egrep \"sha512|shadow\"\ncat /etc/pam.d/password-auth | egrep \"sha512|shadow\"\n",
        "SO": "Linux"
    },
    {
        "modulo": "Identify and Authenticate Users/Public Key Label",
        "clave": "LABEL",
        "descripcion": "SSH authorized_keys file: $file_authorized; Some of the keys have no identifying label",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## En este tipo de desviaciones, las claves publicas(\"authorized_keys\")\n## Deben tener un LABEL que que indetifique a quien pertenece la clave publica\n## Antes de seguir, revisar -* AUTHORIZED_KEYS *-\n\n+-------------------------------------------------------------------------------------+\n## Revisamos si tiene un LABEL que es el GECOS, al final de cada clave `ssh-rsa` y este entre !! y !!\n## El fichero debe ser solo accesible al owner\n+-------------------------------------------------------------------------------------+\n\nls -la $file_authorized\ncat $file_authorized\n\n## PUEDEN EXISTIR 3 OPCIONES DIFERENTES:\n\n## --> OPCION 1\n+-------------------------------------------------------------------------------------+\n## Si el fichero authorized_keys es de root, no debe tener un fichero authorized_keys.\n## Pasamos directamente a renombrar el fichero authorized_keys para owner root.\n## ('SI HAY DUDAS, consultarlo con el tecnico')\n+-------------------------------------------------------------------------------------+\n\n## --> OPCION 2\n+-------------------------------------------------------------------------------------+\n## Corregir el LABEL a las claves publicas, ya sean /C/F/S, /K/I/E/\n+-------------------------------------------------------------------------------------+\n\n## --> OPCION 3\n+-------------------------------------------------------------------------------------+\n## Renombrar los ficheros authorized_keys que tenga owner huerfanos\n+-------------------------------------------------------------------------------------+\n",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n## LINUX\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p $file_authorized /home/${user^^}/authorized_key_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p $file_authorized /home/${user,,}/authorized_key_`date +%d%m%y_%T`\n\n## AIX\n+-------------------------------------------------------------------------------------+\n## Backup\n+-------------------------------------------------------------------------------------+\ncp -p \"$file_authorized\" /home/$user/authorized_key_`date +%d%m%y_%T`\n",
        "editar": "## --> OPCION 1\n+-------------------------------------------------------------------------------------+\n## Para ficheros authorized_keys, con owner root.\n+-------------------------------------------------------------------------------------+\n\nmv /home/root/.ssh/authorized_keys /home/root/.ssh/authorized_keys.save\n\n\n## --> OPCION 2\n+-------------------------------------------------------------------------------------+\n## --- Añadir GECOS de forma AUTOMATICA\n+-------------------------------------------------------------------------------------+\n\nsed -i 's,$,'\" $gecos\"',' \"$file_authorized\"\n\n+-------------------------------------------------------------------------------------+\n## Editar y añadir el GECOS de forma MANUAL\n+-------------------------------------------------------------------------------------+\n\nvi $file_authorized\n\n## Añadir el GECOS de la cuenta al final de la clave 'ssh-rsa' o si existe, debe estar ENTRE !! y !!\n\n## --> OPCION 3\n+-------------------------------------------------------------------------------------+\n## Si no existe la cuenta se puede RENOMBRAR el fichero\n+-------------------------------------------------------------------------------------+\n\nmv $file_authorized $file_authorized.save\n",
        "refrescar": null,
        "evidencia": "+-------------------------------------------------------------------------------------+\n## --> OPCION 1\n+-------------------------------------------------------------------------------------+\nclear\ndate\nhostname\nls -la /home/root/.ssh/authorized_keys\n\n+-------------------------------------------------------------------------------------+\n## --> OPCION 2 & ## --> OPCION 3\n+-------------------------------------------------------------------------------------+\nclear\ndate\nhostname\nls -la $file_authorized\ncat $file_authorized",
        "SO": "Linux"
    },
    {
        "modulo": "AV.1.7.2.1 Identify and Authenticate Users",
        "clave": "",
        "descripcion": "SSH authorized_keys file: $file_authorized; Some of the keys have no identifying label",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## En este tipo de desviaciones, las claves publicas(\"authorized_keys\")\n## Deben tener un LABEL que que indetifique a quien pertenece la clave publica\n## Antes de seguir, revisar -* AUTHORIZED_KEYS *-\n\n+-------------------------------------------------------------------------------------+\n## Revisamos si tiene un LABEL que es el GECOS, al final de la clave y este entre !! y !!\n## Debe ser solo accesible al owner\n+-------------------------------------------------------------------------------------+\n\nls -la $file_authorized\ncat $file_authorized\n\n## PUEDEN EXISTIR 3 OPCIONES DIFERENTES:\n\n## --> OPCION 1\n+-------------------------------------------------------------------------------------+\n## Si el fichero authorized_keys es de root, no debe tener un fichero authorized_keys.\n## Pasamos directamente a renombrar el fichero authorized_keys para owner root.\n## ('SI HAY DUDAS, consultarlo con el tecnico')\n+-------------------------------------------------------------------------------------+\n\n## --> OPCION 2\n+-------------------------------------------------------------------------------------+\n## Si el fichero authorized_keys, pertenece a otro owner o grupo que no sea root.\n## Si es de TIPO /F/ o /S/ (sistemas / aplicativo)\n## se debe contactar con el owner o grupo del fichero. y decirle que se va crear un LABEL para indentificar la clave publica\n## - Si se va a excepcionar nos deben especificar un RISK e IMPACT.\n\n## - Si se va a corregir.\n## Revisar ('authorized_keys'), antes de cualquier cambio.\n\n## Si es de TIPO /C/ (customer)\n## - Se debe excepcionar.\n## Por favor revisar la sección de RISK e IMPACT.\n+-------------------------------------------------------------------------------------+\n\n## --> OPCION 3\n+-------------------------------------------------------------------------------------+\n## Si el fichero authorized_keys, pertenece a otro owner o grupo que no sea root.\n## SI es de tipo /E/, /I/, /K/\n## - Si es una cuenta 'externa' y no existe en el servidor, se puede renombrar el fichero authorized_key.\n## - Si la cuenta existe, se puede crear un LABEL para indentificar la clave publica.\n+-------------------------------------------------------------------------------------+",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n## LINUX\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p $file_authorized /home/${user^^}/authorized_key_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p $file_authorized /home/${user,,}/authorized_key_`date +%d%m%y_%T`\n\n## AIX\n+-------------------------------------------------------------------------------------+\n## Backup\n+-------------------------------------------------------------------------------------+\ncp -p \"$file_authorized\" /home/$user/authorized_key_`date +%d%m%y_%T`\n",
        "editar": "## --> OPCION 1\n+-------------------------------------------------------------------------------------+\n## Para ficheros authorized_keys, con owner root.\n+-------------------------------------------------------------------------------------+\n\nmv /home/root/.ssh/authorized_keys /home/root/.ssh/authorized_keys.save\n\n\n## --> OPCION 2 y ## --> OPCION 3\n+-------------------------------------------------------------------------------------+\n## Para otros ficheros authorized_keys.\n## De tipo /F/S/ o sin owner o account externas/internas tipo /E/, /I/, /K/\n## Mostrar / Copiar el GECOS a insertar en el fichero authorized_keys, al final de cada clave 'ssh-rsa'\n+-------------------------------------------------------------------------------------+\n\n## -- Muestra el GECOS\necho \"$gecos\"\n\n## Editar\nvi $file_authorized\n\nAñadir el GECOS de la cuenta al final de la clave 'ssh-rsa' o si existe, debe estar ENTRE !! y !!\n\n+-------------------------------------------------------------------------------------+\n## Si no existe la cuenta se puede RENOMBRAR el fichero\n+-------------------------------------------------------------------------------------+\n\nmv $file_authorized $file_authorized.save\n",
        "refrescar": null,
        "evidencia": "## --> OPCION 1\n+-------------------------------------------------------------------------------------+\n## Para ficheros authorized_keys, con owner root.\n+-------------------------------------------------------------------------------------+\nclear\ndate\nhostname\nls -la /home/root/.ssh/authorized_keys\n\n\n## --> OPCION 2 y ## --> OPCION 3\n+-------------------------------------------------------------------------------------+\n## Para otros ficheros authorized_keys.\n## De tipo /F/S/ o sin owner o account externas/internas tipo /E/ o /I/\n+-------------------------------------------------------------------------------------+\nclear\ndate\nhostname\ncat $file_authorized ",
        "SO": "Linux"
    },
    {
        "modulo": "Password Requirements/Private Key File Restriction",
        "clave": "AUTHORIZED_KEY",
        "descripcion": "SSH authorized_keys file: \"FICHERO AUTHORIZED KEYS\"; Invalid from section: . \"*º\" or \"*.*.*.*\" or \"0/0\" or \"0.0.0.0/0\" or empty are forbidden values in the \"from=\" parameter",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## En este tipo de desviaciones, las claves publicas (\"authorized_keys\")\n## Deben tener un FROM que especifique el host remoto o direccion IP.\n\n## Antes de seguir, revisar ('AUTHORIZED')\n+-------------------------------------------------------------------------------------+\n## Revisamos si tiene un FROM, que especifica el host remoto o IP\n## Debe ser solo accesible al owner\n+-------------------------------------------------------------------------------------+\n\nls -la $file_authorized\ncat $file_authorized\n\n## PUEDEN EXISTIR 3 OPCIONES DIFERENTES:\n\n## --> OPCION 1\n+-------------------------------------------------------------------------------------+\n## Si el fichero authorized_keys pertenece a la cuenta root, Root no debe tener un fichero authorized_keys.\n## Pasamos directamente a renombrar el fichero authorized_keys para el owner root.\n\n## ('SI HAY DUDAS, consultarlo con el tecnico')\n+-------------------------------------------------------------------------------------+\n\n## --> OPCION 2\n+-------------------------------------------------------------------------------------+\n## Si el fichero authorized_keys es de TIPO /F/ o /S/ (sistemas / aplicativo)\n## Se debe notificar al owner o grupo del fichero.\n\n## - Si se va a excepcionar nos deben especificar un RISK e IMPACT.\n\n## - Si se va a corregir (nos deben facilitar la IP o HOST).\n+-------------------------------------------------------------------------------------+\n## Si es de TIPO /C/ (customer)\n\n## - Se debe excepcionar.\n\n## Revisar RISK e IMPACT.\n+-------------------------------------------------------------------------------------+\n\n## --> OPCION 3\n+-------------------------------------------------------------------------------------+\n## Si el fichero authorized_keys, es de tipo /E/. /I/./K/\n\n## - Si es una cuenta 'externa' y no existe en el servidor, se puede renombrar el fichero authorized_key.\n\n## - Si la cuenta existe, se debe notificar al owner de la cuenta.\n+-------------------------------------------------------------------------------------+",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n## LINUX\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p $file_authorized /home/${user^^}/authorized_key_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p $file_authorized /home/${user,,}/authorized_key_`date +%d%m%y_%T`\n\n## AIX\n+-------------------------------------------------------------------------------------+\n## Backup\n+-------------------------------------------------------------------------------------+\n\ncp -p \"$file_authorized\" /home/$user/authorized_key_`date +%d%m%y_%T`\n",
        "editar": "## --> OPCION 1\n+-------------------------------------------------------------------------------------+\n## Para ficheros authorized_keys, con owner root.\n+-------------------------------------------------------------------------------------+\n\nmv /home/root/.ssh/authorized_keys /home/root/.ssh/authorized_keys.save\n\n\n## --> OPCION 2 y ## --> OPCION 3\n+-------------------------------------------------------------------------------------+\n## Para ficheros authorized_keys, de tipo /F/S/ o sin owner o account externas/internas de tipo /E/ o /I/.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Donde se tengan que renombar el fichero.\n+-------------------------------------------------------------------------------------+\n\nmv $file_authorized $file_authorized.save\n\n+-------------------------------------------------------------------------------------+\n## Donde se tenga que añadir un FROM.\n+-------------------------------------------------------------------------------------+\n\nvi $file_authorized\n\n+-------------------------------------------------------------------------------------+\n## Añadir la línea from=\"IP\", al inicio de cada clave shh-rsa:\n+-------------------------------------------------------------------------------------+\n## EJEMPLO\n\nfrom=\"129.39.41.5,129.39.41.6\" ssh-rsa AAAAB3NzaC1yc2EAAAABIw== !!CZ/S/*ABJ83/IBM/Automation ID!!\n",
        "refrescar": null,
        "evidencia": "## --> OPCION 1\n+-------------------------------------------------------------------------------------+\n## Para ficheros authorized_keys, con owner root.\n+-------------------------------------------------------------------------------------+\nclear\ndate\nhostname\nls -la /home/root/.ssh/authorized_keys\n\n\n## --> OPCION 2 y ## --> OPCION 3\n+-------------------------------------------------------------------------------------+\n## Para ficheros authorized_keys, de tipo /F/S/, sin owner o account externas/internas tipo /E/, /I/ /K/\n+-------------------------------------------------------------------------------------+\nclear\ndate\nhostname\nls -la $file_authorized\ncat $file_authorized",        
        "SO": "Linux / Aix"
    },
    {
        "modulo": "AV.1.1.6 Password Requirements",
        "clave": "AUTHORIZED_KEY",
        "descripcion": "## (MODULO RELACIONADO : AV.1.1.7 Password Requirements)\n\n## SSH authorized_keys file: \"FICHERO AUTHORIZED KEYS\"; Invalid from section: . \"*º\" or \"*.*.*.*\" or \"0/0\" or \"0.0.0.0/0\" or empty are forbidden values in the \"from=\" parameter",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## En este tipo de desviaciones, las claves publicas (\"authorized_keys\")\n## Deben tener un FROM que especifique el host remoto o direccion IP.\n\n## Antes de seguir, revisar ('AUTHORIZED')\n+-------------------------------------------------------------------------------------+\n## Revisamos si tiene un FROM, que especifica el host remoto o IP\n## Debe ser solo accesible al owner\n+-------------------------------------------------------------------------------------+\n\nls -la $file_authorized\ncat $file_authorized\n\n## PUEDEN EXISTIR 3 OPCIONES DIFERENTES:\n\n## --> OPCION 1\n+-------------------------------------------------------------------------------------+\n## Si el fichero authorized_keys pertenece a la cuenta root, Root no debe tener un fichero authorized_keys.\n## Pasamos directamente a renombrar el fichero authorized_keys para el owner root.\n\n## ('SI HAY DUDAS, consultarlo con el tecnico')\n+-------------------------------------------------------------------------------------+\n\n## --> OPCION 2\n+-------------------------------------------------------------------------------------+\n## Si el fichero authorized_keys es de TIPO /F/ o /S/ (sistemas / aplicativo)\n## Se debe notificar al owner o grupo del fichero.\n\n## - Si se va a excepcionar nos deben especificar un RISK e IMPACT.\n\n## - Si se va a corregir (nos deben facilitar la IP o HOST).\n+-------------------------------------------------------------------------------------+\n## Si es de TIPO /C/ (customer)\n\n## - Se debe excepcionar.\n\n## Revisar RISK e IMPACT.\n+-------------------------------------------------------------------------------------+\n\n## --> OPCION 3\n+-------------------------------------------------------------------------------------+\n## Si el fichero authorized_keys, es de tipo /E/. /I/./K/\n\n## - Si es una cuenta 'externa' y no existe en el servidor, se puede renombrar el fichero authorized_key.\n\n## - Si la cuenta existe, se debe notificar al owner de la cuenta.\n+-------------------------------------------------------------------------------------+",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n## LINUX\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p $file_authorized /home/${user^^}/authorized_key_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p $file_authorized /home/${user,,}/authorized_key_`date +%d%m%y_%T`\n\n## AIX\n+-------------------------------------------------------------------------------------+\n## Backup\n+-------------------------------------------------------------------------------------+\n\ncp -p \"$file_authorized\" /home/$user/authorized_key_`date +%d%m%y_%T`\n",
        "editar": "## --> OPCION 1\n+-------------------------------------------------------------------------------------+\n## Para ficheros authorized_keys, con owner root.\n+-------------------------------------------------------------------------------------+\n\nmv /home/root/.ssh/authorized_keys /home/root/.ssh/authorized_keys.save\n\n\n## --> OPCION 2 y ## --> OPCION 3\n+-------------------------------------------------------------------------------------+\n## Para ficheros authorized_keys, de tipo /F/S/ o sin owner o account externas/internas de tipo /E/ o /I/.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Donde se tengan que renombar el fichero.\n+-------------------------------------------------------------------------------------+\n\nmv $file_authorized $file_authorized.save\n\n+-------------------------------------------------------------------------------------+\n## Donde se tenga que añadir un FROM.\n+-------------------------------------------------------------------------------------+\n\n##Mostrar FROM\n\necho \"$from\"\n\nvi $file_authorized\n\n+-------------------------------------------------------------------------------------+\n## Añadir la línea from=\"IP\", al inicio de cada clave shh-rsa:\n+-------------------------------------------------------------------------------------+\n## EJEMPLO\n\nfrom=\"129.39.41.5,129.39.41.6\" ssh-rsa AAAAB3NzaC1yc2EAAAABIw== !!CZ/S/*ABJ83/IBM/Automation ID!!\n",
        "refrescar": null,
        "evidencia": "## --> OPCION 1\n+-------------------------------------------------------------------------------------+\n## Para ficheros authorized_keys, con owner root.\n+-------------------------------------------------------------------------------------+\nclear\ndate\nhostname\nls -la /home/root/.ssh/authorized_keys\n\n\n## --> OPCION 2 y ## --> OPCION 3\n+-------------------------------------------------------------------------------------+\n## Para ficheros authorized_keys, de tipo /F/S/, sin owner o account externas/internas tipo /E/, /I/ /K/\n+-------------------------------------------------------------------------------------+\nclear\ndate\nhostname\nls -la $file_authorized\ncat $file_authorized",
        "SO": "Linux / Aix"
    },
    {
        "modulo": "AV.1.1.7 Password Requirements",
        "clave": "",
        "descripcion": "## (MODULO RELACIONADO : AV.1.1.6 Password Requirements)\n\n## SSH authorized_keys file: \"FICHERO AUTHORIZED KEYS\"; Invalid from section: . \"*º\" or \"*.*.*.*\" or \"0/0\" or \"0.0.0.0/0\" or empty are forbidden values in the \"from=\" parameter",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## En este tipo de desviaciones, las claves publicas (\"authorized_keys\")\n## Deben tener un FROM que especifique el host remoto o direccion IP.\n\n## Antes de seguir, revisar ('AUTHORIZED')\n+-------------------------------------------------------------------------------------+\n## Revisamos si tiene un FROM, que especifica el host remoto o IP\n## Debe ser solo accesible al owner\n+-------------------------------------------------------------------------------------+\n\nls -la $file_authorized\ncat $file_authorized\n\n## PUEDEN EXISTIR 3 OPCIONES DIFERENTES:\n\n## --> OPCION 1\n+-------------------------------------------------------------------------------------+\n## Si el fichero authorized_keys pertenece a la cuenta root, Root no debe tener un fichero authorized_keys.\n## Pasamos directamente a renombrar el fichero authorized_keys para el owner root.\n\n## ('SI HAY DUDAS, consultarlo con el tecnico')\n+-------------------------------------------------------------------------------------+\n\n## --> OPCION 2\n+-------------------------------------------------------------------------------------+\n## Si el fichero authorized_keys es de TIPO /F/ o /S/ (sistemas / aplicativo)\n## Se debe notificar al owner o grupo del fichero.\n\n## - Si se va a excepcionar nos deben especificar un RISK e IMPACT.\n\n## - Si se va a corregir (nos deben facilitar la IP o HOST).\n+-------------------------------------------------------------------------------------+\n## Si es de TIPO /C/ (customer)\n\n## - Se debe excepcionar.\n\n## Revisar RISK e IMPACT.\n+-------------------------------------------------------------------------------------+\n\n## --> OPCION 3\n+-------------------------------------------------------------------------------------+\n## Si el fichero authorized_keys, es de tipo /E/. /I/./K/\n\n## - Si es una cuenta 'externa' y no existe en el servidor, se puede renombrar el fichero authorized_key.\n\n## - Si la cuenta existe, se debe notificar al owner de la cuenta.\n+-------------------------------------------------------------------------------------+",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n## LINUX\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p $file_authorized /home/${user^^}/authorized_key_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p $file_authorized /home/${user,,}/authorized_key_`date +%d%m%y_%T`\n\n## AIX\n+-------------------------------------------------------------------------------------+\n## Backup\n+-------------------------------------------------------------------------------------+\n\ncp -p \"$file_authorized\" /home/$user/authorized_key_`date +%d%m%y_%T`\n",
        "editar": "## --> OPCION 1\n+-------------------------------------------------------------------------------------+\n## Para ficheros authorized_keys, con owner root.\n+-------------------------------------------------------------------------------------+\n\nmv /home/root/.ssh/authorized_keys /home/root/.ssh/authorized_keys.save\n\n\n## --> OPCION 2 y ## --> OPCION 3\n+-------------------------------------------------------------------------------------+\n## Para ficheros authorized_keys, de tipo /F/S/ o sin owner o account externas/internas de tipo /E/ o /I/.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Donde se tengan que renombar el fichero.\n+-------------------------------------------------------------------------------------+\n\nmv $file_authorized $file_authorized.save\n\n+-------------------------------------------------------------------------------------+\n## Donde se tenga que añadir un FROM.\n+-------------------------------------------------------------------------------------+\n\nvi $file_authorized\n\n+-------------------------------------------------------------------------------------+\n## Añadir la línea from=\"IP\", al inicio de cada clave shh-rsa:\n+-------------------------------------------------------------------------------------+\n## EJEMPLO\n\nfrom=\"129.39.41.5,129.39.41.6\" ssh-rsa AAAAB3NzaC1yc2EAAAABIw== !!CZ/S/*ABJ83/IBM/Automation ID!!\n",
        "refrescar": null,
        "evidencia": "## --> OPCION 1\n+-------------------------------------------------------------------------------------+\n## Para ficheros authorized_keys, con owner root.\n+-------------------------------------------------------------------------------------+\nclear\ndate\nhostname\nls -la /home/root/.ssh/authorized_keys\n\n\n## --> OPCION 2 y ## --> OPCION 3\n+-------------------------------------------------------------------------------------+\n## Para ficheros authorized_keys, de tipo /F/S/, sin owner o account externas/internas tipo /E/, /I/ /K/\n+-------------------------------------------------------------------------------------+\nclear\ndate\nhostname\nls -la $file_authorized\ncat $file_authorized",
        "SO": "Linux / Aix"
    },
    {
        "modulo": "Identify and Authenticate Users/Public Key Authentication",
        "clave": "PUBLICKEY",
        "descripcion": "SSH authorized_keys file: $authorized_keys; Invalid public host key length: 1024   Key type: ssh-rsa.",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## En este tipo de desviaciones, las claves publicas(\"authorized_keys\")\n## Deben tener una clave superior a 1024 bit de longitud.\n## Antes de seguir, revisar -* AUTHORIZED_KEYS *-\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Revisamos si tiene una longitud superior a 1024 bit, debe ser 2048 bit.\n## Debe ser solo accesible al owner\n+-------------------------------------------------------------------------------------+\n\nls -la $file_authorized\ncat $file_authorized\n\n## PUEDEN EXISTIR 3 OPCIONES DIFERENTES:\n\n## --> OPCION 1\n+-------------------------------------------------------------------------------------+\n## Si el fichero authorized_keys es de root, no debe tener un fichero authorized_keys.\n## Pasamos directamente a renombrar el fichero authorized_keys para owner root.\n## ('SI HAY DUDAS, consultarlo con el tecnico')\n+-------------------------------------------------------------------------------------+\n\n## --> OPCION 2\n+-------------------------------------------------------------------------------------+\n## Si el fichero authorized_keys, pertenece a otro owner o grupo que no sea root.\n## Si es de TIPO /F/ o /S/ (sistemas / aplicativo)\n## se debe contactar con el owner o grupo del fichero.\n## - Si se va a excepcionar nos deben especificar un RISK e IMPACT.\n\n## - Si se va a corregir.\n## Revisar ('authorized_keys'), antes de cualquier cambio.\n\n## Si es de TIPO /C/ (customer)\n## - Se debe excepcionar.\n## Por favor revisar la sección de RISK e IMPACT.\n+-------------------------------------------------------------------------------------+\n\n## --> OPCION 3\n+-------------------------------------------------------------------------------------+\n## Si el fichero authorized_keys, pertenece a otro owner o grupo que no sea root.\n## SI es de tipo /E/. /I/./K/\n## - Si es una cuenta 'externa' y no existe en el servidor, se puede renombrar.\n## - Si la cuenta existe, se debe notificar al owner de la cuenta.\n\n## Se le debe notificar que se ha renombrado el fichero y que si lo utiliza debe,\n## Crear un fichero authorized_keys con una clave tipo rsa de 2048 bit. \n## Revisar ('AUTHORIZED_KEYS'), antes de cualquier cambio.\n+-------------------------------------------------------------------------------------+",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n## LINUX\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p $file_authorized /home/${user^^}/authorized_key_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p $file_authorized /home/${user,,}/authorized_key_`date +%d%m%y_%T`\n\n## AIX\n+-------------------------------------------------------------------------------------+\n## Backup\n+-------------------------------------------------------------------------------------+\ncp -p \"$file_authorized\" /home/$user/authorized_key_`date +%d%m%y_%T`",
        "editar": "## --> OPCION 1\n+-------------------------------------------------------------------------------------+\n## Para ficheros authorized_keys, con owner root.\n+-------------------------------------------------------------------------------------+\n\nmv /home/root/.ssh/authorized_keys /home/root/.ssh/authorized_keys.save\n\n\n## --> OPCION 2 y ## --> OPCION 3\n+-------------------------------------------------------------------------------------+\n## Para otros ficheros authorized_keys.\n## De tipo /F/S/ o sin owner o account externas/internas tipo /E/ o /I/\n+-------------------------------------------------------------------------------------+\n\nmv $file_authorized $file_authorized.save",
        "refrescar": null,
        "evidencia": "## --> OPCION 1\n+-------------------------------------------------------------------------------------+\n## Para ficheros authorized_keys, con owner root.\n+-------------------------------------------------------------------------------------+\nclear\ndate\nhostname\nls -la /home/root/.ssh/authorized_keys\n\n\n## --> OPCION 2 y ## --> OPCION 3\n+-------------------------------------------------------------------------------------+\n## Para otros ficheros authorized_keys.\n## De tipo /F/S/ o sin owner o account externas/internas tipo /E/ o /I/\n+-------------------------------------------------------------------------------------+\nclear\ndate\nhostname\nls -la $file_authorized\ncat $file_authorized",
        "SO": "Linux / Aix"
    },
    {
        "modulo": "Password Requirements/Specific Host Access",
        "clave": "",
        "descripcion": "File \"FICHERO AUTHORIZED KEYS\" contains entries withous \"from\" option specified",
        "comprobacion": "## Pregunta relaciona con el modulo : Password Requirements/Private Key File Restriction",
        "copia": null,
        "editar": null,
        "refrescar": null,
        "evidencia": null,
        "SO": "Linux / Aix"
    },
    {
        "modulo": "Protecting Resources-OSRs/OSR /TMP Files Restrictions",
        "clave": "OSRTMP",
        "descripcion": "Invalid permissions for $fileTMP  Octal permissions: 0777  Text Permissions: -rwxrwxrwx-;  May not have execute permissions on any files and no write for others.",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Aplica a ficheros del directorio /TMP\n+-------------------------------------------------------------------------------------+\n\n## El desvio trata de quitarle escritura a OTHER, a ficheros que tienen escritura y ejecucion que cuelgan en el directorio /TMP y sub-directorios.\n\n+-------------------------------------------------------------------------------------+\n## En INFRA Unix, Linux, ficheros que cuelgan en /TMP, se pueden quitar w a other.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Buscar y comprobar los fichero a cambiar permisos.\n+-------------------------------------------------------------------------------------+\n\n## FICHEROS FORMA RECURVISA:\n---\necho \"ficheros con permisos W en OTHER : \";find $fileTMP -type f -perm -o=wx | wc -l\n\n##Listar\n\nfind $fileTMP -type f -perm -o=wx | xargs -l ls -l\n\n## FICHERO INDIVIDUAL\n---\nls -l /tmp/$fichero\n\n+-------------------------------------------------------------------------------------+\n## Pregunta RELACIONADAS\n+-------------------------------------------------------------------------------------+\n\nProtecting Resources-mixed/Ensure sticky bit is set on all world-writable directories",
        "copia": null,
        "editar": "+-------------------------------------------------------------------------------------+\n## Se puede quitar de forma 'RECURSIVA' o por 'INDIVIDUAL'\n\n## VARIABLES:\n## $fileTMP : es la variable del directorio, base para cambiar permisos.\n## $fichero : es la variable, del fichero a cambiar permiso.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Asi quitamos de permisos de W a Other, en los ficheros('RECURSIVO'):\n+-------------------------------------------------------------------------------------+\n\nfind $fileTMP -type f -perm -o=wx -exec chmod o-w {} \\;\n\n+-------------------------------------------------------------------------------------+\n## Asi quitamos permisos, de W a other de forma('INDIVIDUAL'):\n+-------------------------------------------------------------------------------------+\n\nchmod o-w $fichero",        
        "refrescar": null,
        "evidencia": "+-------------------------------------------------------------------------------------+\n## De forma ('RECURSIVA'):\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nfind $fileTMP -type f -perm -o=wx | wc -l\nls -ld $fileTMP\n\n+-------------------------------------------------------------------------------------+\n## De forma('INDIVIDUAL'):\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -l $fichero",
        "SO": "Linux"
    },
    {
        "modulo": "Encryption/Permitted Ciphers",
        "clave": "CIPHERS",
        "descripcion": "Cipher aes128-ctr is not available\nCipher aes192-ctr is not available\nCipher aes256-ctr is not available",
        "comprobacion": "## Antes de corregir se debe comprobar que no estén los valores correctos por defecto\n\n+-------------------------------------------------------------------------------------+\n## Valor por defecto correcto es : \n## ciphers aes128-ctr,aes192-ctr,aes256-ctr,chacha20-poly1305@openssh.com,aes128-gcm@openssh.com,aes256-gcm@openssh.com\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Muestra el valor por defecto\n+-------------------------------------------------------------------------------------+\n\n/usr/sbin/sshd -T|grep -i ciphers\n\n+-------------------------------------------------------------------------------------+\n## Valor definido en el servidor, no debe estar comentado(#), o no debe estar vació\n+-------------------------------------------------------------------------------------+\n\ncat /etc/ssh/sshd_config | grep -i ciphers\n\n+-------------------------------------------------------------------------------------+\n-- Si es un RHEL 8\n## Se debe comprobar que este descomentado la linea : CRYPTO_POLICY\n+-------------------------------------------------------------------------------------+\n\ncat /etc/sysconfig/sshd | grep CRYPTO_POLICY\n",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n## LINUX\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/${user^^}/sshd_config_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n--- RHEL 8, con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/sysconfig/sshd /home/${user^^}/sshd._`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/${user,,}/sshd_config_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n--- RHEL 8, con HOME en minúscula\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/sysconfig/sshd /home/${user,,}/sshd._`date +%d%m%y_%T`\n\n\n## AIX\n+-------------------------------------------------------------------------------------+\n## Backup\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/$user/sshd_config_`date +%d%m%y_%T`\n",
        "editar": "+-------------------------------------------------------------------------------------+\n## Añadir mínimo estos 3 cifrados POR DELANTE, `Ciphers aes128-ctr,aes192-ctr,aes256-ctr`\n## Si existen otros cifrados dejarlos, debe estar debajo de: \n## Ciphers and keying\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Debe quedar algo asi:\n\nCiphers aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com,chacha20-poly1305@openssh.com\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Editar\n+-------------------------------------------------------------------------------------+\n\nvi /etc/ssh/sshd_config\n\n+-------------------------------------------------------------------------------------+\n## Para RHEL 8, Editar Y Descomentar CRYPTO_POLICY=\n+-------------------------------------------------------------------------------------+\n\nvi /etc/sysconfig/sshd\n",
        "refrescar": "+-------------------------------------------------------------------------------------+\n## LINUX\n+-------------------------------------------------------------------------------------+\n\nsystemctl stop sshd\nsystemctl start sshd\n\n+-------------------------------------------------------------------------------------+\n## AIX\n+-------------------------------------------------------------------------------------+\n\nstopsrc -s sshd;sleep 2;startsrc -s sshd\n",
        "evidencia": "+-------------------------------------------------------------------------------------+\n## LINUX / AIX\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\n/usr/sbin/sshd -T|grep -i ciphers\ncat /etc/ssh/sshd_config | grep -i ciphers\n\n+-------------------------------------------------------------------------------------+\n--- RHEL 8\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\n/usr/sbin/sshd -T|grep -i ciphers\ncat /etc/ssh/sshd_config | grep -i ciphers\ncat /etc/sysconfig/sshd | grep CRYPTO_POLICY\nsystemctl status sshd\n",
        "SO": "Linux / Aix"
    },
    {
        "modulo": "Encryption/MACs MACs",
        "clave": "MACS",
        "descripcion": "\nhmac-sha2-512-etm@openssh.com is not available\nhmac-sha2-256-etm@openssh.com is not available\nhmac-sha2-512 is not available\nhmac-sha2-256 is not available",
        "comprobacion": "## Antes de corregir se debe comprobar que no estén los valores correctos por defecto\n\n+-------------------------------------------------------------------------------------+\n## Valor por defecto correcto es : \n## macs umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Muestra el valor por defecto\n+-------------------------------------------------------------------------------------+\n\n/usr/sbin/sshd -T|grep -i mac\n\n+-------------------------------------------------------------------------------------+\n## Valor definido en el servidor, no debe estar comentado(#), o no debe estar vació\n+-------------------------------------------------------------------------------------+\n\ncat /etc/ssh/sshd_config | grep -i mac",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n## LINUX\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/${user^^}/sshd_config_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/${user,,}/sshd_config_`date +%d%m%y_%T`\n\n\n## AIX\n+-------------------------------------------------------------------------------------+\n## Backup\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/$user/sshd_config_`date +%d%m%y_%T`",
        "editar": "+-------------------------------------------------------------------------------------+\n## Añadir estos Macs `hmac-sha2-512-etm@openssh.com`,`hmac-sha2-256-etm@openssh.com`,`hmac-sha2-512`,`hmac-sha2-256`\n## Si existen otros Macs dejarlos, debe estar debajo de los ciphers: \n## MAC`s\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Debe quedar algo asi:\n\nMACs hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512,hmac-sha2-256\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Editar\n+-------------------------------------------------------------------------------------+\n\nvi /etc/ssh/sshd_config",
        "refrescar": "+-------------------------------------------------------------------------------------+\n## LINUX\n+-------------------------------------------------------------------------------------+\n\nsystemctl stop sshd\nsystemctl start sshd\n\n+-------------------------------------------------------------------------------------+\n## AIX\n+-------------------------------------------------------------------------------------+\n\nstopsrc -s sshd;sleep 2;startsrc -s sshd",
        "evidencia": "+-------------------------------------------------------------------------------------+\n## LINUX / AIX\n+-------------------------------------------------------------------------------------+\nclear\ndate\nhostname\n/usr/sbin/sshd -T|grep -i Macs\ncat /etc/ssh/sshd_config | grep -i Mac",
        "SO": "Linux / Aix"
    },
    {
        "modulo": "AV.2.1.1.3 Encryption",
        "clave": "",
        "descripcion": "\nhmac-sha2-512-etm@openssh.com is not available\nhmac-sha2-256-etm@openssh.com is not available\nhmac-sha2-512 is not available\nhmac-sha2-256 is not available",
        "comprobacion": "## Antes de corregir se debe comprobar que no estén los valores correctos por defecto\n\n+-------------------------------------------------------------------------------------+\n## Valor por defecto correcto es : \n## macs umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Muestra el valor por defecto\n+-------------------------------------------------------------------------------------+\n\n/usr/sbin/sshd -T|grep -i mac\n\n+-------------------------------------------------------------------------------------+\n## Valor definido en el servidor, no debe estar comentado(#), o no debe estar vació\n+-------------------------------------------------------------------------------------+\n\ncat /etc/ssh/sshd_config | grep -i mac",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n## LINUX\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/${user^^}/sshd_config_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/${user,,}/sshd_config_`date +%d%m%y_%T`\n\n\n## AIX\n+-------------------------------------------------------------------------------------+\n## Backup\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/$user/sshd_config_`date +%d%m%y_%T`",
        "editar": "+-------------------------------------------------------------------------------------+\n## Añadir estos Macs `hmac-sha2-512-etm@openssh.com`,`hmac-sha2-256-etm@openssh.com`,`hmac-sha2-512`,`hmac-sha2-256`\n## Si existen otros Macs dejarlos, debe estar debajo de los ciphers: \n## MAC`s\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Debe quedar algo asi:\n\nMACs hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512,hmac-sha2-256\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Editar\n+-------------------------------------------------------------------------------------+\n\nvi /etc/ssh/sshd_config",
        "refrescar": "+-------------------------------------------------------------------------------------+\n## LINUX\n+-------------------------------------------------------------------------------------+\n\nsystemctl stop sshd\nsystemctl start sshd\n\n+-------------------------------------------------------------------------------------+\n## AIX\n+-------------------------------------------------------------------------------------+\n\nstopsrc -s sshd;sleep 2;startsrc -s sshd",
        "evidencia": "+-------------------------------------------------------------------------------------+\n## LINUX / AIX\n+-------------------------------------------------------------------------------------+\nclear\ndate\nhostname\n/usr/sbin/sshd -T|grep -i Macs\ncat /etc/ssh/sshd_config | grep -i Mac",
        "SO": "Linux / Aix"
    },
    {
        "modulo": "AV.2.1.1.2 Encryption",
        "clave": "",
        "descripcion": "Cipher aes128-ctr is not available\nCipher aes192-ctr is not available\nCipher aes256-ctr is not available",
        "comprobacion": "## Antes de corregir se debe comprobar que no estén los valores correctos por defecto\n\n+-------------------------------------------------------------------------------------+\n## Valor por defecto correcto es : \n## ciphers aes128-ctr,aes192-ctr,aes256-ctr,chacha20-poly1305@openssh.com,aes128-gcm@openssh.com,aes256-gcm@openssh.com\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Muestra el valor por defecto\n+-------------------------------------------------------------------------------------+\n\n/usr/sbin/sshd -T|grep -i ciphers\n\n+-------------------------------------------------------------------------------------+\n## Valor definido en el servidor, no debe estar comentado(#), o no debe estar vació\n+-------------------------------------------------------------------------------------+\n\ncat /etc/ssh/sshd_config | grep -i ciphers",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n## LINUX\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/${user^^}/sshd_config_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/${user,,}/sshd_config_`date +%d%m%y_%T`\n\n\n## AIX\n+-------------------------------------------------------------------------------------+\n## Backup\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/$user/sshd_config_`date +%d%m%y_%T`\n",
        "editar": "+-------------------------------------------------------------------------------------+\n## Añadir mínimo estos 3 cifrados POR DELANTE, `Ciphers aes128-ctr,aes192-ctr,aes256-ctr`\n## Si existen otros cifrados dejarlos, debe estar debajo de: \n## Ciphers and keying\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Debe quedar algo asi:\n\nCiphers aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com,chacha20-poly1305@openssh.com\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Editar\n+-------------------------------------------------------------------------------------+\n\nvi /etc/ssh/sshd_config",
        "refrescar": "+-------------------------------------------------------------------------------------+\n## LINUX\n+-------------------------------------------------------------------------------------+\n\nsystemctl stop sshd\nsystemctl start sshd\n\n+-------------------------------------------------------------------------------------+\n## AIX\n+-------------------------------------------------------------------------------------+\n\nstopsrc -s sshd;sleep 2;startsrc -s sshd",
        "evidencia": "+-------------------------------------------------------------------------------------+\n## LINUX / AIX\n+-------------------------------------------------------------------------------------+\nclear\ndate\nhostname\n/usr/sbin/sshd -T|grep -i ciphers\ncat /etc/ssh/sshd_config | grep -i ciphers",
        "SO": "Linux / Aix"
    },
    {
        "modulo": "Encryption/Deny Ciphers",
        "clave": "DENY",
        "descripcion": "Cipher cast128-cbc should not be used\nCipher 3des-cbc should not be used",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Para corregir estos desvios\n## Se debe quitar los ciphers `cast128`, `3des`\n\n## Por lo normal estas definidos por defecto, relacionado con el modulo:\n+-------------------------------------------------------------------------------------+\n\nEncryption/Permitted Ciphers\n\n+-------------------------------------------------------------------------------------+\n## Muestra el valor por defecto\n+-------------------------------------------------------------------------------------+\n\n/usr/sbin/sshd -T|grep -i ciphers\n\n+-------------------------------------------------------------------------------------+\n## Valor definido en el servidor, no debe estar comentado(#), o no debe estar vació\n+-------------------------------------------------------------------------------------+\n\ncat /etc/ssh/sshd_config | grep -i ciphers",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n## LINUX\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/${user^^}/sshd_config_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/${user,,}/sshd_config_`date +%d%m%y_%T`\n\n\n## AIX\n+-------------------------------------------------------------------------------------+\n## Backup\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/$user/sshd_config_`date +%d%m%y_%T`",
        "editar": "+-------------------------------------------------------------------------------------+\n## Añadir mínimo estos 3 cifrados POR DELANTE, `Ciphers aes128-ctr,aes192-ctr,aes256-ctr`\n## Si existen otros cifrados dejarlos, debe estar debajo de: \n## Ciphers and keying\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Debe quedar algo asi:\n\nCiphers aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com,chacha20-poly1305@openssh.com\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Editar\n+-------------------------------------------------------------------------------------+\n\nvi /etc/ssh/sshd_config",
        "refrescar": "+-------------------------------------------------------------------------------------+\n## LINUX\n+-------------------------------------------------------------------------------------+\n\nsystemctl stop sshd\nsystemctl start sshd\n\n+-------------------------------------------------------------------------------------+\n## AIX\n+-------------------------------------------------------------------------------------+\n\nstopsrc -s sshd;sleep 2;startsrc -s sshd",
        "evidencia": "+-------------------------------------------------------------------------------------+\n## LINUX / AIX\n+-------------------------------------------------------------------------------------+\nclear\ndate\nhostname\n/usr/sbin/sshd -T|grep -i ciphers\ncat /etc/ssh/sshd_config | grep -i ciphers\nsystemctl status sshd",
        "SO": "Linux / Aix"
    },
    {
        "modulo": "E.C.1.1.2 Permissions and Ownership",
        "clave": "PATH",
        "descripcion": "The following directories, which are as executable in the root PATH, have write permissions for GROUP, cannot set stickibit for these directories:: directory: /var/ifor, owner/group: bin bin, permission must r-x for group/other, assigned permission is: drwxrwxrwt",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## La escritura de grupo y a other no están permitidos en los directorios del ejecutable $PATH del usuario root.\n## Para todos los directorios, incluidos los directorios padre, listados en $PATH para root\n## Deben cumplir los siguientes controles: \n\n## OTHER y GROUP no debe escribir,  Excepción, /usr/ubc puede tener escritura de grupo.\n## Puede ser propiedad de root o bin.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Comprobar los permisos y owner, group.\n+-------------------------------------------------------------------------------------+\n\nls -ld /var/ifor",
        "copia": null,
        "editar": "+-------------------------------------------------------------------------------------+\n## Se debe quitar permisos de escritura a grupo y other\n## No debe tener permisos de sticki bit.\n+-------------------------------------------------------------------------------------+\nchmod o-w,g-w /var/ifor\nchmod -t /var/ifor",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\nls -ld /var/ifor",
        "SO": "Aix"
    },
    {
        "modulo": "Password Requirements/NULL Passphrase",
        "clave": "ID_RSA",
        "descripcion": "Private key $file_idrsa is not encrypted",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## En este tipo de desviaciones, las claves privadas(\"id_rsa\")\n## Deben tener una frase de paso (passphrase) : \"Proc-Type: 4,ENCRYPTED\"\n\n## Puede no tener un passphrase, siempre que la clave_publica(authorized_keys), tenga un FROM.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Guardamos en la variable, el fichero id_rsa a revisar\n## Antes de seguir, revisar -* ID_RSA *-\n+-------------------------------------------------------------------------------------+\n\nfile_idrsa=\"\"\n\n+-------------------------------------------------------------------------------------+\n## Revisamos si tiene una FRASE DE PASO\n## Debe ser solo accesible al owner\n+-------------------------------------------------------------------------------------+\n\nls -la $file_idrsa\ncat $file_idrsa\n\n## PUEDEN EXISTIR 3 OPCIONES DIFERENTES:\n\n## --> OPCION 1\n+-------------------------------------------------------------------------------------+\n## Si el fichero id_rsa es de root, no debe tener un fichero id_rsa.\n## Pasamos directamente a renombrar el fichero id_rsa para owner root.\n## ('SI HAY DUDAS, consultarlo con el tecnico')\n+-------------------------------------------------------------------------------------+\n\n## --> OPCION 2\n+-------------------------------------------------------------------------------------+\n## Si el fichero id_rsa, pertenece a otro owner o grupo que no sea root.\n## Si es de TIPO /F/S (sistemas / aplicativo)\n## se debe contactar con el owner o grupo del fichero.\n## - Si se va a excepcionar nos deben especificar un RISK e IMPACT.\n\n## - Si se va a corregir.\n## Revisar ('ID_RSA'), antes de cualquier cambio.\n\n## Si es de TIPO /C/ (customer)\n## - Se debe excepcionar.\n## Por favor revisar la sección de RISK e IMPACT.\n+-------------------------------------------------------------------------------------+\n\n## --> OPCION 3\n+-------------------------------------------------------------------------------------+\n## Si el fichero id_rsa, pertenece a otro owner o grupo que no sea root.\n## Si es de tipo /E/. /I/\n## - Si es una cuenta 'externa' y no existe en el servidor, se puede renombrar.\n## - Si la cuenta existe, se debe notificar al owner de la cuenta.\n\n## Se le debe notificar que se ha renombrado el fichero y que si lo utiliza debe,\n## Crear un fichero id_rsa con una frase de paso (passphrase).  \n## Revisar ('ID_RSA'), antes de cualquier cambio.\n+-------------------------------------------------------------------------------------+",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n## LINUX\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p $file_idrsa /home/${user^^}/id_rsa_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p $file_idrsa /home/${user,,}/id_rsa_`date +%d%m%y_%T`\n\n##AIX\n+-------------------------------------------------------------------------------------+\n## Backup\n+-------------------------------------------------------------------------------------+\ncp -p \"$file_idrsa\" /home/$user/id_rsa_`date +%d%m%y_%T`",
        "editar": "## --> OPCION 1\n+-------------------------------------------------------------------------------------+\n## Para ficheros id_rsas, con owner root\n+-------------------------------------------------------------------------------------+\n\nmv /home/root/.ssh/id_rsa /home/root/.ssh/id_rsa.save\n\n\n## --> OPCION 2\n+-------------------------------------------------------------------------------------+\n## Para otros ficheros id_rsas.\n## De tipo /F/S/.\n## Para implementar una FRASE DE PASO, se debe eliminar el fichero y crear uno nuevo si no recuerda si puso una passphrase\n\n## Al crear con la opcion -P (ssh-keygen -t rsa -P \"frase_depaso\")\n\n## Si no se indica la opcion, al crear la clave privada lo pregunta : (Enter passphrase (empty for no passphrase):).\n+-------------------------------------------------------------------------------------+\n\nrm $file_idrsa\n\n+-------------------------------------------------------------------------------------+\n## Si recuerda la frase de paso (passphrase), o es vacia, se puede crear o modificar con la siguientes opciones\n+-------------------------------------------------------------------------------------+\n\nssh-keygen -o -p -f keyfile\n\n## --> OPCION 3\n+-------------------------------------------------------------------------------------+\n## Para otros ficheros id_rsas, sin owner o account externas.\n## De tipo /E/I/\n\n## Si no existe la cuenta se puede renombrar\n\n## Si existe la cuenta, se le debe indicar que debe crear una nueva clave privada o modifcar e implementar un frase de paso (passphrase)(\"OPCION 2\")\n+-------------------------------------------------------------------------------------+\n\nmv $file_idrsa $file_idrsa.save",
        "refrescar": null,
        "evidencia": "## --> OPCION 1\n+-------------------------------------------------------------------------------------+\n## Para ficheros id_rsas, con owner root.\n+-------------------------------------------------------------------------------------+\nclear\ndate\nhostname\nls -la /home/root/.ssh/id_rsas\nls -la /home/root/.ssh/id_rsas.save\n\n\n## --> OPCION 2\n+-------------------------------------------------------------------------------------+\n## Para otros ficheros id_rsas.\n## De tipo /F/S/.\n+-------------------------------------------------------------------------------------+\nclear\ndate\nuname -a\ncat $file_idrsa | grep -i 'ENCRYPTED' \n\n\n## --> OPCION 3\n+-------------------------------------------------------------------------------------+\n## Para otros ficheros id_rsas, sin owner o account externas.\n## De tipo /E/I/.\n+-------------------------------------------------------------------------------------+\nclear\ndate\nuname -a\nls -la $file_idrsa\nls -la $file_idrsa.save",
        "SO": "Linux / Aix"
    },
    {
        "modulo": "Password Requirements/Acceptance of the null password with nullok parameter",
        "clave": "PAM NULLOK",
        "descripcion": "PAM service: '/etc/pam.d/password-auth', '/etc/pam.d/system-auth'   use pam_unix.so auth module with \"nullok\" parameter. This parameter is forbidden as it allows acceptance of the null password.",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Hace referencia al parametro 'nullok' en RHEL 7 y RHEL 8.\n+-------------------------------------------------------------------------------------+\n\n## Saber que versión de RHEL es:\ncat /etc/*release\n\n+-------------------------------------------------------------------------------------+\n##--- RHEL 7 & RHEL 8 ('system-auth','password-auth')\n## Los ficheros del PAM, NO deben tener en el parametro 'nullok', en los diferentes modulos\n+-------------------------------------------------------------------------------------+\n\ncat /etc/pam.d/system-auth | grep \"nullok\"\ncat /etc/pam.d/password-auth | grep \"nullok\"",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/pam.d/system-auth /home/${user^^}/system-auth_`date +%d%m%y_%T`\n\ncp -p /etc/pam.d/password-auth /home/${user^^}/password-auth_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/pam.d/system-auth /home/${user,,}/system-auth_`date +%d%m%y_%T`\n\ncp -p /etc/pam.d/password-auth /home/${user,,}/password-auth_`date +%d%m%y_%T`",
        "editar": "+-------------------------------------------------------------------------------------+\n##--- RHEL 7 & RHEL 8 ('system-auth','password-auth')\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Eliminar el parametro 'nullok', en los diferentes modulos del pam.d.\n+-------------------------------------------------------------------------------------+\n\nvi /etc/pam.d/system-auth\n\n+-------------------------------------------------------------------------------------+\n## Lo mismo con 'password-auth'\n+-------------------------------------------------------------------------------------+\n\nvi /etc/pam.d/password-auth\n",
        "refrescar": null,
        "evidencia": "clear\ndate;hostname\ncat /etc/*release | grep -i release\ncat /etc/pam.d/system-auth | grep \"nullok\"\ncat /etc/pam.d/password-auth | grep \"nullok\"\n",
        "SO": "Linux"
    },
    {
        "modulo": "Logging/Login Success or Failure in rsyslog.conf",
        "clave": "RSYSLOG",
        "descripcion": "Setting *.info or *.debug missing or invalid for /var/log/messages\n\nSetting authpriv.* missing or invalid for /var/log/secure\n",
        "comprobacion": null,
        "copia": null,
        "editar": null,
        "refrescar": null,
        "evidencia": null,
        "SO": "Linux"
    },
    {
        "modulo": "Logging/Ntpd has secure defaults",
        "clave": "NTPD",
        "descripcion": "Key defaults for both ip4 and ip6 must be set to: nomodify notrap nopeer noquery. Configuration file /etc/ntp.conf",
        "comprobacion": null,
        "copia": "##Obtener usuario logueado:\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n##Backup con usuario en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ntp.conf /home/${user^^}/ntp_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n##Backup con usuario en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ntp.conf /home/${user,,}/ntp_`date +%d%m%y_%T`\n",
        "editar": "+-------------------------------------------------------------------------------------+\n##Añadir / Remplazar\n+-------------------------------------------------------------------------------------+\n\nvi /etc/ntp.conf\n\n+-------------------------------------------------------------------------------------+\n##Por debajo de\n+-------------------------------------------------------------------------------------+\n\n# En permit the source to query or modify the service on this system.\n\nrestrict default kod nomodify notrap nopeer noquery\nrestrict -6 default kod nomodify notrap nopeer noquery\n\n+-------------------------------------------------------------------------------------+\n##Y por debajo de\n+-------------------------------------------------------------------------------------+\n\n# the administrative functions.\n\nrestrict 127.0.0.1\nrestrict -6 ::1",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\ncat /etc/ntp.conf | grep -i restrict",
        "SO": "Linux"
    },
    {
        "modulo": "Password Requirements/Password MIN Length and complexity",
        "clave": "PAM MINLEN",
        "descripcion": "Incorrect System Default minimum password length or password complexity rules. Minimum password length should be set to 8 or more secure, in file \n/etc/pam.d/password-auth\n/etc/pam.d/system-auth.\nIt should be set through pam_cracklib.so or pam_pwquality.so. For more information about password length or password complexity rules see matrix coverage document.",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Hace referencia al 'minlen' en RHEL 7 y RHEL 8.\n+-------------------------------------------------------------------------------------+\n\n## Saber que versión de RHEL es:\ncat /etc/*release\n\n#-***# Saber que PAM_TALLY USA (RHEL 7)#****-#\nls -ltr /lib64/security/pam_tally*\n\n#-*** Saber que PAM_FAILLOCK USA (RHEL 8)****-#\nls -la /usr/sbin/faillock\n\n+-------------------------------------------------------------------------------------+\n##--- RHEL 7 & RHEL 8 ('system-auth','password-auth')\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Los ficheros del PAM para RHEL 7, deben tener en el modulo 'password    required      pam_cracklib.so', el parámetro 'minlen=15'\n+-------------------------------------------------------------------------------------+\n\ncat /etc/pam.d/system-auth | grep minlen\ncat /etc/pam.d/password-auth | grep minlen\n\n+-------------------------------------------------------------------------------------+\n## Los ficheros del PAM para RHEL 8, deben tener en el modulo 'password    required      pam_pwquality.so', el parámetro 'minlen=15'\n+-------------------------------------------------------------------------------------+\n\ncat /etc/pam.d/system-auth | grep minlen\ncat /etc/pam.d/password-auth | grep minlen",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/pam.d/system-auth /home/${user^^}/system-auth_`date +%d%m%y_%T`\n\ncp -p /etc/pam.d/password-auth /home/${user^^}/password-auth_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/pam.d/system-auth /home/${user,,}/system-auth_`date +%d%m%y_%T`\n\ncp -p /etc/pam.d/password-auth /home/${user,,}/password-auth_`date +%d%m%y_%T`",
        "editar": "+-------------------------------------------------------------------------------------+\n##--- RHEL 7 & RHEL 8 ('system-auth','password-auth')\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Añadir en el modulo 'password    required      pam_cracklib.so', el parámetro 'minlen=15'.\n## ('se aconseja remplazar toda la linea, del modulo 'password    required      pam_cracklib.so', por encima de un modulo ' password    sufficient pam_unix.so').\n+-------------------------------------------------------------------------------------+\n\nvi /etc/pam.d/system-auth\n\n+-------------------------------------------------------------------------------------+\n--- RHEL 7\n+-------------------------------------------------------------------------------------+\n\npassword    required      pam_cracklib.so try_first_pass retry=3 minlen=15 dcredit=-1 ucredit=0 lcredit=-1 ocredit=0 reject_username\n\n+-------------------------------------------------------------------------------------+\n--- RHEL 8\n+-------------------------------------------------------------------------------------+\n\npassword    required      pam_pwquality.so try_first_pass retry=3 minlen=15 dcredit=-1 ucredit=0 lcredit=-1 ocredit=0 reject_username enforce_for_root\n\n+-------------------------------------------------------------------------------------+\n## Lo mismo con 'password-auth'\n+-------------------------------------------------------------------------------------+\n\nvi /etc/pam.d/password-auth",
        "refrescar": null,
        "evidencia": "clear\ndate;hostname\ncat /etc/*release | grep -i release\ncat /etc/pam.d/system-auth | egrep \"minlen\" \ncat /etc/pam.d/password-auth | egrep \"minlen\"",
        "SO": "Linux"
    },
    {
        "modulo": "Protecting Resources-OSRs/OSR /etc/crontab Restrictions",
        "clave": "OSRCRONTAB",
        "descripcion": "/etc/crontab  Owner: root  Group: root  Permissions: -rw-r--r--.  should have \"rw- --- ---\" permissions (or more restrictive). Must be owned by user and group \"root\"",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Se cambian los permisos a : 600\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Pregunta relacionadas :\n+-------------------------------------------------------------------------------------+\n\nProtecting Resources-OSRs/OSR /etc/crontab Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.hourly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.daily Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.weekly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.monthly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.d Restrictions\n",
        "copia": null,
        "editar": "chmod 600 /etc/crontab\n\n+-------------------------------------------------------------------------------------+\n## Editar todas la relaciones\n+-------------------------------------------------------------------------------------+\n\nchmod 600 /etc/crontab\nchmod 600 /etc/cron.hourly \nchmod 600 /etc/cron.daily \nchmod 600 /etc/cron.weekly \nchmod 600 /etc/cron.monthly \nchmod 600 /etc/cron.d",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\nls -ld /etc/crontab\n\n+-------------------------------------------------------------------------------------+\n## Evidencia de todas las relaciones\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -ld /etc/crontab\nls -ld /etc/cron.hourly \nls -ld /etc/cron.daily \nls -ld /etc/cron.weekly \nls -ld /etc/cron.monthly \nls -ld /etc/cron.d",
        "SO": "Linux"
    },
    {
        "modulo": "Protecting Resources-OSRs/OSR /etc/cron.hourly Restrictions",
        "clave": "OSRHOURLY",
        "descripcion": "/etc/cron.hourly  Owner: root  Group: root  Permissions: drwxr-xr-x.  should have \"rwx --- ---\" permissions (or more restrictive). Must be owned by user and group \"root\"",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Se cambian los permisos a : 600\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Pregunta relacionadas :\n+-------------------------------------------------------------------------------------+\n\nProtecting Resources-OSRs/OSR /etc/crontab Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.hourly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.daily Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.weekly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.monthly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.d Restrictions\n",
        "copia": null,
        "editar": "chmod 600 /etc/cron.hourly\n\n+-------------------------------------------------------------------------------------+\n## Editar todas la relaciones\n+-------------------------------------------------------------------------------------+\n\nchmod 600 /etc/crontab\nchmod 600 /etc/cron.hourly \nchmod 600 /etc/cron.daily \nchmod 600 /etc/cron.weekly \nchmod 600 /etc/cron.monthly \nchmod 600 /etc/cron.d",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\nls -ld /etc/cron.hourly\n\n+-------------------------------------------------------------------------------------+\n## Evidencia de todas las relaciones\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -ld /etc/crontab\nls -ld /etc/cron.hourly \nls -ld /etc/cron.daily \nls -ld /etc/cron.weekly \nls -ld /etc/cron.monthly \nls -ld /etc/cron.d",
        "SO": "Linux"
    },
    {
        "modulo": "Protecting Resources-OSRs/OSR /etc/cron.daily Restrictions",
        "clave": "OSRDAILY",
        "descripcion": "/etc/cron.daily  Owner: root  Group: root  Permissions: drwxr-xr-x.  should have \"rwx --- ---\" permissions (or more restrictive). Must be owned by user and group \"root\"",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Se cambian los permisos a : 600\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Pregunta relacionadas :\n+-------------------------------------------------------------------------------------+\n\nProtecting Resources-OSRs/OSR /etc/crontab Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.hourly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.daily Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.weekly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.monthly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.d Restrictions\n",
        "copia": null,
        "editar": "chmod 600 /etc/cron.daily\n\n+-------------------------------------------------------------------------------------+\n## Editar todas la relaciones\n+-------------------------------------------------------------------------------------+\n\nchmod 600 /etc/crontab\nchmod 600 /etc/cron.hourly \nchmod 600 /etc/cron.daily \nchmod 600 /etc/cron.weekly \nchmod 600 /etc/cron.monthly \nchmod 600 /etc/cron.d",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\nls -ld /etc/cron.daily\n\n+-------------------------------------------------------------------------------------+\n## Evidencia de todas las relaciones\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -ld /etc/crontab\nls -ld /etc/cron.hourly \nls -ld /etc/cron.daily \nls -ld /etc/cron.weekly \nls -ld /etc/cron.monthly \nls -ld /etc/cron.d",
        "SO": "Linux"
    },
    {
        "modulo": "Protecting Resources-OSRs/OSR /etc/cron.weekly Restrictions",
        "clave": "OSRWEEKLY",
        "descripcion": "/etc/cron.weekly  Owner: root  Group: root  Permissions: drwxr-xr-x.  should have \"rwx --- ---\" permissions (or more restrictive). Must be owned by user and group \"root\"",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Se cambian los permisos a : 600\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Pregunta relacionadas :\n+-------------------------------------------------------------------------------------+\n\nProtecting Resources-OSRs/OSR /etc/crontab Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.hourly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.daily Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.weekly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.monthly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.d Restrictions\n",
        "copia": null,
        "editar": "chmod 600 /etc/cron.weekly\n\n+-------------------------------------------------------------------------------------+\n## Editar todas la relaciones\n+-------------------------------------------------------------------------------------+\n\nchmod 600 /etc/crontab\nchmod 600 /etc/cron.hourly \nchmod 600 /etc/cron.daily \nchmod 600 /etc/cron.weekly \nchmod 600 /etc/cron.monthly \nchmod 600 /etc/cron.d",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\nls -ld /etc/cron.weekly\n\n+-------------------------------------------------------------------------------------+\n## Evidencia de todas las relaciones\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -ld /etc/crontab\nls -ld /etc/cron.hourly \nls -ld /etc/cron.daily \nls -ld /etc/cron.weekly \nls -ld /etc/cron.monthly \nls -ld /etc/cron.d",
        "SO": "Linux"
    },
    {
        "modulo": "Protecting Resources-OSRs/OSR /etc/cron.monthly Restrictions",
        "clave": "OSRMONTHLY",
        "descripcion": "/etc/cron.monthly  Owner: root  Group: root  Permissions: drwxr-xr-x.  should have \"rwx --- ---\" permissions (or more restrictive). Must be owned by user and group \"root\"",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Se cambian los permisos a : 600\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Pregunta relacionadas :\n+-------------------------------------------------------------------------------------+\n\nProtecting Resources-OSRs/OSR /etc/crontab Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.hourly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.daily Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.weekly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.monthly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.d Restrictions\n",
        "copia": null,
        "editar": "chmod 600 /etc/cron.monthly\n\n+-------------------------------------------------------------------------------------+\n## Editar todas la relaciones\n+-------------------------------------------------------------------------------------+\n\nchmod 600 /etc/crontab\nchmod 600 /etc/cron.hourly \nchmod 600 /etc/cron.daily \nchmod 600 /etc/cron.weekly \nchmod 600 /etc/cron.monthly \nchmod 600 /etc/cron.d",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\nls -ld /etc/cron.monthly\n\n+-------------------------------------------------------------------------------------+\n## Evidencia de todas las relaciones\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -ld /etc/crontab\nls -ld /etc/cron.hourly \nls -ld /etc/cron.daily \nls -ld /etc/cron.weekly \nls -ld /etc/cron.monthly \nls -ld /etc/cron.d",
        "SO": "Linux"
    },
    {
        "modulo": "Protecting Resources-OSRs/OSR /etc/cron.d Restrictions",
        "clave": "OSRCRON.D",
        "descripcion": "/etc/cron.d  Owner: root  Group: root  Permissions: drwxr-xr-x.  should have \"rwx --- ---\" permissions (or more restrictive). Must be owned by user and group \"root\"",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Se cambian los permisos a : 600\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Pregunta relacionadas :\n+-------------------------------------------------------------------------------------+\n\nProtecting Resources-OSRs/OSR /etc/crontab Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.hourly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.daily Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.weekly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.monthly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.d Restrictions\n",
        "copia": null,
        "editar": "chmod 600 /etc/cron.d\n\n+-------------------------------------------------------------------------------------+\n## Editar todas la relaciones\n+-------------------------------------------------------------------------------------+\n\nchmod 600 /etc/crontab\nchmod 600 /etc/cron.hourly \nchmod 600 /etc/cron.daily \nchmod 600 /etc/cron.weekly \nchmod 600 /etc/cron.monthly \nchmod 600 /etc/cron.d",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\nls -ld /etc/cron.d\n\n+-------------------------------------------------------------------------------------+\n## Evidencia de todas las relaciones\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -ld /etc/crontab\nls -ld /etc/cron.hourly \nls -ld /etc/cron.daily \nls -ld /etc/cron.weekly \nls -ld /etc/cron.monthly \nls -ld /etc/cron.d",
        "SO": "Linux"
    },
    {
        "modulo": "Protecting Resources-OSRs/OSR /OPT Files Restrictions",
        "clave": "OSROPT",
        "descripcion": "Invalid permissions for $fileOPT, Octal permissions: 0777, Text Permissions: -rwxrwxrwx;  May not have execute permissions on any files and no write for others.",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Aplica a ficheros del directorio /OPT\n+-------------------------------------------------------------------------------------+\n\n## El desvio trata de quitarle escritura a OTHER, a ficheros que tienen escritura y ejecucion que cuelgan en el directorio /OPT y sub-directorios.\n\n+-------------------------------------------------------------------------------------+\n## Hay que tener en cuenta el tipo de owner que pertenece, cada fichero o directorio BASE.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Ya sea de tipo '/C/F/S/'\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es /C/, se pasa a excepcion con RISK e IMPACT\n(Por favor revisar la seccion de RISK e IMPACT)\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es de tipo /F/S/, se debe preguntar al owner, si podemos modificar los permisos\n## Revisar ('PERMISSIONS'), antes de cualquier cambio.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Buscar y comprobar los fichero a cambiar permisos.\n+-------------------------------------------------------------------------------------+\n\n## FICHEROS FORMA RECURVISA:\n---\necho \"ficheros con permisos w en other : \";find $fileOPT -type f -perm -o=wx | wc -l\nfind $fileOPT -type f -perm -o=wx | xargs -l ls -l\n\n## FICHERO\n---\nls -l $fichero\n\n+-------------------------------------------------------------------------------------+\n## Pregunta RELACIONADAS\n+-------------------------------------------------------------------------------------+\n\nProtecting Resources-mixed/Ensure sticky bit is set on all world-writable directories",
        "copia": null,
        "editar": "+-------------------------------------------------------------------------------------+\n## Se puede quitar de forma 'RECURSIVA' o por 'INDIVIDUAL'\n\n## VARIABLES:\n## $fileOPT : es la variable del directorio base de los ficheros a cambiar permisos.\n## $fichero : es la variable, del fichero a cambiar permiso.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Asi quitamos de permisos de W a Other, en los ficheros('RECURSIVO'):\n+-------------------------------------------------------------------------------------+\n\nfind $fileOPT -type f -perm -o=wx -exec chmod o-w {} \\;\n\n+-------------------------------------------------------------------------------------+\n## Asi quitamos permisos, de W a other de forma('INDIVIDUAL'):\n+-------------------------------------------------------------------------------------+\n\nchmod o-w $fichero",
        "refrescar": null,
        "evidencia": "+-------------------------------------------------------------------------------------+\n## De forma ('RECURSIVA'):\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nfind $fileOPT -type f -perm -o=wx | wc -l\nls -ld $fileOPT\n\n+-------------------------------------------------------------------------------------+\n## De forma('INDIVIDUAL'):\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -l $fichero",
        "SO": "Aix"
    },
    {
        "modulo": "Logging/Log Verbosity Shared ID",
        "clave": "LOGLEVEL",
        "descripcion": "SSH Config File: /etc/ssh/sshd_config; Invalid setting (value: !default!) in parameter 'LogLevel': must be set to VERBOSE or higher.",
        "comprobacion": "## Antes de corregir se debe comprobar que no estén los valores correctos por defecto\n\n+-------------------------------------------------------------------------------------+\n## Valor por defecto correcto es : \nINFO\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Muestra el valor por defecto\n+-------------------------------------------------------------------------------------+\n\n/usr/sbin/sshd -T|grep -i loglevel\n\n+-------------------------------------------------------------------------------------+\n## Valor definido en el servidor, no debe estar comentado(#), o no debe estar vació\n+-------------------------------------------------------------------------------------+\n\ncat /etc/ssh/sshd_config | grep -i loglevel",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n## LINUX\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/${user^^}/sshd_config_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/${user,,}/sshd_config_`date +%d%m%y_%T`\n\n\n## AIX\n+-------------------------------------------------------------------------------------+\n## Backup\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/$user/sshd_config_`date +%d%m%y_%T`",
        "editar": "+-------------------------------------------------------------------------------------+\n## Editar y añadir LogLevel INFO, si esta comentado (#), descomentar \n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Debe quedar algo asi:\n\nLogLevel INFO\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Editar\n+-------------------------------------------------------------------------------------+\n\nvi /etc/ssh/sshd_config",
        "refrescar": "+-------------------------------------------------------------------------------------+\n## LINUX\n+-------------------------------------------------------------------------------------+\n\nsystemctl stop sshd\nsystemctl start sshd\n\n+-------------------------------------------------------------------------------------+\n## AIX\n+-------------------------------------------------------------------------------------+\n\nstopsrc -s sshd;sleep 2;startsrc -s sshd",
        "evidencia": "+-------------------------------------------------------------------------------------+\n## LINUX / AIX\n+-------------------------------------------------------------------------------------+\nclear\ndate\nhostname\n/usr/sbin/sshd -T|grep -i loglevel\ncat /etc/ssh/sshd_config | grep -i loglevel",
        "SO": "Linux / Aix"
    },
    {
        "modulo": "ZY.1.2.4 Logging  - Aix / LOGKEEPER",
        "clave": "SUDO LOGKEEPER",
        "descripcion": "Retain Logging for a period of time - either online or backups, Minimum of 180 days",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Rotación para SUDO - Aix, basada en LOGKEEPER a 180 dias\n+-------------------------------------------------------------------------------------+\n## Debe estar el parámetro --trim a 180 --keep a 180 en las tareas del CRONTAB\n+-------------------------------------------------------------------------------------+\n\ncrontab -l|grep -v ^#|grep logkeeper\n\n## Muestra la configuración que se esta ejecutando en el crontab.\n## Es OK, si parte del resultado del comando es \"/usr/util/seguridad/logkeeper --trim 180 --keep 180\"\n\n+-------------------------------------------------------------------------------------+\n## Comprobar la rotación por logkeeper, que los valores de trim_retention y backup_retention estén a 180.\n## Comprobar que el fichero de sudo.log, este en la rotación de la configuración de logkeeper.\n## Comprobar que el fichero sudo.log, sea el mismo de la rotación y exista.\n## No deben estar los valores comentados.\n## Para sistemas Aix, el fichero sudo.log es : /var/log/sudo.log y deben tener permisos 600.\n+-------------------------------------------------------------------------------------+\n\n/usr/util/seguridad/logkeeper -s | egrep -i \"trim_retention_days|backups_retention_days|sudo\"\ncat /etc/sudoers /etc/sudoers.d/* | grep sudo.log\nls -la /var/log/sudo.log",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup en el HOME\n+-------------------------------------------------------------------------------------+\n\ncd /var/spool/cron/crontabs\ncp -p root /home/$user/root_`date +%d%m%y_%T`",
        "editar": "+-------------------------------------------------------------------------------------+\n## Cambiar /  Añadir el valor de --trim 180 y --keep 180\n+-------------------------------------------------------------------------------------+\n\ncrontab -e\n\n+-------------------------------------------------------------------------------------+\n## Vamos a la configuración existente de logkeeper, despues de /usr/util/seguridad/logkeeper Añadimos.\n+-------------------------------------------------------------------------------------+\n\n--trim 180 --keep 180\n\n+-------------------------------------------------------------------------------------+\n## Comprobamos que se va a ejecutar con.\n+-------------------------------------------------------------------------------------+\n\n/usr/util/seguridad/logkeeper --trim 180 --keep 180 -s|grep retention\n\n+-------------------------------------------------------------------------------------+\n## Corregir permisos del fichero sudo.log, si fuera necesario\n+-------------------------------------------------------------------------------------+\n\nchmod 0600 /var/log/sudo.log",
        "refrescar": null,
        "evidencia": "clear\ndate\nuname -a\ncrontab -l|grep -v ^#|grep logkeeper\n/usr/util/seguridad/logkeeper --trim 180 --keep 180 -s|egrep \"retention|sudo\"\ncat /etc/sudoers /etc/sudoers.d/* | grep sudo.log\nls -la /var/log/sudo.log",
        "SO": "Aix"
    },
    {
        "modulo": "ZY.1.2.4 Logging - Linux / LOGKEEPER",
        "clave": "SUDO LOGKEEPER",
        "descripcion": "Retain Logging for a period of time - either online or backups, Minimum of 180 days",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Rotación para SUDO - Linux, basada en LOGKEEPER a 180 dias\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Debe estar el parámetro --trim a 180 en las tareas del CRONTAB\n+-------------------------------------------------------------------------------------+\n\ncrontab -l|grep -v ^#|grep logkeeper\n\n+-------------------------------------------------------------------------------------+\n## Muestra resumen de la configuracion en LOGKEEPER\n+-------------------------------------------------------------------------------------+\n\n/usr/util/seguridad/logkeeper -s | egrep -i \"trim|backup|sudo|config_file\"\n\n+-------------------------------------------------------------------------------------+\n## Si La rotacion de log se define en el fichero de configuracion, deben estar DESCOMENTADAS las variables\n+-------------------------------------------------------------------------------------+\n\ncat /usr/util/seguridad/logkeeper.cfg | egrep -i \"trim|backup|sudo.log\"\n\n+-------------------------------------------------------------------------------------+\n## ## Para sistemas Linux, el fichero sudo.log es : /var/adm/sudo.log y deben tener permisos 600.\n+-------------------------------------------------------------------------------------+\n\nls -la /var/adm/sudo.log\n",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncd /var/spool/cron/\ncp -p root /home/${user^^}/crontab_root_`date +%d%m%y_%T`\n\ncp -p /usr/util/seguridad/logkeeper.cfg /home/${user^^}/logkeeper.cfg_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncd /var/spool/cron/\ncp -p root /home/${user,,}/crontab_root_`date +%d%m%y_%T`\n\ncp -p /usr/util/seguridad/logkeeper.cfg /home/${user,,}/logkeeper.cfg_`date +%d%m%y_%T`\n\n\n",        
        "editar": "+-------------------------------------------------------------------------------------+\n## Cambiar /  Añadir el valor de --trim 180\n+-------------------------------------------------------------------------------------+\n\ncrontab -e\n\n+-------------------------------------------------------------------------------------+\n## Vamos a la configuración existente de logkeeper, despues de /usr/util/seguridad/logkeeper Añadimos.\n+-------------------------------------------------------------------------------------+\n\n--trim 180\n\n+-------------------------------------------------------------------------------------+\n## Comprobamos que se va a ejecutar con.\n+-------------------------------------------------------------------------------------+\n\n/usr/util/seguridad/logkeeper --trim 180 -s|grep retention\n\n+-------------------------------------------------------------------------------------+\n## Corregir permisos del fichero sudo.log, si fuera necesario\n+-------------------------------------------------------------------------------------+\n\nchmod 0600 /var/adm/sudo.log\n\n+-------------------------------------------------------------------------------------+\n## ## Si la rotacion se define en el fichero de configuracion\n## Descomentar y editar a 180 dias\n\n- trim_retention_days\n- backups_retention_days\n- $sudo = \"/var/adm/sudo.log\"\n+-------------------------------------------------------------------------------------+\n\nvi /usr/util/seguridad/logkeeper.cfg\n\n",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\ncrontab -l|grep -v ^#|grep logkeeper\n/usr/util/seguridad/logkeeper --trim 180 -s | egrep \"retention|sudo|config_file\"\ncat /usr/util/seguridad/logkeeper.cfg | egrep -w \"trim_retention_days|backups_retention_days|/var/adm/sudo.log\"\ncat /etc/sudoers /etc/sudoers.d/* | grep sudo.log\nls -la /var/adm/sudo.log",
        "SO": "Linux"
    },
    {
        "modulo": "ZY.1.2.4 Logging - Linux / Logrotate.conf",
        "clave": "SUDO LOGROTATE",
        "descripcion": "Retain Logging for a period of time - either online or backups, Minimum of 180 days",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Rotación para SUDO - Linux, basada en LOGROTATE.CONF a 180 dias\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Debe estar en 'weekly' 'rotate 26'\n+-------------------------------------------------------------------------------------+\n\nhead -10 /etc/logrotate.conf\n\n+-------------------------------------------------------------------------------------+\n## Si La rotacion de log se define en el fichero de configuracion, deben estar DESCOMENTADAS las variables para SUDO\n+-------------------------------------------------------------------------------------+\n\ncat /etc/logrotate.conf | egrep -i \"sudo.log\" -A5 --color=always\n\n+-------------------------------------------------------------------------------------+\n## Si la configuracion de rotado para sudo, no existe en logrotate.conf, debe estar implementado en logrotate.d\n+-------------------------------------------------------------------------------------+\n\ncat /etc/logrotate.d/* | egrep -i \"sudo.log\" -A7 --color=always\n\n+-------------------------------------------------------------------------------------+\n## ## Para sistemas Linux, el fichero sudo.log es : /var/adm/sudo.log y deben tener permisos 600.\n+-------------------------------------------------------------------------------------+\n\nls -la /var/adm/sudo.log\n",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/logrotate.conf /home/${user^^}/logrotate_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/logrotate.conf /home/${user,,}/logrotate_`date +%d%m%y_%T`\n\n\n",        
        "editar": "+-------------------------------------------------------------------------------------+\n## Cambiar /  Añadir el valor de rotate a 26\n+-------------------------------------------------------------------------------------+\n\nvi /etc/logrotate.conf\n\n+-------------------------------------------------------------------------------------+\n## Añadimos el fichero de `/var/adm/sudo.log` en `/etc/logrotate.d/syslog`\n+-------------------------------------------------------------------------------------+\n\nvi /etc/logrotate.d/syslog\n\n+-------------------------------------------------------------------------------------+\n## Corregir permisos del fichero sudo.log, si fuera necesario\n+-------------------------------------------------------------------------------------+\n\nchmod 0600 /var/adm/sudo.log\n\n",
        "refrescar": "logrotate -f /etc/logrotate.conf",
        "evidencia": "clear\ndate\nhostname\nhead -10 /etc/logrotate.conf\ncat /etc/logrotate.conf | egrep -i \"sudo.log\" -A5 --color=always\ncat /etc/logrotate.d/* | egrep -i \"sudo.log\" -A7 --color=always\nls -la /var/adm/sudo.log",
        "SO": "Linux"
    },
    {
        "modulo": "AV.1.2.4 Logging",
        "clave": "SSH LOGKEEPER",
        "descripcion": "Retain Logging for a period of time - either online or backups, Minimum of 180 days",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Rotación para SSH - Aix, basada en LOGKEEPER\n+-------------------------------------------------------------------------------------+\n## Debe estar el parámetro --trim a 180\n+-------------------------------------------------------------------------------------+\n\ncrontab -l|grep -v ^#|grep logkeeper\n\n## Muestra la configuración que se esta ejecutando en el crontab.\n## Es OK, si parte del resultado del comando es \"/usr/util/seguridad/logkeeper --trim 180 --keep 180\"\n\n+-------------------------------------------------------------------------------------+\n## Comprobar la rotación por logkeeper, que los valores de trim_retention y backup_retention estén a 180.\n## Comprobar que el fichero de seguridad, este en la rotación de la configuración de logkeeper.\n## Comprobar que el fichero de seguridad, sea el mismo de la rotación y exista.\n## No deben estar los valores comentados.\n## Para sistemas Aix, el fichero de seguridad : /var/adm/messages y deben tener permisos 770.\n+-------------------------------------------------------------------------------------+\n\n/usr/util/seguridad/logkeeper -s | egrep -i \"trim_retention_days|backups_retention_days|messages\"\ncat /etc/syslog.conf |grep -v \"#\" |grep \"messages\"\nls -la /var/adm/messages",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup en el HOME\n+-------------------------------------------------------------------------------------+\n\ncd /var/spool/cron/crontabs\ncp -p root /home/$user/root_`date +%d%m%y_%T`\n\ncp -p /etc/syslog.conf /home/$user/syslog_`date +%d%m%y_%T`",
        "editar": "+-------------------------------------------------------------------------------------+\n## Cambiar /  Añadir el valor de --trim a 180\n+-------------------------------------------------------------------------------------+\n\ncrontab -e\n\n+-------------------------------------------------------------------------------------+\n## Vamos a la configuración existente de logkeeper y Añadimos.\n+-------------------------------------------------------------------------------------+\n\n--trim 180 --keep 180\n\n+-------------------------------------------------------------------------------------+\n## Comprobamos que se va a ejecutar con.\n+-------------------------------------------------------------------------------------+\n\n/usr/util/seguridad/logkeeper --trim 180 --keep 180 -s|grep retention\n\n+-------------------------------------------------------------------------------------+\n## Corregir permisos del fichero de seguridad : /var/adm/messages\n+-------------------------------------------------------------------------------------+\n\nchmod 0770 /var/adm/messages\n\n+-------------------------------------------------------------------------------------+## Añadir el fichero de segurida a la configuracion de syslog\n+-------------------------------------------------------------------------------------+\n\nvi /etc/syslog.conf\n\nauth.info;authpriv.info /var/adm/messages",
        "refrescar": "refresh -s syslogd",
        "evidencia": "clear\ndate\nuname -a\ncrontab -l|grep -v ^#|grep logkeeper\n/usr/util/seguridad/logkeeper --trim 180 --keep 180 -s|egrep \"retention|messages\"\ncat /etc/syslog.conf |grep -v \"#\" |grep \"messages\"\nls -la /var/adm/messages",
        "SO": "Aix"
    },
    {
        "modulo": "BV.1.2.1 Logging",
        "clave": "OS LOGKEEPER",
        "descripcion": "Retain Logging for a period of time - either online or backups, Minimum of 180 days",
        "comprobacion": null,
        "copia": null,
        "editar": null,
        "refrescar": null,
        "evidencia": "clear\ndate\nuname -a\ncrontab -l|grep -v ^#|grep logkeeper\n/usr/util/seguridad/logkeeper --trim 180 --keep 180 -s|egrep \"sulog|messages|cron|wtmp|failedlogin|backup|sudo|config_file\"\nls -la /var/adm/sulog /var/log/sudo.log /var/adm/messages /var/adm/cron/log /var/adm/wtmp /etc/security/failedlogin",
        "SO": "Vios"
    },
    {
        "modulo": "Password Requirements/Password MAX Age /etc/shadow - Aix",
        "clave": "MAXAGE",
        "descripcion": "Account $account has invalid Password Max Age setting = 0, must be Customer Required Setting: 13; Account Type: IBM (Strictest Setting Validated). Direct login: 1      must be set to \"false\". Remote login:  1      must be set to \"false\". Id must exist in file. Value of login shell:  /usr/bin/ksh must be \"/bin/false\"",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Para aplicar un correcto MAXAGE, hay que tener en cuenta el tipo de cuenta que es:\n## Ya sea tipo /C/F/S/.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es de tipo /C/, --> se pasa a excepcionar con RISK e IMPACT.\n\n## (Revisar el fichero de RISK e IMPACT)\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es de tipo /F/ --> se cambia a 90 dias (13 semanas), ejemplo de cuentas aplicable MAXAGE : root, emer, cyberark.\n\n## Dependiendo el cliente, alguna cuentas de TIPO F, se exepcionan con RISK e IMPACT, si fuera el caso se debe hablar con el owner de la cuenta, y que nos indique un RISK e IMPACT, o del contrario si se puede aplicar MAXAGE.\n\n## (Revisar \" * ACCOUNT * \", antes de cualquier cambio)\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es de tipo /S/ aplicativos, por lo normal no llevan una password asignada, si ese fuera el caso, se debe preguntar al owner de la cuenta, si se le puede aplicar expiracion de passwor o bien se pasa a excepcionar\n+-------------------------------------------------------------------------------------+",
        "copia": null,
        "editar": "+-------------------------------------------------------------------------------------+\n## Cambiar MAXAGE a 13\n+-------------------------------------------------------------------------------------+\n\nchuser maxage=13 $account",
        "refrescar": null,
        "evidencia": "clear\ndate\nuname -a\nlsuser -a maxage $account",
        "SO": "Aix"
    },
    {
        "modulo": "Password Requirements/Password MAX Age /etc/shadow - Linux",
        "clave": "MAXAGE",
        "descripcion": "Account $account has invalid Password Max Age setting of 99999  should be set to Customer Required Setting: 90. More secure value can be set.",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Para aplicar un correcto MAXAGE, hay que tener en cuenta el tipo de cuenta que es:\n## Ya sea tipo /C/F/S/.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es de tipo /C/, --> se pasa a excepcionar con RISK e IMPACT.\n\n## (Revisar el fichero de RISK e IMPACT)\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es de tipo /F/ --> se cambia a 90 dias, ejemplo de cuentas aplicable MAXAGE : root, emer, cyberark.\n\n## Dependiendo el cliente, alguna cuentas de TIPO F, se exepcionan con RISK e IMPACT, si fuera el caso se debe hablar con el owner de la cuenta, y que nos indique un RISK e IMPACT, o del contrario si se puede aplicar MAXAGE.\n\n## (Revisar \" * ACCOUNT * \", antes de cualquier cambio)\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es de tipo /S/ aplicativos, por lo normal no llevan una password asignada, si ese fuera el caso, se debe preguntar al owner de la cuenta, si se le puede aplicar expiracion de passwor o bien se pasa a excepcionar\n+-------------------------------------------------------------------------------------+",
        "copia": null,
        "editar": "+-------------------------------------------------------------------------------------+\n## Cambiar MAXAGE a 90\n+-------------------------------------------------------------------------------------+\n\nchage -M 90 $account",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\nchage -l $account\ncat /etc/passwd | grep -i $account",
        "SO": "Linux"
    },
    {
        "modulo": "AD.1.1.1.2 Password Requirements",
        "clave": "MAXAGE",
        "descripcion": "Account $account has invalid Password Max Age setting of 99999  should be set to Customer Required Setting: 90. More secure value can be set.",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Para aplicar un correcto MAXAGE, hay que tener en cuenta el tipo de cuenta que es:\n## Ya sea tipo /C/F/S/.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es de tipo /C/, --> se pasa a excepcionar con RISK e IMPACT.\n\n## (Revisar el fichero de RISK e IMPACT)\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es de tipo /F/ --> se cambia a 90 dias, ejemplo de cuentas aplicable MAXAGE : root, emer, cyberark.\n\n## Dependiendo el cliente, alguna cuentas de TIPO F, se exepcionan con RISK e IMPACT, si fuera el caso se debe hablar con el owner de la cuenta, y que nos indique un RISK e IMPACT, o del contrario si se puede aplicar MAXAGE.\n\n## (Revisar \" * ACCOUNT * \", antes de cualquier cambio)\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es de tipo /S/ aplicativos, por lo normal no llevan una password asignada, si ese fuera el caso, se debe preguntar al owner de la cuenta, si se le puede aplicar expiracion de passwor o bien se pasa a excepcionar\n+-------------------------------------------------------------------------------------+",
        "copia": null,
        "editar": "+-------------------------------------------------------------------------------------+\n## Cambiar MAXAGE a 90\n+-------------------------------------------------------------------------------------+\n\nchage -M 90 $account",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\nchage -l $account\ncat /etc/passwd | grep -i $account",
        "SO": "Linux"
    },
    {
        "modulo": "E.1.2.5.1 Logging",
        "clave": "SYSLOG.CONF",
        "descripcion": "Must contain: \nauth.info /var/adm/messages \nOR\nauth.debug /var/adm/messages",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Para sistemas Aix, el fichero de seguridad : /var/adm/messages debe existir y deben tener permisos 770\n\n## Syslog debe estar configurado auth.info /var/adm/messages\n+-------------------------------------------------------------------------------------+\n\ncat /etc/syslog.conf |grep -v \"#\" |egrep \"auth.info|messages\"\nls -la /var/adm/messages",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup en el HOME\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/syslog.conf /home/$user/syslog_`date +%d%m%y_%T`",
        "editar": "+-------------------------------------------------------------------------------------+\n## Corregir permisos del fichero de seguridad : /var/adm/messages\n+-------------------------------------------------------------------------------------+\n\nchmod 0770 /var/adm/messages\n\n+-------------------------------------------------------------------------------------+## Añadir el fichero de segurida a la configuracion de syslog\n+-------------------------------------------------------------------------------------+\n\nvi /etc/syslog.conf\n\nauth.info;authpriv.info /var/adm/messages",
        "refrescar": "refresh -s syslogd",
        "evidencia": "clear\ndate\nuname -a\n/usr/util/seguridad/logkeeper --trim 180 --keep 180 -s|egrep \"retention|messages\"\ncat /etc/syslog.conf |grep -v \"#\" |grep \"messages\"\nls -la /var/adm/messages",
        "SO": "Aix"
    },
    {
        "modulo": "E.1.2.5.3 Logging",
        "clave": "SYSLOG.CONF",
        "descripcion": "Must contain: \nauthpriv.info /var/adm/messages",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Para sistemas Aix, el fichero de seguridad : /var/adm/messages debe existir y deben tener permisos 770\n\n## Syslog debe estar configurado authpriv.info /var/adm/messages\n+-------------------------------------------------------------------------------------+\n\ncat /etc/syslog.conf |grep -v \"#\" |egrep \"authpriv.info|messages\"\nls -la /var/adm/messages",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup en el HOME\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/syslog.conf /home/$user/syslog_`date +%d%m%y_%T`",
        "editar": "+-------------------------------------------------------------------------------------+\n## Corregir permisos del fichero de seguridad : /var/adm/messages\n+-------------------------------------------------------------------------------------+\n\nchmod 0770 /var/adm/messages\n\n+-------------------------------------------------------------------------------------+## Añadir el fichero de segurida a la configuracion de syslog\n+-------------------------------------------------------------------------------------+\n\nvi /etc/syslog.conf\n\nauth.info;authpriv.info /var/adm/messages",
        "refrescar": "refresh -s syslogd",
        "evidencia": "clear\ndate\nuname -a\n/usr/util/seguridad/logkeeper --trim 180 --keep 180 -s|egrep \"retention|messages\"\ncat /etc/syslog.conf |grep -v \"#\" |grep \"messages\"\nls -la /var/adm/messages",
        "SO": "Aix"
    },
    {
        "modulo": "IZ.1.9.1.3 Protecting Resources - User Resources",
        "clave": "UMASK IBMSINIT.SH",
        "descripcion": "File /etc/profile.d/IBMsinit.sh must exist, be readable by all users, and contain at least:\nif [ $UID -gt 199 ]; then\numask 077\nfi",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Igual al MODULO : \n+-------------------------------------------------------------------------------------+\n\nAD.1.9.1.3 Protecting Resources - User Resources",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/profile.d/IBMsinit.sh /home/${user^^}/IBMsinit.sh_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/profile.d/IBMsinit.sh /home/${user,,}/IBMsinit.sh_`date +%d%m%y_%T`",
        "editar": "+-------------------------------------------------------------------------------------+\n## Creamos fichero y asignamos los permisos correctos.\n+-------------------------------------------------------------------------------------+\n\ntouch /etc/profile.d/IBMsinit.sh\nchmod 0755 /etc/profile.d/IBMsinit.sh\n\n+-------------------------------------------------------------------------------------+\n## Editar y añadir el siguiente SCRIPT:\n+-------------------------------------------------------------------------------------+\n\nvi /etc/profile.d/IBMsinit.sh\n\n#--------- begin IBMsinit.sh --------#\nif [ $UID -gt 199 ]; then\numask 077\nfi\n#--------- end IBMsinit.sh  ---------#\n\n+-------------------------------------------------------------------------------------+\n## Ademas debemos implementar la invocacion a la llamada del fichero.\n## La invocacion se implementa despues de un script de UMASK.\n+-------------------------------------------------------------------------------------+\n\nvi /etc/profile\n\n. /etc/profile.d/IBMsinit.sh",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\ncat /etc/profile.d/IBMsinit.sh\ncat /etc/profile  | grep -i  IBMsinit.sh\nls -l /etc/profile.d/IBMsinit.sh",
        "SO": "Linux"
    },
    {
        "modulo": "IZ.1.9.1.4 Protecting Resources - User Resources",
        "clave": "UMASK IBMSINIT.CSH",
        "descripcion": "File /etc/profile.d/IBMsinit.csh must exist, be readable by all users, and contain at least:\nif [ $UID -gt 199 ]; then\numask 077\nfi",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Igual al MODULO : \n+-------------------------------------------------------------------------------------+\n\nAD.1.9.1.4 Protecting Resources - User Resources",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/profile.d/IBMsinit.csh /home/${user^^}/IBMsinit.csh_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/profile.d/IBMsinit.csh /home/${user,,}/IBMsinit.csh_`date +%d%m%y_%T`\n",
        "editar": "+-------------------------------------------------------------------------------------+\n## Creamos fichero y asignamos los permisos correctos.\n+-------------------------------------------------------------------------------------+\n\ntouch /etc/profile.d/IBMsinit.csh\nchmod 0755 /etc/profile.d/IBMsinit.csh\n\n+-------------------------------------------------------------------------------------+\n## Editar y añadir el siguiente SCRIPT:\n+-------------------------------------------------------------------------------------+\n\nvi /etc/profile.d/IBMsinit.csh\n\n#--------- end IBMsinit.csh  ---------#\nif ($uid > 199) then\n    umask 077\nendif\n#--------- end IBMsinit.csh  ---------#\n\n+-------------------------------------------------------------------------------------+\n## Ademas debemos implementar la invocacion a la llamada del fichero.\n## La invocacion se implementa en la ultima linea.\n+-------------------------------------------------------------------------------------+\n\nvi  /etc/csh.login\n\nsource /etc/profile.d/IBMsinit.csh",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\ncat /etc/profile.d/IBMsinit.csh\ncat /etc/csh.login  | grep -i  IBMsinit.csh\nls -l /etc/profile.d/IBMsinit.csh",
        "SO": "Linux"
    },
    {
        "modulo": "Network Settings/Disable NFS server",
        "clave": "NFS",
        "descripcion": "NFS server enabled, it must be disabled.",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## No es un servicio requerido, por lo que se puede deshabilitar en servidores que no son NIM MASTER.\n+-------------------------------------------------------------------------------------+\n\nlslpp -L | grep bos.sysmgt.nim.master\n\n+-------------------------------------------------------------------------------------+\n## Si no es un NIM MASTER, se puede comprobar que NFS server no este habilitado\n+-------------------------------------------------------------------------------------+\n\nlslpp -L |grep bos.net.nfs.server\n\n+-------------------------------------------------------------------------------------+\n## Debe salir vacio en /etc/exports\n+-------------------------------------------------------------------------------------+\n\ncat /etc/exports\n\n+-------------------------------------------------------------------------------------+\n## En el caso de tener shares/filesystem, contactar con el SOPORTE TECNICO.\n+-------------------------------------------------------------------------------------+",
        "copia": null,
        "editar": "installp -u bos.net.nfs.server",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\nlslpp -L | grep bos.sysmgt.nim.master\nlslpp -L |grep bos.net.nfs.server",
        "SO": "Aix"
    },
    {
        "modulo": "E.1.5.18.0 Network Settings",
        "clave": "NFS",
        "descripcion": "NFS server enabled, it must be disabled.",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## No es un servicio requerido, por lo que se puede deshabilitar en servidores que no son NIM MASTER.\n+-------------------------------------------------------------------------------------+\n\nlslpp -L | grep bos.sysmgt.nim.master\n\n+-------------------------------------------------------------------------------------+\n## Si no es un NIM MASTER, se puede comprobar que NFS server no este habilitado\n+-------------------------------------------------------------------------------------+\n\nlslpp -L |grep bos.net.nfs.server\n\n+-------------------------------------------------------------------------------------+\n## Debe salir vacio en /etc/exports\n+-------------------------------------------------------------------------------------+\n\ncat /etc/exports\n\n+-------------------------------------------------------------------------------------+\n## En el caso de tener shares/filesystem, contactar con el SOPORTE TECNICO.\n+-------------------------------------------------------------------------------------+",
        "copia": null,
        "editar": "installp -u bos.net.nfs.server",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\nlslpp -L | grep bos.sysmgt.nim.master\nlslpp -L |grep bos.net.nfs.server",
        "SO": "Aix"
    },
    {
        "modulo": "Password Requirements/Automatic Logoff /etc/profile TMOUT",
        "clave": "TMOUT PROFILE",
        "descripcion": "/etc/profile Set systems to terminate a session after 21600 seconds of inactivity. File must  contain \"TMOUT=21600\" followed by \"export TMOUT\". A shorter time frame may be specified.",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## En /etc/profile, al final del SCRIPT\n## Debe tener un TMOUT\n+-------------------------------------------------------------------------------------+\n\ncat /etc/profile | grep -i TMOUT\n\n+-------------------------------------------------------------------------------------+\n## SET muestra el valor por defecto\n+-------------------------------------------------------------------------------------+\n\nset | grep OUT",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup en HOME\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/profile /home/$user/profile_`date +%d%m%y_%T`",
        "editar": "+-------------------------------------------------------------------------------------+\n## Editar y Añadir al final del SCRIPT\n+-------------------------------------------------------------------------------------+\n\nvi /etc/profile\n\nTMOUT=21600\nexport TMOUT",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\ncat /etc/profile | grep -i TMOUT\nset | grep OUT",
        "SO": "Aix"
    },
    {
        "modulo": "Password Requirements/Automatic Logoff /etc/tsh_profile TMOUT",
        "clave": "TMOUT TSH",
        "descripcion": "/etc/tsh_profile Default: Set systems to terminate a session after 21600 seconds of inactivity. File must  contain \"TMOUT=21600\" followed by \"export TMOUT\". A shorter time frame may be specified.",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## En /etc/tsh_profile, al final del SCRIPT\n## Debe tener un TMOUT\n+-------------------------------------------------------------------------------------+\n\ncat /etc/tsh_profile | grep -i TMOUT\n",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup en HOME\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/tsh_profile /home/$user/tsh_profile`date +%d%m%y_%T`",
        "editar": "+-------------------------------------------------------------------------------------+\n## Editar y Añadir al final del SCRIPT\n+-------------------------------------------------------------------------------------+\n\nvi /etc/tsh_profile\n\nTMOUT=21600\nexport TMOUT",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\ncat /etc/tsh_profile | grep -i TMOUT",
        "SO": "Aix"
    },
    {
        "modulo": "Password Requirements/Automatic Logoff /etc/csh.login autologout",
        "clave": "AUTOLOGOUT CSH",
        "descripcion": "/etc/csh.login Default: Set systems to terminate a session after 360 minutes of inactivity. File must contain \"set autologout=360\". A shorter time frame may be specified.",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## En /etc/csh.login, al final del SCRIPT\n## Debe tener un autologout\n+-------------------------------------------------------------------------------------+\n\ncat /etc/csh.login | grep -i autologout\n\n",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup en HOME\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/csh.login /home/$user/csh.login`date +%d%m%y_%T`",
        "editar": "+-------------------------------------------------------------------------------------+\n## Editar y Añadir al final del SCRIPT\n+-------------------------------------------------------------------------------------+\n\nvi /etc/csh.login\n\nset autologout=360",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\ncat /etc/csh.login | grep -i autologout\n",
        "SO": "Aix"
    }
]

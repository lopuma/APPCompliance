[
    {
        "modulo": "Protecting Resources-OSRs/Log File Restrictions",
        "clave": "WTMP",
        "descripcion": "Invalid Permissions or Ownership for log file: /var/log/wtmp;   -rw-rw-r--.;  owner:  root;   group:  utmp. For more information see rule description.",
        "comprobacion": "## Se le debe quitar W al grupo.\n\n+-------------------------------------------------------------------------------------+\n## Comprobar que en logrotate.conf, tenga permisosa 0644\n+-------------------------------------------------------------------------------------+\n\ncat /etc/logrotate.conf | grep -w wtmp -A4\n\ncat /etc/logrotate.d/* | grep -w wtmp -A4",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/logrotate.conf /home/${user^^}/logrotate.conf_`date +%d%m%y`\ncp -p /etc/logrotate.d/wtmp /home/${user^^}/logrotate_wtmp_`date +%d%m%y`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/logrotate.conf /home/${user,,}/logrotate.conf_`date +%d%m%y`\ncp -p /etc/logrotate.d/wtmp /home/${user,,}/logrotate_wtmp_`date +%d%m%y`",
        "editar": "+-------------------------------------------------------------------------------------+\n## Quitar permisos al fichero\n+-------------------------------------------------------------------------------------+\n\nchmod g-w /var/log/wtmp\n\n+-------------------------------------------------------------------------------------+\n## Dejar esta linea para REHL 7:\n+-------------------------------------------------------------------------------------+\n\n## Editar:\n\nvi /lib/tmpfiles.d/var.conf\n\n## Debe quedar la linea asi:\n\nf /var/log/wtmp 0644 root utmp -\n\n+-------------------------------------------------------------------------------------+\n## Dejar esta linea para REHL 6\n+-------------------------------------------------------------------------------------+\n\n## Editar:\n\nvi /etc/rc.sysinit\n\n## Dejar la linea asi:\n\nchmod 0644 /var/run/utmp /var/log/wtmp\n\n+-------------------------------------------------------------------------------------+\n## Corregir los permisos en logrotate.conf O en /etc/logrotate.d/wtmp, en create de wtmp\n+-------------------------------------------------------------------------------------+\n\nvi /etc/logrotate.conf\n\nvi /etc/logrotate.d/wtmp\n\n+-------------------------------------------------------------------------------------+\n## Modificar los permisos de 0664, a 0644, al fichero /var/log/wtmp\n+-------------------------------------------------------------------------------------+",
        "refrescar": null,
        "evidencia": "+-------------------------------------------------------------------------------------+\n## RHEL 6\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -la /var/log/wtmp\ncat cat /etc/rc.sysinit | grep -w 'wtmp'\ncat /etc/logrotate.conf | grep -w wtmp -A4\n\n+-------------------------------------------------------------------------------------+\n## RHEL 7\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -la /var/log/wtmp\ncat /lib/tmpfiles.d/var.conf | grep -w wtmp\ncat /etc/logrotate.conf | grep -w wtmp -A4\n",
        "SO": "Linux"
    },
    {
        "modulo": "protecting Resources-OSRs/SUDO Command WW Permissions",
        "clave": "COMMAND",
        "descripcion": "Invalid WW permissions for command file/directory: $fdSUDO  Permissions: drwxr-xrwx  Permissions for OTHER must be set to r-x or more stringent.",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Cambiar permisos al fichero/directorio del comando que se ejecuta en SUDOERS\n## Antes de seguir, buscar el file/directory en - * COMMAND * -\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Localizar la plantilla de SUDO, que tenga implementada el file/directory\n## Debemos mirar en la plantilla, si el file/directory, no se crean con los permisos de W en OTHER, sobre todo para que no se sigan generando estos permisos.\n+-------------------------------------------------------------------------------------+\n\ncd /etc/sudoers.d/\n\ngrep -irw \"$fdSUDO\" -A5\n\n+-------------------------------------------------------------------------------------+\n## Comprobar los permisos del file/directory:\n## No deben tener permisos de ESCRITURA en  OTHER\n## Si es de tipo /C/, se debe excepcionar: revisar RISK e IMPACT\n+-------------------------------------------------------------------------------------+\n\nls -ld $fdSUDO",
        "copia": null,
        "editar": "+-------------------------------------------------------------------------------------+\n## Quitar permisos de W a other al file/directory de SUDO\n+-------------------------------------------------------------------------------------+\n\nchmod o-w $fdSUDO",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\nls -ld $fdSUDO",
        "SO": "Linux"
    },
    {
        "modulo": "Business Use Notice/Business Use Notice Required",
        "clave": "BUN",
        "descripcion": "Missing or Incorrect Business Use Notice. It should be set in /etc/motd",
        "comprobacion": "##Debe tener el BUN actual.",
        "copia": null,
        "editar": "vi /etc/motd\n\n+-------------------------------------------------------------------------------------+\n##añadir / remplazar :\n+-------------------------------------------------------------------------------------+\n\nAdvertencia Legal\nEn cumplimiento de la Ley Organica de Proteccion de Datos de Caracter Personal 15/99, los datos de caracter personal extraidos de los Sistemas de Informacion estan sujetos a las siguientes consideraciones:\n- Solo se utilizaran para el proposito indicado en el objeto de la extraccion.\n- Se eliminaran fisicamente de cualquier soporte personal en que se hayan almacenados una vez finalizada la tarea para la que fueron extraidos.\n- No se extraeran de las instalaciones fisicas donde residen.\nORANGE ESPAGNE informa al empleado que los recursos informaticos puestos a su disposicion, tales como correo electronico y acceso a Internet, son una herramienta de trabajo facilitada por Orange, por lo que su uso estara limitado a las funciones asociadas al desarrollo de la actividad profesional del usuario.\nEs responsabilidad del usuario de los Sistemas de Informacion el cumplimiento de las consideraciones indicadas.",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\ncat /etc/motd",
        "SO": "Linux"
    },
    {
        "modulo": "Encryption/Password Encryption Required",
        "clave": "SHA512",
        "descripcion": "/etc/pam.d/password-auth.\n/etc/pam.d/system-auth.\nAny file in /etc/pam.d containing \"password sufficient pam_unix.so\" stanza must carry the \"sha512 shadow\" options.\n\nIncorrect or missing pam_unix.so module stanza. For more information see coverage matrix document",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Hace referencia al parametro 'sha512 shadow ' en RHEL 7 y RHEL 8.\n+-------------------------------------------------------------------------------------+\n\n## Saber que versión de RHEL es:\n\ncat /etc/*release\n\n+-------------------------------------------------------------------------------------+\n##--- RHEL 7 & RHEL 8 ('system-auth','password-auth')\n## Los ficheros del PAM, deben tener en el modulo 'password    sufficient    pam_unix.so', el parámetro 'sha512 shadow '\n## Ademas deben ser LINK de 'system-auth-ac', 'password-auth-ac'.\n+-------------------------------------------------------------------------------------+\n\ncat /etc/pam.d/system-auth | egrep \"sha512|shadow\"\ncat /etc/pam.d/password-auth | egrep \"sha512|shadow\"\nls -la /etc/pam.d/system-auth\nls -la /etc/pam.d/password-auth\n\n+-------------------------------------------------------------------------------------+\n## Si la configuracion anterior es valida. revisar que no hayan BACKUPS de los ficheros del PAM\n\n## Ficheros .ori, .bck, .backup, -local, o todo aquel que sea una copia de, 'system-auth', 'password-auth', o de 'system-auth-ac', 'password-auth-ac'\n+-------------------------------------------------------------------------------------+\n\ncd /etc/pam.d/\nls -la system-*\nls -la password-*\n\n+-------------------------------------------------------------------------------------+\n## Mover los BACKUPS al home\n+-------------------------------------------------------------------------------------+\n## Hacer link entre 'system-auth' y 'system-auth-ac', o 'password-auth' y 'password-auth-ac', SI ES NECESARIO\n\n## El siguiente comando, es para los ficheros del PAM, sean LINK.\n+-------------------------------------------------------------------------------------+\n\nrm -r system-auth\nln -s system-auth-ac system-auth\n\nrm -r password-auth\nln -s password-auth-ac password-auth\n\n+-------------------------------------------------------------------------------------+\n## Modulo similiar : 'Password Requirements/Password History'\n+-------------------------------------------------------------------------------------+",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/pam.d/system-auth /home/${user^^}/system-auth_`date +%d%m%y_%T`\n\ncp -p /etc/pam.d/password-auth /home/${user^^}/password-auth_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/pam.d/system-auth /home/${user,,}/system-auth_`date +%d%m%y_%T`\n\ncp -p /etc/pam.d/password-auth /home/${user,,}/password-auth_`date +%d%m%y_%T`\n",
        "editar": "+-------------------------------------------------------------------------------------+\n##--- RHEL 7 & RHEL 8 ('system-auth','password-auth')\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Añadir en el modulo 'password    sufficient    pam_unix.so', el parámetro 'sha512 shadow'.\n## ('se aconseja remplazar toda la linea, del modulo 'password    sufficient    pam_unix.so').\n+-------------------------------------------------------------------------------------+\n\nvi /etc/pam.d/system-auth\n\npassword    sufficient    pam_unix.so remember=5 use_authtok sha512 shadow try_first_pass\n\n+-------------------------------------------------------------------------------------+\n## Lo mismo con 'password-auth'\n+-------------------------------------------------------------------------------------+\n\nvi /etc/pam.d/password-auth\n",
        "refrescar": null,
        "evidencia": "clear\ndate;hostname\ncat /etc/*release | grep -i release\ncat /etc/pam.d/system-auth | egrep \"sha512|shadow\"\ncat /etc/pam.d/password-auth | egrep \"sha512|shadow\"\n",
        "SO": "Linux"
    },
    {
        "modulo": "Password Requirements/Password History",
        "clave": "REMEMBER",
        "descripcion": "PAM service file: /etc/pam.d/password-auth\nPAM service file: /etc/pam.d/system-auth\nMust have \"password sufficient pam_unix.so\" stanza with \"remember=5\" parameter. \"sufficient\" can be replaced with \"required\".",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Hace referencia al 'remember' en RHEL 7 y RHEL 8.\n+-------------------------------------------------------------------------------------+\n\n## Saber que versión de RHEL es:\ncat /etc/*release\n\n#-***# Saber que PAM_TALLY USA (RHEL 7) (RHEL 7) #****-#\nls -ltr /lib64/security/pam_tally*\n\n#-*** Saber que PAM_FAILLOCK USA (RHEL 8) ****-#\nls -la /usr/sbin/faillock\n\n+-------------------------------------------------------------------------------------+\n##--- RHEL 7 & RHEL 8 ('system-auth','password-auth')\n+-------------------------------------------------------------------------------------+\n\n## Los ficheros del PAM, deben tener en el modulo 'password    sufficient    pam_unix.so', el parámetro 'remember=5'\n\ncat /etc/pam.d/system-auth | grep remember\ncat /etc/pam.d/password-auth | grep remember\n\n+-------------------------------------------------------------------------------------+\n## Modulo similiar : 'Encryption/Password Encryption Required'\n+-------------------------------------------------------------------------------------+",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/pam.d/system-auth /home/${user^^}/system-auth_`date +%d%m%y_%T`\n\ncp -p /etc/pam.d/password-auth /home/${user^^}/password-auth_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/pam.d/system-auth /home/${user,,}/system-auth_`date +%d%m%y_%T`\n\ncp -p /etc/pam.d/password-auth /home/${user,,}/password-auth_`date +%d%m%y_%T`\n",
        "editar": "+-------------------------------------------------------------------------------------+\n##--- RHEL 7 & RHEL 8 ('system-auth','password-auth')\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Añadir en el modulo 'password    sufficient    pam_unix.so', el parámetro 'remember=5'.\n## ('se aconseja remplazar toda la linea, del modulo 'password    sufficient    pam_unix.so').\n+-------------------------------------------------------------------------------------+\n\nvi /etc/pam.d/system-auth\n\npassword    sufficient    pam_unix.so remember=5 use_authtok sha512 shadow try_first_pass\n\n+-------------------------------------------------------------------------------------+\n## Lo mismo con 'password-auth'\n+-------------------------------------------------------------------------------------+\n\nvi /etc/pam.d/password-auth\n",
        "refrescar": null,
        "evidencia": "clear\ndate;hostname\ncat /etc/*release | grep -i release\ncat /etc/pam.d/system-auth | egrep \"remember\" \ncat /etc/pam.d/password-auth | egrep \"remember\"\n",
        "SO": "Linux"
    },
    {
        "modulo": "Password Requirements/Acceptance of the null password with nullok parameter",
        "clave": "NULLOK",
        "descripcion": "PAM service: '/etc/pam.d/password-auth', '/etc/pam.d/system-auth'   use pam_unix.so auth module with \"nullok\" parameter. This parameter is forbidden as it allows acceptance of the null password.",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Hace referencia al parametro 'nullok' en RHEL 7 y RHEL 8.\n+-------------------------------------------------------------------------------------+\n\n## Saber que versión de RHEL es:\ncat /etc/*release\n\n+-------------------------------------------------------------------------------------+\n##--- RHEL 7 & RHEL 8 ('system-auth','password-auth')\n## Los ficheros del PAM, NO deben tener en el parametro 'nullok', en los diferentes modulos\n+-------------------------------------------------------------------------------------+\n\ncat /etc/pam.d/system-auth | grep \"nullok\"\ncat /etc/pam.d/password-auth | grep \"nullok\"",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/pam.d/system-auth /home/${user^^}/system-auth_`date +%d%m%y_%T`\n\ncp -p /etc/pam.d/password-auth /home/${user^^}/password-auth_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/pam.d/system-auth /home/${user,,}/system-auth_`date +%d%m%y_%T`\n\ncp -p /etc/pam.d/password-auth /home/${user,,}/password-auth_`date +%d%m%y_%T`",
        "editar": "+-------------------------------------------------------------------------------------+\n##--- RHEL 7 & RHEL 8 ('system-auth','password-auth')\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Eliminar el parametro 'nullok', en los diferentes modulos del pam.d.\n+-------------------------------------------------------------------------------------+\n\nvi /etc/pam.d/system-auth\n\n+-------------------------------------------------------------------------------------+\n## Lo mismo con 'password-auth'\n+-------------------------------------------------------------------------------------+\n\nvi /etc/pam.d/password-auth\n",
        "refrescar": null,
        "evidencia": "clear\ndate;hostname\ncat /etc/*release | grep -i release\ncat /etc/pam.d/system-auth | grep \"nullok\"\ncat /etc/pam.d/password-auth | grep \"nullok\"\n",
        "SO": "Linux"
    },
    {
        "modulo": "Network Settings/TCP Configuration Files Restrictions",
        "clave": "SYSCTL",
        "descripcion": "Incorrect /etc/sysctl.conf",
        "comprobacion": "+-------------------------------------------------------------------------------------+\nLos valores por defecto en `/sbin/sysctl`, deben estar establecidos.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Existen server, que la configuracion se realiza desde el fichero de configuracion `/etc/sysctl.conf`, es erroneo se debe establecer valores por defecto.\n+-------------------------------------------------------------------------------------+",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/sysctl.conf /home/${user^^}/sysctl.conf_`date +%d%m%y`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/sysctl.conf /home/${user,,}/sysctl.conf_`date +%d%m%y`",
        "editar": "+-------------------------------------------------------------------------------------+\n## Para hacer el cambio:\n+-------------------------------------------------------------------------------------+\n\n/sbin/sysctl -w net.ipv4.conf.all.secure_redirects=0\n/sbin/sysctl -w net.ipv4.conf.default.secure_redirects=0\n/sbin/sysctl -w net.ipv4.conf.all.log_martians=1\n/sbin/sysctl -w net.ipv4.conf.default.log_martians=1\n/sbin/sysctl -w net.ipv4.conf.all.rp_filter=1\n/sbin/sysctl -w net.ipv4.conf.default.rp_filter=1\n/sbin/sysctl -w net.ipv4.ip_forward=0\n/sbin/sysctl -w net.ipv4.conf.all.accept_source_route=0\n/sbin/sysctl -w net.ipv4.conf.default.accept_source_route=0\n/sbin/sysctl -w net.ipv4.conf.all.accept_redirects=0\n/sbin/sysctl -w net.ipv6.conf.all.accept_ra=0\n/sbin/sysctl -w net.ipv6.conf.default.accept_ra=0\n/sbin/sysctl -w net.ipv6.conf.all.accept_redirects=0\n/sbin/sysctl -w net.ipv6.conf.default.accept_redirects=0\n",
        "refrescar": "sysctl -p",
        "evidencia": "clear\ndate\nhostname\n/sbin/sysctl -a |grep -i \"net.ipv4.conf.all.secure_redirects\"\n/sbin/sysctl -a |grep -i \"net.ipv4.conf.default.secure_redirects\"\n/sbin/sysctl -a |grep -i \"net.ipv4.conf.all.log_martians\"\n/sbin/sysctl -a |grep -i \"net.ipv4.conf.default.log_martians\"\n/sbin/sysctl -a |grep -i \"net.ipv4.conf.all.rp_filter\"\n/sbin/sysctl -a |grep -i \"net.ipv4.conf.default.rp_filter\"\n/sbin/sysctl -a |grep -i \"net.ipv4.conf.all.accept_source_route\"\n/sbin/sysctl -a |grep -i \"net.ipv4.conf.default.accept_source_route\"\n/sbin/sysctl -a |grep -i \"net.ipv4.ip_forward\"\n/sbin/sysctl -a |grep -i \"net.ipv4.conf.all.accept_redirects\"\n/sbin/sysctl -a |grep -i \"net.ipv6.conf.all.accept_ra\"\n/sbin/sysctl -a |grep -i \"net.ipv6.conf.default.accept_ra\"\n/sbin/sysctl -a |grep -i \"net.ipv6.conf.all.accept_redirects\"\n/sbin/sysctl -a |grep -i \"net.ipv6.conf.default.accept_redirects\"\n",
        "SO": "Linux"
    },
    {
        "modulo": "Password Requirements/SSH PermitRootLogin Restriction",
        "clave": "PERMITROOTLOGIN",
        "descripcion": "Invalid setting (value: yes) for sshd (processPID: 4714) in parameter 'PermitRootLogin': must be set to one of 'no', 'without-password', 'nopwd', 'forced-commands-only', 'prohibit-password'.",
        "comprobacion": "## Antes de corregir se debe comprobar que no estén los valores correctos por defecto o no este excepcionado el parametro para dicho servidor\n\n+-------------------------------------------------------------------------------------+\n## Valor por defecto correcto es : No\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Muestra el valor por defecto\n+-------------------------------------------------------------------------------------+\n\n/usr/sbin/sshd -T|grep -i PermitRootLogin\n\n+-------------------------------------------------------------------------------------+\n## Valor definido en el servidor, no debe estar comentado(#), o no debe estar vació\n+-------------------------------------------------------------------------------------+\n\ncat /etc/ssh/sshd_config | grep -i PermitRootLogin",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n## LINUX\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/${user^^}/sshd_config_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/${user,,}/sshd_config_`date +%d%m%y_%T`",
        "editar": "+-------------------------------------------------------------------------------------+\n## Añadir el valor No, al parámetro PermitRootLogin\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Debe quedar algo asi:\n\nPermitRootLogin no\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Editar\n+-------------------------------------------------------------------------------------+\n\nvi /etc/ssh/sshd_config",
        "refrescar": "+-------------------------------------------------------------------------------------+\n## LINUX\n+-------------------------------------------------------------------------------------+\n\nsystemctl stop sshd\nsystemctl start sshd\n\n+-------------------------------------------------------------------------------------+\n## AIX\n+-------------------------------------------------------------------------------------+\n\nstopsrc -s sshd;sleep 2;startsrc -s sshd",
        "evidencia": "clear\ndate\nhostname\n/usr/sbin/sshd -T|grep -i PermitRootLogin\ncat /etc/ssh/sshd_config | grep -i PermitRootLogin",
        "SO": "Linux / Aix"
    },
    {
        "modulo": "Identify and Authenticate Users/PermitRootLogin Restriction",
        "clave": "",
        "descripcion": "SSH Config File: /etc/ssh/sshd_config; Invalid setting (value:yes) in parameter 'PermitRootLogin': must be set to 'no'. May be set to YES, FORCED-COMMANDS-ONLY,or WITHOUT-PASSWORD only if mechanisms are in place to determine the identity of the individual accessing the system.",
        "comprobacion": "## Antes de corregir se debe comprobar que no estén los valores correctos por defecto o no este excepcionado el parametro para dicho servidor\n\n+-------------------------------------------------------------------------------------+\n## Valor por defecto correcto es : No\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Muestra el valor por defecto\n+-------------------------------------------------------------------------------------+\n\n/usr/sbin/sshd -T|grep -i PermitRootLogin\n\n+-------------------------------------------------------------------------------------+\n## Valor definido en el servidor, no debe estar comentado(#), o no debe estar vació\n+-------------------------------------------------------------------------------------+\n\ncat /etc/ssh/sshd_config | grep -i PermitRootLogin",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n## LINUX\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/${user^^}/sshd_config_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/${user,,}/sshd_config_`date +%d%m%y_%T`",
        "editar": "+-------------------------------------------------------------------------------------+\n## Añadir el valor No, al parámetro PermitRootLogin\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Debe quedar algo asi:\n\nPermitRootLogin no\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Editar\n+-------------------------------------------------------------------------------------+\n\nvi /etc/ssh/sshd_config",
        "refrescar": "+-------------------------------------------------------------------------------------+\n## LINUX\n+-------------------------------------------------------------------------------------+\n\nsystemctl stop sshd\nsystemctl start sshd\n\n+-------------------------------------------------------------------------------------+\n## AIX\n+-------------------------------------------------------------------------------------+\n\nstopsrc -s sshd;sleep 2;startsrc -s sshd",
        "evidencia": "clear\ndate\nhostname\n/usr/sbin/sshd -T|grep -i PermitRootLogin\ncat /etc/ssh/sshd_config | grep -i PermitRootLogin",
        "SO": "Linux / Aix"
    },
    {
        "modulo": "Business Use Notice/PrintMotd Restriction",
        "clave": "PRINTMOTD",
        "descripcion": "SSH Config File: /etc/ssh/sshd_config; Invalid setting (value: 0) in parameter 'PrintMotd': must be set to 'yes'.",
        "comprobacion": "## Antes de corregir se debe comprobar que no estén los valores correctos por defecto\n\n+-------------------------------------------------------------------------------------+\n## Valor por defecto correcto es : yes\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Muestra el valor por defecto\n+-------------------------------------------------------------------------------------+\n\n/usr/sbin/sshd -T|grep -i PrintMotd\n\n+-------------------------------------------------------------------------------------+\n## Valor definido en el servidor, no debe estar comentado(#), o no debe estar vació\n+-------------------------------------------------------------------------------------+\n\ncat /etc/ssh/sshd_config | grep -i PrintMotd",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n## LINUX\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/${user^^}/sshd_config_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/${user,,}/sshd_config_`date +%d%m%y_%T`",
        "editar": "+-------------------------------------------------------------------------------------+\n## Añadir el valor yes, al parámetro PrintMotd\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Debe quedar algo asi:\n\nPrintMotd yes\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Editar\n+-------------------------------------------------------------------------------------+\n\nvi /etc/ssh/sshd_config",
        "refrescar": "+-------------------------------------------------------------------------------------+\n## LINUX\n+-------------------------------------------------------------------------------------+\n\nsystemctl stop sshd\nsystemctl start sshd\n\n+-------------------------------------------------------------------------------------+\n## AIX\n+-------------------------------------------------------------------------------------+\n\nstopsrc -s sshd;sleep 2;startsrc -s sshd",
        "evidencia": "clear\ndate\nhostname\n/usr/sbin/sshd -T|grep -i PrintMotd\ncat /etc/ssh/sshd_config | grep -i PrintMotd",
        "SO": "Linux / Aix"
    },
    {
        "modulo": "Password Requirements/Password MAX Age /etc/shadow - Aix",
        "clave": "MAXAGE",
        "descripcion": "Account $account has invalid Password Max Age setting = 0, must be Customer Required Setting: 13; Account Type: IBM (Strictest Setting Validated). Direct login: 1      must be set to \"false\". Remote login:  1      must be set to \"false\". Id must exist in file. Value of login shell:  /usr/bin/ksh must be \"/bin/false\"",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Para aplicar un correcto MAXAGE, hay que tener en cuenta el tipo de cuenta que es:\n## Ya sea tipo /C/F/S/.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es de tipo /C/, --> se pasa a excepcionar con RISK e IMPACT.\n\n## (Revisar el fichero de RISK e IMPACT)\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es de tipo /F/ --> se cambia a 90 dias (13 semanas), ejemplo de cuentas aplicable MAXAGE : root, emer, cyberark.\n\n## Dependiendo el cliente, alguna cuentas de TIPO F, se exepcionan con RISK e IMPACT, si fuera el caso se debe hablar con el owner de la cuenta, y que nos indique un RISK e IMPACT, o del contrario si se puede aplicar MAXAGE.\n\n## (Revisar \" * ACCOUNT * \", antes de cualquier cambio)\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es de tipo /S/ aplicativos, por lo normal no llevan una password asignada, si ese fuera el caso, se debe preguntar al owner de la cuenta, si se le puede aplicar expiracion de passwor o bien se pasa a excepcionar\n+-------------------------------------------------------------------------------------+",
        "copia": null,
        "editar": "+-------------------------------------------------------------------------------------+\n## Cambiar MAXAGE a 13\n+-------------------------------------------------------------------------------------+\n\nchuser maxage=13 $account",
        "refrescar": null,
        "evidencia": "clear\ndate\nuname -a\nlsuser -a maxage $account",
        "SO": "Aix"
    },
    {
        "modulo": "Password Requirements/Password MAX Age /etc/shadow - Linux",
        "clave": "MAXAGE",
        "descripcion": "Account $account has invalid Password Max Age setting of 99999  should be set to Customer Required Setting: 90. More secure value can be set.",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Para aplicar un correcto MAXAGE, hay que tener en cuenta el tipo de cuenta que es:\n## Ya sea tipo /C/F/S/.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es de tipo /C/, --> se pasa a excepcionar con RISK e IMPACT.\n\n## (Revisar el fichero de RISK e IMPACT)\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es de tipo /F/ --> se cambia a 90 dias, ejemplo de cuentas aplicable MAXAGE : root, emer, cyberark.\n\n## Dependiendo el cliente, alguna cuentas de TIPO F, se exepcionan con RISK e IMPACT, si fuera el caso se debe hablar con el owner de la cuenta, y que nos indique un RISK e IMPACT, o del contrario si se puede aplicar MAXAGE.\n\n## (Revisar \" * ACCOUNT * \", antes de cualquier cambio)\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es de tipo /S/ aplicativos, por lo normal no llevan una password asignada, si ese fuera el caso, se debe preguntar al owner de la cuenta, si se le puede aplicar expiracion de passwor o bien se pasa a excepcionar\n+-------------------------------------------------------------------------------------+",
        "copia": null,
        "editar": "+-------------------------------------------------------------------------------------+\n## Cambiar MAXAGE a 90\n+-------------------------------------------------------------------------------------+\n\nchage -M 90 $account",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\nchage -l $account\ncat /etc/passwd | grep -i $account",
        "SO": "Linux"
    },
    {
        "modulo": "AD.1.1.1.2 Password Requirements",
        "clave": "MAXAGE",
        "descripcion": "Account $account has invalid Password Max Age setting of 99999  should be set to Customer Required Setting: 90. More secure value can be set.",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Para aplicar un correcto MAXAGE, hay que tener en cuenta el tipo de cuenta que es:\n## Ya sea tipo /C/F/S/.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es de tipo /C/, --> se pasa a excepcionar con RISK e IMPACT.\n\n## (Revisar el fichero de RISK e IMPACT)\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es de tipo /F/ --> se cambia a 90 dias, ejemplo de cuentas aplicable MAXAGE : root, emer, cyberark.\n\n## Dependiendo el cliente, alguna cuentas de TIPO F, se exepcionan con RISK e IMPACT, si fuera el caso se debe hablar con el owner de la cuenta, y que nos indique un RISK e IMPACT, o del contrario si se puede aplicar MAXAGE.\n\n## (Revisar \" * ACCOUNT * \", antes de cualquier cambio)\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es de tipo /S/ aplicativos, por lo normal no llevan una password asignada, si ese fuera el caso, se debe preguntar al owner de la cuenta, si se le puede aplicar expiracion de passwor o bien se pasa a excepcionar\n+-------------------------------------------------------------------------------------+",
        "copia": null,
        "editar": "+-------------------------------------------------------------------------------------+\n## Cambiar MAXAGE a 90\n+-------------------------------------------------------------------------------------+\n\nchage -M 90 $account",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\nchage -l $account\ncat /etc/passwd | grep -i $account",
        "SO": "Linux"
    },
    {
        "modulo": "Password Requirements/Password MIN Age Shadow",
        "clave": "MINAGE",
        "descripcion": "Account $account has invalid Password Min Age setting of null  should be set to Customer Required Setting: 1. Account Type: Customer",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Todas las cuentas, ya sean /C/F/S, deben tener el MINAGE a 1.\n+-------------------------------------------------------------------------------------+",        
        "copia": null,
        "editar": "+-------------------------------------------------------------------------------------+\n## Cambiar MIANGE a 1\n+-------------------------------------------------------------------------------------+\n\nchage -m 1 $account",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\nchage -l $account\ncat /etc/passwd | grep -i $account",
        "SO": "Linux"
    },
    {
        "modulo": "Protecting Resources-OSRs/IBMsinit Permission Restriction",
        "clave": "OSR IBMSINIT",
        "descripcion": "Invalid permissions for /etc/profile.d/IBMsinit.csh, /etc/profile.d/IBMsinit.sh\nOwner: root, Group: root, Permissions: -rw-r--r--. should be for  \"other\"  of r-x, for \"group\"  of r-x",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Deben existir /etc/profile.d/IBMsinit.sh, /etc/profile.d/IBMsinit.csh y con permisos 755.\n+-------------------------------------------------------------------------------------+\n\nls -l /etc/profile.d/IBMsinit.sh\nls -l /etc/profile.d/IBMsinit.csh\n\n+-------------------------------------------------------------------------------------+\n## Relacionado con :\n+-------------------------------------------------------------------------------------+\n\nAD.1.9.1.3 Protecting Resources - User Resources\nAD.1.9.1.4 Protecting Resources - User Resources",
        "copia": null,
        "editar": "+-------------------------------------------------------------------------------------+\n## Creamos fichero y asignamos los permisos correctos.\n+-------------------------------------------------------------------------------------+\n\ntouch /etc/profile.d/IBMsinit.sh\nchmod 0755 /etc/profile.d/IBMsinit.sh\n\ntouch /etc/profile.d/IBMsinit.csh\nchmod 0755 /etc/profile.d/IBMsinit.csh\n\n",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\nls -l /etc/profile.d/IBMsinit.sh\nls -l /etc/profile.d/IBMsinit.csh",
        "SO": "Linux"
    },
    {
        "modulo": "Protecting Resources-mixed/Ensure sticky bit is set on all world-writable directories",
        "clave": "STICKY",
        "descripcion": "Sticky bit is not set on world-writable directory: $directory",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Aplica a directorios y sub-directorios\n+-------------------------------------------------------------------------------------+\n\n## El desvio trata de aplicar sticky a directorios y sub-directorios, pero en este desvio corregiremos permisos de escritura en OTHER.\n\n+-------------------------------------------------------------------------------------+\n## Hay que tener en cuenta el tipo de owner que pertenece, cada directorio BASE.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Ya sea de tipo '/C/F/S'\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es /C/, se pasa a excepcion con RISK e IMPACT\n## por favor revisar la seccion de RISK e IMPACT\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es de tipo /F/S/, se debe preguntar al owner, si podemos modificar los permisos\n## Revisar ('PERMISSIONS'), antes de cualquier cambio.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Buscar y comprobar los directorios a cambiar permisos. \n+-------------------------------------------------------------------------------------+\n\n## DIRECTORIOS FORMA RECURVISA:\n---\n\n## Busca y muestra el total de directorios:\necho  \"directorios con permisos w en other : \";find $directory -type d -perm -o=wx | wc -l\n\n##Busca y enlista los directorios\nfind $directory -type d -perm -o=wx | xargs -l ls -ld\n\n## DIRECTORIOS FORMA INDIVIDUAL:\n---\nls -ld $directory\n\n+-------------------------------------------------------------------------------------+\n## Pregunta RELACIONADAS\n+-------------------------------------------------------------------------------------+\n\nProtecting Resources-OSRs/OSR \\TMP Files Restrictions\nProtecting Resources-OSRs/OSR \\OPT Files Restrictions\nProtecting Resources-OSRs/OSR \\ETC Restrictions\nProtecting Resources-OSRs/OSR \\VAR Files Restrictions",
        "copia": null,
        "editar": "+-------------------------------------------------------------------------------------+\n## Se puede quitar de forma 'RECURSIVA' o por 'INDIVIDUAL'\n\n## $directory : es la variable del directorio raiz a cambiar permisos.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Asi quitamos de permisos de W a Other, en los directorios('RECURSIVO'):\n+-------------------------------------------------------------------------------------+\n\nfind $directory -type d -perm -o=wx -exec chmod o-w {} \\;\n\n+-------------------------------------------------------------------------------------+\n## Asi quitamos permisos, de W a other de forma('INDIVIDUAL'):\n+-------------------------------------------------------------------------------------+\n\nchmod o-w $directory",
        "refrescar": null,
        "evidencia": "+-------------------------------------------------------------------------------------+\n## De forma ('RECURSIVA'):\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nfind $directory -type d -perm -o=wx | wc -l\nls -ld $directory\n\n+-------------------------------------------------------------------------------------+\n## De forma ('INDIVIDUAL'):\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -ld $directory",
        "SO": "Linux"
    },
    {
        "modulo": "System Settings/SELinux AppArmor install requirement",
        "clave": "SELINUX",
        "descripcion": "SELinux or AppArmor should be installed and enabled",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## 2 - DOC, Revisar RISK e IMPACT\n+-------------------------------------------------------------------------------------+\n\nGENERICO / SELINUX / FT\n\n+-------------------------------------------------------------------------------------+\nRelacionado:\n+-------------------------------------------------------------------------------------+\n\nSystem Settings/SELinux type requirement\nSystem Settings/SELinux mode per domain\nSystem Settings/SELinux current mode requirement",
        "copia": null,
        "editar": null,
        "refrescar": null,
        "evidencia": null,
        "SO": "Linux"
    },
    {
        "modulo": "System Settings/SELinux type requirement",
        "clave": "SELINUX",
        "descripcion": "SELinux should be enabled",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## 2 - DOC, Revisar RISK e IMPACT\n+-------------------------------------------------------------------------------------+\n\nGENERICO / SELINUX / FT\n\n+-------------------------------------------------------------------------------------+\nRelacionado:\n+-------------------------------------------------------------------------------------+\n\nSystem Settings/SELinux AppArmor install requirement\nSystem Settings/SELinux mode per domain\nSystem Settings/SELinux current mode requirement",
        "copia": null,
        "editar": null,
        "refrescar": null,
        "evidencia": null,
        "SO": "Linux"
    },
    {
        "modulo": "System Settings/SELinux mode per domain",
        "clave": "SELINUX",
        "descripcion": "SELinux module: SELinux should be enabled has forbidden state like: ':none:'",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## 2 - DOC, Revisar RISK e IMPACT\n+-------------------------------------------------------------------------------------+\n\nGENERICO / SELINUX / FT\n\n+-------------------------------------------------------------------------------------+\nRelacionado:\n+-------------------------------------------------------------------------------------+\n\nSystem Settings/SELinux AppArmor install requirement\nSystem Settings/SELinux type requirement\nSystem Settings/SELinux current mode requirement",
        "copia": null,
        "editar": null,
        "refrescar": null,
        "evidencia": null,
        "SO": "Linux"
    },
    {
        "modulo": "System Settings/SELinux current mode requirement",
        "clave": "SELINUX",
        "descripcion": "SELinux should be enabled",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## 2 - DOC, Revisar RISK e IMPACT\n+-------------------------------------------------------------------------------------+\n\nGENERICO / SELINUX / FT\n\n+-------------------------------------------------------------------------------------+\nRelacionado:\n+-------------------------------------------------------------------------------------+\n\nSystem Settings/SELinux AppArmor install requirement\nSystem Settings/SELinux type requirement\nSystem Settings/SELinux mode per domain",
        "copia": null,
        "editar": null,
        "refrescar": null,
        "evidencia": null,
        "SO": "Linux"
    },
    {
        "modulo": "Encryption/Deny Ciphers",
        "clave": "DENY",
        "descripcion": "Cipher cast128-cbc should not be used\nCipher 3des-cbc should not be used",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Para corregir estos desvios\n## Se debe quitar los ciphers `cast128`, `3des`\n\n## Por lo normal estas definidos por defecto, relacionado con el modulo:\n+-------------------------------------------------------------------------------------+\n\nEncryption/Permitted Ciphers\n\n+-------------------------------------------------------------------------------------+\n## Muestra el valor por defecto\n+-------------------------------------------------------------------------------------+\n\n/usr/sbin/sshd -T|grep -i ciphers\n\n+-------------------------------------------------------------------------------------+\n## Valor definido en el servidor, no debe estar comentado(#), o no debe estar vació\n+-------------------------------------------------------------------------------------+\n\ncat /etc/ssh/sshd_config | grep -i ciphers",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n## LINUX\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/${user^^}/sshd_config_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/${user,,}/sshd_config_`date +%d%m%y_%T`\n\n\n## AIX\n+-------------------------------------------------------------------------------------+\n## Backup\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/$user/sshd_config_`date +%d%m%y_%T`",
        "editar": "+-------------------------------------------------------------------------------------+\n## Añadir mínimo estos 3 cifrados POR DELANTE, `Ciphers aes128-ctr,aes192-ctr,aes256-ctr`\n## Si existen otros cifrados dejarlos, debe estar debajo de: \n## Ciphers and keying\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Debe quedar algo asi:\n\nCiphers aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com,chacha20-poly1305@openssh.com\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Editar\n+-------------------------------------------------------------------------------------+\n\nvi /etc/ssh/sshd_config",
        "refrescar": "+-------------------------------------------------------------------------------------+\n## LINUX\n+-------------------------------------------------------------------------------------+\n\nsystemctl stop sshd\nsystemctl start sshd\n\n+-------------------------------------------------------------------------------------+\n## AIX\n+-------------------------------------------------------------------------------------+\n\nstopsrc -s sshd;sleep 2;startsrc -s sshd",
        "evidencia": "+-------------------------------------------------------------------------------------+\n## LINUX / AIX\n+-------------------------------------------------------------------------------------+\nclear\ndate\nhostname\n/usr/sbin/sshd -T|grep -i ciphers\ncat /etc/ssh/sshd_config | grep -i ciphers\nsystemctl status sshd",
        "SO": "Linux / Aix"
    },
    {
        "modulo": "Protecting Resources-OSRs/OSR /VAR Files Restrictions",
        "clave": "OSRVAR",
        "descripcion": "Invalid permissions for $fileVAR  Octal permissions: 0777  Text Permissions: -rwxrwxrwx;  May not have execute permissions on any files and no write for others.",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Aplica a ficheros del directorio /VAR\n+-------------------------------------------------------------------------------------+\n\n## El desvio trata de quitarle escritura a OTHER, a ficheros que tienen escritura y ejecucion que cuelgan en el directorio /VAR y sub-directorios.\n\n+-------------------------------------------------------------------------------------+\n## Hay que tener en cuenta el tipo de owner que pertenece, cada fichero o directorio BASE.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Ya sea de tipo '/C/F/S/'\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es /C/, se pasa a excepcion con RISK e IMPACT\n(Por favor revisar la seccion de RISK e IMPACT)\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es de tipo /F/S/, se debe preguntar al owner, si podemos modificar los permisos\n## Revisar ('PERMISSIONS'), antes de cualquier cambio.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Buscar y comprobar los fichero a cambiar permisos.\n+-------------------------------------------------------------------------------------+\n\n## FICHEROS FORMA RECURVISA:\n---\necho \"ficheros con permisos w en other : \";find $fileVAR -type f -perm -o=wx | wc -l\nfind $fileVAR -type f -perm -o=wx | xargs -l ls -l\n\n## FICHERO\n---\nls -l $fichero\n\n+-------------------------------------------------------------------------------------+\n## Pregunta RELACIONADAS\n+-------------------------------------------------------------------------------------+\n\nProtecting Resources-mixed/Ensure sticky bit is set on all world-writable directories",        "copia": null,
        "editar": "+-------------------------------------------------------------------------------------+\n## Se puede quitar de forma 'RECURSIVA' o por 'INDIVIDUAL'\n\n## VARIABLES:\n## $fileVAR : es la variable del directorio base de los ficheros a cambiar permisos.\n## $fichero : es la variable, del fichero a cambiar permiso.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Asi quitamos de permisos de W a Other, en los ficheros('RECURSIVO'):\n+-------------------------------------------------------------------------------------+\n\nfind $fileVAR -type f -perm -o=wx -exec chmod o-w {} \\;\n\n+-------------------------------------------------------------------------------------+\n## Asi quitamos permisos, de W a other de forma('INDIVIDUAL'):\n+-------------------------------------------------------------------------------------+\n\nchmod o-w $fichero",        
        "refrescar": null,
        "evidencia": "+-------------------------------------------------------------------------------------+\n## De forma ('RECURSIVA'):\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nfind $fileVAR -type f -perm -o=wx | wc -l\nls -ld $fileVAR\n\n+-------------------------------------------------------------------------------------+\n## De forma('INDIVIDUAL'):\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -l $fichero",        "SO": "Linux"
    },
    {
        "modulo": "Protecting Resources-OSRs/OSR /TMP Files Restrictions",
        "clave": "OSRTMP",
        "descripcion": "Invalid permissions for $fileTMP  Octal permissions: 0777  Text Permissions: -rwxrwxrwx-;  May not have execute permissions on any files and no write for others.",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Aplica a ficheros del directorio /TMP\n+-------------------------------------------------------------------------------------+\n\n## 2-DOC, ya que no sabemos el alcance de el fallo que pueda afectar, el quitarle permisos a ficheros e directorios dentro de /tmp/\n\n## GENERICO / OSR TMP / FT",
        "copia": null,
        "editar": null,
        "refrescar": null,
        "evidencia": null,
        "SO": "Linux / Aix"
    },
    {
        "modulo": "Protecting Resources-OSRs/OSR /OPT Files Restrictions",
        "clave": "OSROPT",
        "descripcion": "Invalid permissions for $fileOPT, Octal permissions: 0777, Text Permissions: -rwxrwxrwx;  May not have execute permissions on any files and no write for others.",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Aplica a ficheros del directorio /OPT\n+-------------------------------------------------------------------------------------+\n\n## El desvio trata de quitarle escritura a OTHER, a ficheros que tienen escritura y ejecucion que cuelgan en el directorio /OPT y sub-directorios.\n\n+-------------------------------------------------------------------------------------+\n## Hay que tener en cuenta el tipo de owner que pertenece, cada fichero o directorio BASE.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Ya sea de tipo '/C/F/S/'\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es /C/, se pasa a excepcion con RISK e IMPACT\n(Por favor revisar la seccion de RISK e IMPACT)\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es de tipo /F/S/, se debe preguntar al owner, si podemos modificar los permisos\n## Revisar ('PERMISSIONS'), antes de cualquier cambio.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Buscar y comprobar los fichero a cambiar permisos.\n+-------------------------------------------------------------------------------------+\n\n## FICHEROS FORMA RECURVISA:\n---\necho \"ficheros con permisos w en other : \";find $fileOPT -type f -perm -o=wx | wc -l\nfind $fileOPT -type f -perm -o=wx | xargs -l ls -l\n\n## FICHERO\n---\nls -l $fichero\n\n+-------------------------------------------------------------------------------------+\n## Pregunta RELACIONADAS\n+-------------------------------------------------------------------------------------+\n\nProtecting Resources-mixed/Ensure sticky bit is set on all world-writable directories",
        "copia": null,
        "editar": "+-------------------------------------------------------------------------------------+\n## Se puede quitar de forma 'RECURSIVA' o por 'INDIVIDUAL'\n\n## VARIABLES:\n## $fileOPT : es la variable del directorio base de los ficheros a cambiar permisos.\n## $fichero : es la variable, del fichero a cambiar permiso.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Asi quitamos de permisos de W a Other, en los ficheros('RECURSIVO'):\n+-------------------------------------------------------------------------------------+\n\nfind $fileOPT -type f -perm -o=wx -exec chmod o-w {} \\;\n\n+-------------------------------------------------------------------------------------+\n## Asi quitamos permisos, de W a other de forma('INDIVIDUAL'):\n+-------------------------------------------------------------------------------------+\n\nchmod o-w $fichero",
        "refrescar": null,
        "evidencia": "+-------------------------------------------------------------------------------------+\n## De forma ('RECURSIVA'):\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nfind $fileOPT -type f -perm -o=wx | wc -l\nls -ld $fileOPT\n\n+-------------------------------------------------------------------------------------+\n## De forma('INDIVIDUAL'):\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -l $fichero",
        "SO": "Aix"
    },
    {
        "modulo": "Protecting Resources-OSRs/OSR /ETC Restrictions",
        "clave": "OSRETC",
        "descripcion": "OSR Invalid Owner or Group: directoryETC / directoryETC  Owner: ??  Group: ??  Permissions: -rwxr-xr-x  Settings for other must be r-x or more stringent. Must be owned by privileged Owner and Group",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Aplica a ficheros/directorios, sub-directorios, del directorio /ETC\n+-------------------------------------------------------------------------------------+\n\n## El desvio tarta de quitarle W a OTHER, ademas de comprobar que el owner y el grupo sean privilegiados(seccion 5.0) \n\n+-------------------------------------------------------------------------------------+\n## Hay que tener en cuenta el tipo de owner que pertenece, cada fichero o directorio BASE.\n\n## Ya sea de tipo '/C/F/S'\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es /C/, se pasa a excepcion con RISK e IMPACT\n(por favor revisar la seccion de RISK e IMPACT)\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es de tipo /F/S/, se debe preguntar al ownern de la cuenta, si podemos modificar los permisos\n## Revisar ('PERMISSIONS'), antes de cualquier cambio.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Buscar y comprobar los fichero y directorios a cambiar permisos. \n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## DIRECTORIOS / FICHEROS FORMA RECURVISA con permisos W en OTHER:\n+-------------------------------------------------------------------------------------+\n---\n\n## Busca y muestra el total de directorios:\necho \"directorios con permisos de w en OTHER: \";find $directoryETC -type d -perm -o=w | wc -l\n\n##Busca y enlista los directorios:\nfind $directory -type d -perm -o=w| xargs -l ls -ld\n\n##Busca y muestra el total de los ficheros:\necho \"ficheros con permisos de w en OTHER: \";find $directoryETC -type f -perm -o=w | wc -l\n\n##Busca y enlista los ficheros:\nfind $directoryETC -type f -perm -o=w| xargs -l ls -ld\n\n+-------------------------------------------------------------------------------------+\n## DIRECTORIOS / FICHEROS FORMA INDIVIDUAL:\n+-------------------------------------------------------------------------------------+\n---\n\nls -l $fileETC\nls -ld $directoryETC\n\n+-------------------------------------------------------------------------------------+\n## Pregunta RELACIONADAS\n+-------------------------------------------------------------------------------------+\n\nProtecting Resources-mixed/Ensure sticky bit is set on all world-writable directories",
        "copia": null,
        "editar": "+-------------------------------------------------------------------------------------+\n## Se puede cambiar permisos W en OTHER de forma 'RECURSIVA' o por 'INDIVIDUAL'\n\n## VARIABLES\n## $directoryETC : es la variable del directorio BASE a cambiar permisos en directorios / ficheros (RECURSIVO).\n## $fileETC : es la variable del fichero a cambiar permiso (INDIVIDUAL).\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Asi cambiamos permisos de W a OTHER, en los directorios/ficheros ('RECURSIVO'):\n+-------------------------------------------------------------------------------------+\n\n## DIRECTORIOS:\n---\n\nfind $directoryETC -type d -perm -o=w -exec chmod o-w {} \\;\n\n## FICHEROS:\n---\n\nfind $directoryETC -type f -perm -o=w -exec chmod o-w {} \\;\n\n+-------------------------------------------------------------------------------------+\n## Asi cambiamos permisos de W a OTHER, de forma('INDIVIDUAL'):\n+-------------------------------------------------------------------------------------+\n\nchmod o-w $fileETC\n\n+-------------------------------------------------------------------------------------+\n## Para cambiar cambiar a usuarios y grupo privilegiados, se debe saber a que grupo y usuario se debe cambiar.\n+-------------------------------------------------------------------------------------+",
        "refrescar": null,
        "evidencia": "+-------------------------------------------------------------------------------------+\n## RECURSIVO\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nfind $directoryETC -type d -perm -o=w | wc -l\nfind $directoryETC -type f -perm -o=w | wc -l\nls -ld $directoryETC\n\n+-------------------------------------------------------------------------------------+\n## INDIVIDUAL\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -la $fileETC\n",
        "SO": "Linux"
    },
    {
        "modulo": "Protecting Resources-OSRs/OSR /USR Restrictions",
        "clave": "OSRUSR",
        "descripcion": "OSR Invalid Owner or Group: directoryUSR / fileUSR  Owner: ??  Group: ??  Permissions: -rwxr-xr-x  Settings for other must be r-x or more stringent. Must be owned by privileged Owner and Group",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Aplica a ficheros/directorios, sub-directorios, del directorio /USR\n+-------------------------------------------------------------------------------------+\n\n## El desvio trata de cambiar el owner y el grupo, a ficheros / directorios que cuelgan en el directorio /USR y sub-directorios.\n## Ademas de quitarle, permisos de escritura a other, a ficheros / directorios, sub-directorios, si existen.\n\n+-------------------------------------------------------------------------------------+\n## Hay que tener en cuenta el tipo de owner que pertenece, cada fichero o directorio BASE.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Ya sea de tipo '/C/F/S'\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es /C/, se pasa a excepcion con RISK e IMPACT\n## por favor revisar la seccion de RISK e IMPACT\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es de tipo /F/S/, se debe preguntar al owner, si podemos modificar los permisos\n## Revisar ('PERMISSIONS'), antes de cualquier cambio.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Buscar y comprobar los fichero y directorios a cambiar permisos. \n+-------------------------------------------------------------------------------------+\n\n## DIRECTORIOS / FICHEROS FORMA RECURVISA:\n---\necho \"directorios / ficheros con owner o grupo no compliance: \";find $directory -user $usuario -or -group $grupo | wc -l\nfind $directory -user $usuario -or -group $grupo | xargs -l ls -ld\n\n## DIRECTORIOS / FICHEROS FORMA INDIVIDUAL:\n---\nls -l $directory\nls -ld $directory\n\n+-------------------------------------------------------------------------------------+\n## Pregunta RELACIONADAS\n+-------------------------------------------------------------------------------------+\n\nProtecting Resources-mixed/Ensure sticky bit is set on all world-writable directories",
        "copia": null,
        "editar": "+-------------------------------------------------------------------------------------+\n## Se puede cambiar el owner y el grupo de forma 'RECURSIVA' o por 'INDIVIDUAL'\n## $directory : es la variable del directorio BASE a cambiar permisos.\n## $fileTMP : es la variable del fichero a cambiar owner y group o directorio de los ficheros.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Es cambiar de owner y grupo a grupos y usuarios privilegiados y darles permisos de lectura,ejecucion a other/grupo\n## Asi cambiamos el owner y el group, en los directorios/ficheros ('RECURSIVO'):\n## Nota : pide confirmacion ('yes' or 'no').\n+-------------------------------------------------------------------------------------+\n\nfind $directory -user $usuario -ok chown root:root {} \\; -exec chmod 755 {} \\;\nfind $directory -group $grupo -ok chown root:root {} \\; -exec chmod 755 {} \\;\n\n+-------------------------------------------------------------------------------------+\n## Asi cambiamos el owner y el group, de forma('individual'):\n+-------------------------------------------------------------------------------------+\n\nchown root:root $directory;chmod 755 $directory\nchown root:root $fileUSR;chmod 755 $fileUSR",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\nls -ld $directory\nls -l $directory",
        "SO": "Linux"
    },
    {
        "modulo": "Protecting Resources-OSRs/OSR /etc/crontab Restrictions",
        "clave": "OSRCRONTAB",
        "descripcion": "/etc/crontab  Owner: root  Group: root  Permissions: -rw-r--r--.  should have \"rw- --- ---\" permissions (or more restrictive). Must be owned by user and group \"root\"",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Se cambian los permisos a : 600\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Pregunta relacionadas :\n+-------------------------------------------------------------------------------------+\n\nProtecting Resources-OSRs/OSR /etc/crontab Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.hourly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.daily Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.weekly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.monthly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.d Restrictions\n",
        "copia": null,
        "editar": "chmod 600 /etc/crontab\n\n+-------------------------------------------------------------------------------------+\n## Editar todas la relaciones\n+-------------------------------------------------------------------------------------+\n\nchmod 600 /etc/crontab\nchmod 600 /etc/cron.hourly \nchmod 600 /etc/cron.daily \nchmod 600 /etc/cron.weekly \nchmod 600 /etc/cron.monthly \nchmod 600 /etc/cron.d",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\nls -ld /etc/crontab\n\n+-------------------------------------------------------------------------------------+\n## Evidencia de todas las relaciones\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -ld /etc/crontab\nls -ld /etc/cron.hourly \nls -ld /etc/cron.daily \nls -ld /etc/cron.weekly \nls -ld /etc/cron.monthly \nls -ld /etc/cron.d",
        "SO": "Linux"
    },
    {
        "modulo": "Protecting Resources-OSRs/OSR /etc/cron.hourly Restrictions",
        "clave": "OSRHOURLY",
        "descripcion": "/etc/cron.hourly  Owner: root  Group: root  Permissions: drwxr-xr-x.  should have \"rwx --- ---\" permissions (or more restrictive). Must be owned by user and group \"root\"",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Se cambian los permisos a : 600\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Pregunta relacionadas :\n+-------------------------------------------------------------------------------------+\n\nProtecting Resources-OSRs/OSR /etc/crontab Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.hourly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.daily Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.weekly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.monthly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.d Restrictions\n",
        "copia": null,
        "editar": "chmod 600 /etc/cron.hourly\n\n+-------------------------------------------------------------------------------------+\n## Editar todas la relaciones\n+-------------------------------------------------------------------------------------+\n\nchmod 600 /etc/crontab\nchmod 600 /etc/cron.hourly \nchmod 600 /etc/cron.daily \nchmod 600 /etc/cron.weekly \nchmod 600 /etc/cron.monthly \nchmod 600 /etc/cron.d",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\nls -ld /etc/cron.hourly\n\n+-------------------------------------------------------------------------------------+\n## Evidencia de todas las relaciones\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -ld /etc/crontab\nls -ld /etc/cron.hourly \nls -ld /etc/cron.daily \nls -ld /etc/cron.weekly \nls -ld /etc/cron.monthly \nls -ld /etc/cron.d",
        "SO": "Linux"
    },
    {
        "modulo": "Protecting Resources-OSRs/OSR /etc/cron.daily Restrictions",
        "clave": "OSRDAILY",
        "descripcion": "/etc/cron.daily  Owner: root  Group: root  Permissions: drwxr-xr-x.  should have \"rwx --- ---\" permissions (or more restrictive). Must be owned by user and group \"root\"",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Se cambian los permisos a : 600\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Pregunta relacionadas :\n+-------------------------------------------------------------------------------------+\n\nProtecting Resources-OSRs/OSR /etc/crontab Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.hourly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.daily Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.weekly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.monthly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.d Restrictions\n",
        "copia": null,
        "editar": "chmod 600 /etc/cron.daily\n\n+-------------------------------------------------------------------------------------+\n## Editar todas la relaciones\n+-------------------------------------------------------------------------------------+\n\nchmod 600 /etc/crontab\nchmod 600 /etc/cron.hourly \nchmod 600 /etc/cron.daily \nchmod 600 /etc/cron.weekly \nchmod 600 /etc/cron.monthly \nchmod 600 /etc/cron.d",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\nls -ld /etc/cron.daily\n\n+-------------------------------------------------------------------------------------+\n## Evidencia de todas las relaciones\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -ld /etc/crontab\nls -ld /etc/cron.hourly \nls -ld /etc/cron.daily \nls -ld /etc/cron.weekly \nls -ld /etc/cron.monthly \nls -ld /etc/cron.d",
        "SO": "Linux"
    },
    {
        "modulo": "Protecting Resources-OSRs/OSR /etc/cron.weekly Restrictions",
        "clave": "OSRWEEKLY",
        "descripcion": "/etc/cron.weekly  Owner: root  Group: root  Permissions: drwxr-xr-x.  should have \"rwx --- ---\" permissions (or more restrictive). Must be owned by user and group \"root\"",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Se cambian los permisos a : 600\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Pregunta relacionadas :\n+-------------------------------------------------------------------------------------+\n\nProtecting Resources-OSRs/OSR /etc/crontab Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.hourly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.daily Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.weekly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.monthly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.d Restrictions\n",
        "copia": null,
        "editar": "chmod 600 /etc/cron.weekly\n\n+-------------------------------------------------------------------------------------+\n## Editar todas la relaciones\n+-------------------------------------------------------------------------------------+\n\nchmod 600 /etc/crontab\nchmod 600 /etc/cron.hourly \nchmod 600 /etc/cron.daily \nchmod 600 /etc/cron.weekly \nchmod 600 /etc/cron.monthly \nchmod 600 /etc/cron.d",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\nls -ld /etc/cron.weekly\n\n+-------------------------------------------------------------------------------------+\n## Evidencia de todas las relaciones\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -ld /etc/crontab\nls -ld /etc/cron.hourly \nls -ld /etc/cron.daily \nls -ld /etc/cron.weekly \nls -ld /etc/cron.monthly \nls -ld /etc/cron.d",
        "SO": "Linux"
    },
    {
        "modulo": "Protecting Resources-OSRs/OSR /etc/cron.monthly Restrictions",
        "clave": "OSRMONTHLY",
        "descripcion": "/etc/cron.monthly  Owner: root  Group: root  Permissions: drwxr-xr-x.  should have \"rwx --- ---\" permissions (or more restrictive). Must be owned by user and group \"root\"",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Se cambian los permisos a : 600\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Pregunta relacionadas :\n+-------------------------------------------------------------------------------------+\n\nProtecting Resources-OSRs/OSR /etc/crontab Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.hourly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.daily Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.weekly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.monthly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.d Restrictions\n",
        "copia": null,
        "editar": "chmod 600 /etc/cron.monthly\n\n+-------------------------------------------------------------------------------------+\n## Editar todas la relaciones\n+-------------------------------------------------------------------------------------+\n\nchmod 600 /etc/crontab\nchmod 600 /etc/cron.hourly \nchmod 600 /etc/cron.daily \nchmod 600 /etc/cron.weekly \nchmod 600 /etc/cron.monthly \nchmod 600 /etc/cron.d",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\nls -ld /etc/cron.monthly\n\n+-------------------------------------------------------------------------------------+\n## Evidencia de todas las relaciones\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -ld /etc/crontab\nls -ld /etc/cron.hourly \nls -ld /etc/cron.daily \nls -ld /etc/cron.weekly \nls -ld /etc/cron.monthly \nls -ld /etc/cron.d",
        "SO": "Linux"
    },
    {
        "modulo": "Protecting Resources-OSRs/OSR /etc/cron.d Restrictions",
        "clave": "OSRCRON.D",
        "descripcion": "/etc/cron.d  Owner: root  Group: root  Permissions: drwxr-xr-x.  should have \"rwx --- ---\" permissions (or more restrictive). Must be owned by user and group \"root\"",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Se cambian los permisos a : 600\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Pregunta relacionadas :\n+-------------------------------------------------------------------------------------+\n\nProtecting Resources-OSRs/OSR /etc/crontab Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.hourly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.daily Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.weekly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.monthly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.d Restrictions\n",
        "copia": null,
        "editar": "chmod 600 /etc/cron.d\n\n+-------------------------------------------------------------------------------------+\n## Editar todas la relaciones\n+-------------------------------------------------------------------------------------+\n\nchmod 600 /etc/crontab\nchmod 600 /etc/cron.hourly \nchmod 600 /etc/cron.daily \nchmod 600 /etc/cron.weekly \nchmod 600 /etc/cron.monthly \nchmod 600 /etc/cron.d",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\nls -ld /etc/cron.d\n\n+-------------------------------------------------------------------------------------+\n## Evidencia de todas las relaciones\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -ld /etc/crontab\nls -ld /etc/cron.hourly \nls -ld /etc/cron.daily \nls -ld /etc/cron.weekly \nls -ld /etc/cron.monthly \nls -ld /etc/cron.d",
        "SO": "Linux"
    },
    {
        "modulo": "AD.1.9.1.3 Protecting Resources - User Resources",
        "clave": "UMASK IBMSINIT.SH",
        "descripcion": "File /etc/profile.d/IBMsinit.sh must exist, be readable by all users, and contain at least:\nif [ $UID -gt 199 ]; then\numask 077\nfi",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Debe existir y con permisos 755 :\n+-------------------------------------------------------------------------------------+\n\nls -la /etc/profile.d/IBMsinit.sh\n\n+-------------------------------------------------------------------------------------+\n## Debe debe tener el script de UMASK:\n\nif [ $UID -gt 199 ]; then\numask 077\nfi\n\n+-------------------------------------------------------------------------------------+\n\ncat /etc/profile.d/IBMsinit.sh\n\n+-------------------------------------------------------------------------------------+\n## Debe tener implementado la invocacion a la llamada del fichero.\n. /etc/profile.d/IBMsinit.sh\n+-------------------------------------------------------------------------------------+\n\ncat /etc/profile | grep -i \"IBMsinit.sh\"",        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/profile.d/IBMsinit.sh /home/${user^^}/IBMsinit.sh_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/profile.d/IBMsinit.sh /home/${user,,}/IBMsinit.sh_`date +%d%m%y_%T`",
        "editar": "+-------------------------------------------------------------------------------------+\n## Creamos fichero y asignamos los permisos correctos.\n+-------------------------------------------------------------------------------------+\n\ntouch /etc/profile.d/IBMsinit.sh\nchmod 0755 /etc/profile.d/IBMsinit.sh\n\n+-------------------------------------------------------------------------------------+\n## Editar y añadir el siguiente SCRIPT:\n+-------------------------------------------------------------------------------------+\n\nvi /etc/profile.d/IBMsinit.sh\n\n#--------- begin IBMsinit.sh --------#\nif [ $UID -gt 199 ]; then\numask 077\nfi\n#--------- end IBMsinit.sh  ---------#\n\n+-------------------------------------------------------------------------------------+\n## Ademas debemos implementar la invocacion a la llamada del fichero.\n## La invocacion se implementa despues de un script de UMASK.\n+-------------------------------------------------------------------------------------+\n\nvi /etc/profile\n\n. /etc/profile.d/IBMsinit.sh",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\ncat /etc/profile.d/IBMsinit.sh\ncat /etc/profile  | grep -i  IBMsinit.sh\nls -l /etc/profile.d/IBMsinit.sh",
        "SO": "Linux"
    },
    {
        "modulo": "AD.1.9.1.4 Protecting Resources - User Resources",
        "clave": "UMASK IBMSINIT.CSH",
        "descripcion": "File /etc/profile.d/IBMsinit.csh must exist, be readable by all users, and contain at least:\nif ($uid > 199) then\n    umask 077\nendif",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Debe existir y con permisos 755 :\n+-------------------------------------------------------------------------------------+\n\nls -la /etc/profile.d/IBMsinit.csh\n\n+-------------------------------------------------------------------------------------+\n## Debe debe tener el script de UMASK:\n\nif ($uid > 199) then\n    umask 077\nendif\n\n+-------------------------------------------------------------------------------------+\n\ncat /etc/profile.d/IBMsinit.csh\n\n+-------------------------------------------------------------------------------------+\n## Debe tener implementado la invocacion a la llamada del fichero.\nsource /etc/profile.d/IBMsinit.csh\n+-------------------------------------------------------------------------------------+\n\ncat /etc/csh.login | grep -i \"IBMsinit.csh\"",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/profile.d/IBMsinit.csh /home/${user^^}/IBMsinit.csh_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/profile.d/IBMsinit.csh /home/${user,,}/IBMsinit.csh_`date +%d%m%y_%T`\n",
        "editar": "+-------------------------------------------------------------------------------------+\n## Creamos fichero y asignamos los permisos correctos.\n+-------------------------------------------------------------------------------------+\n\ntouch /etc/profile.d/IBMsinit.csh\nchmod 0755 /etc/profile.d/IBMsinit.csh\n\n+-------------------------------------------------------------------------------------+\n## Editar y añadir el siguiente SCRIPT:\n+-------------------------------------------------------------------------------------+\n\nvi /etc/profile.d/IBMsinit.csh\n\n#--------- end IBMsinit.csh  ---------#\nif ($uid > 199) then\n    umask 077\nendif\n#--------- end IBMsinit.csh  ---------#\n\n+-------------------------------------------------------------------------------------+\n## Ademas debemos implementar la invocacion a la llamada del fichero.\n## La invocacion se implementa en la ultima linea.\n+-------------------------------------------------------------------------------------+\n\nvi  /etc/csh.login\n\nsource /etc/profile.d/IBMsinit.csh",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\ncat /etc/profile.d/IBMsinit.csh\ncat /etc/csh.login  | grep -i  IBMsinit.csh\nls -l /etc/profile.d/IBMsinit.csh",
        "SO": "Linux"
    },
    {
        "modulo": "Protecting Resources-User Resources//etc/profile File Restriction",
        "clave": "INVOCATION.SH",
        "descripcion": "File does not  trigger an invocation of line . /etc/profile.d/IBMsinit.sh",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Debe existir la llamada a IBMsinit.sh, en /etc/profile\n+-------------------------------------------------------------------------------------+\n\ncat /etc/profile | grep -i IBMsinit.sh -B 5\n\n+-------------------------------------------------------------------------------------+\n## Relacionado con :\n+-------------------------------------------------------------------------------------+\n\nAD.1.9.1.3 Protecting Resources - User Resources\nAD.1.9.1.4 Protecting Resources - User Resources\nProtecting Resources-OSRs/IBMsinit Permission Restriction",
        "copia": null,
        "editar": "+-------------------------------------------------------------------------------------+\n## Añadir la linea : . /etc/profile.d/IBMsinit.sh\n## Despues de un script UMASK\n+-------------------------------------------------------------------------------------+\n\nvi /etc/profile\n\n. /etc/profile.d/IBMsinit.sh",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\ncat /etc/profile | grep -i IBMsinit.sh -B 5",
        "SO": "Linux"
    },
    {
        "modulo": "Password Requirements/Password change date in the past",
        "clave": "",
        "descripcion": "",
        "comprobacion": null,
        "copia": null,
        "editar": null,
        "refrescar": null,
        "evidencia": null,
        "SO": "Linux"
    },
    {
        "modulo": "Password Requirements/Requirement for pwd_algorithm",
        "clave": "PWD_ALGORITHM",
        "descripcion": "Incorrect or missing value of \"pwd_algorithm\" in /etc/security/login.cfg. It Must be set to ssha512",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Cambiar el algoritmo a ssha512 en /etc/security/login.cfg\n+-------------------------------------------------------------------------------------+\n\nlssec -f /etc/security/login.cfg -s usw -a pwd_algorithm",
        "copia": null,
        "editar": "chsec -f /etc/security/login.cfg -s usw -a pwd_algorithm=ssha512",
        "refrescar": null,
        "evidencia": "clear\ndate\nuname -a\nlssec -f /etc/security/login.cfg -s usw -a pwd_algorithm",
        "SO": "Aix"
    },
    {
        "modulo": "E.1.1.6.1 Password Requirements",
        "clave": "PWD_ALGORITHM",
        "descripcion": "Incorrect or missing value of \"pwd_algorithm\" in /etc/security/login.cfg. It Must be set to ssha512",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Cambiar el algoritmo a ssha512 en /etc/security/login.cfg\n+-------------------------------------------------------------------------------------+\n\nlssec -f /etc/security/login.cfg -s usw -a pwd_algorithm",
        "copia": null,
        "editar": "chsec -f /etc/security/login.cfg -s usw -a pwd_algorithm=ssha512",
        "refrescar": null,
        "evidencia": "clear\ndate\nuname -a\nlssec -f /etc/security/login.cfg -s usw -a pwd_algorithm",
        "SO": "Aix"
    },
    {
        "modulo": "Password Requirements/Password mindiff - System Default",
        "clave": "MINDIFF",
        "descripcion": "Invalid system default mindiff set to 1, must be not less than 4",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## El parametro mindiff, debe ser 4, por defecto y por usuario.\n## Una vez cambiado a default, se corrigen para las demas cuentas, puede quedar root o alguna cuenta sin cambiar, por lo que se puede cambiar manual.\n+-------------------------------------------------------------------------------------+\n\nlssec -f /etc/security/user -s default -a mindiff",
        "copia": null,
        "editar": "chsec -f /etc/security/user -s default -a mindiff=4\nchsec -f /etc/security/user -s root -a mindiff=4",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\nlssec -f /etc/security/user -s default -a mindiff\nlssec -f /etc/security/user -s root -a mindiff",
        "SO": "Aix"
    },
    {
        "modulo": "E.1.1.7.2 Password Requirements",
        "clave": "MINDIFF",
        "descripcion": "Invalid system default mindiff set to 1, must be not less than 4",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## El parametro mindiff, debe ser 4, por defecto y por usuario.\n## Una vez cambiado a default, se corrigen para las demas cuentas, puede quedar root o alguna cuenta sin cambiar, por lo que se puede cambiar manual.\n+-------------------------------------------------------------------------------------+\n\nlssec -f /etc/security/user -s default -a mindiff",
        "copia": null,
        "editar": "chsec -f /etc/security/user -s default -a mindiff=4\nchsec -f /etc/security/user -s root -a mindiff=4",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\nlssec -f /etc/security/user -s default -a mindiff\nlssec -f /etc/security/user -s root -a mindiff",
        "SO": "Aix"
    },
    {
        "modulo": "Password Requirements/Password MIN Length - System Default",
        "clave": "MINLENGTH",
        "descripcion": "Invalid Password Min Length setting of 8, should be not less than 15\nInvalid system ACCOUNTS Min Length",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## El parametro minlen, debe ser 15, por defecto y por usuario.\n## Una vez cambiado a default, se corrigen para las demas cuentas, puede quedar root o alguna cuenta sin cambiar, por lo que se puede cambiar manual.\n+-------------------------------------------------------------------------------------+\n\nlssec -f /etc/security/user -s default -a minlen",
        "copia": null,
        "editar": "chsec -f /etc/security/user -s default -a minlen=15\nchsec -f /etc/security/user -s root -a minlen=15",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\nlssec -f /etc/security/user -s default -a minlen\nlssec -f /etc/security/user -s root -a minlen",
        "SO": "Aix"
    },
    {
        "modulo": "Protecting Resources-User Resources/Login.defs umask restriction",
        "clave": "UMASK DEFAULT",
        "descripcion": "File /etc/login.defs include invalid umask setting 22. Should be set 077. More stringent value can be set.",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## El valor de umask por defecto en /etc/login.defs, debe ser 077\n+-------------------------------------------------------------------------------------+\n\ncat /etc/login.defs | grep -i 'umask'",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/login.defs /home/${user^^}/login.defs_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/login.defs /home/${user,,}/login.defs_`date +%d%m%y_%T`\n",
        "editar": "+-------------------------------------------------------------------------------------+\n## Editar / Añadir umask 077\n+-------------------------------------------------------------------------------------+\n\nvi /etc/login.defs",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\ncat /etc/login.defs | grep -i umask",
        "SO": "Linux"
    },
    {
        "modulo": "Identify and Authenticate Users/Public Key Authentication",
        "clave": "PUBLICKEY",
        "descripcion": "SSH authorized_keys file: $authorized_keys; Invalid public host key length: 1024   Key type: ssh-rsa.",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## En este tipo de desviaciones, las claves publicas(\"authorized_keys\")\n## Deben tener una clave superior a 1024 bit de longitud.\n## Antes de seguir, revisar -* AUTHORIZED_KEYS *-\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Revisamos si tiene una longitud superior a 1024 bit, debe ser 2048 bit.\n## Debe ser solo accesible al owner\n+-------------------------------------------------------------------------------------+\n\nls -la $file_authorized\ncat $file_authorized\n\n## PUEDEN EXISTIR 3 OPCIONES DIFERENTES:\n\n## --> OPCION 1\n+-------------------------------------------------------------------------------------+\n## Si el fichero authorized_keys es de root, no debe tener un fichero authorized_keys.\n## Pasamos directamente a renombrar el fichero authorized_keys para owner root.\n## ('SI HAY DUDAS, consultarlo con el tecnico')\n+-------------------------------------------------------------------------------------+\n\n## --> OPCION 2\n+-------------------------------------------------------------------------------------+\n## Si el fichero authorized_keys, pertenece a otro owner o grupo que no sea root.\n## Si es de TIPO /F/ o /S/ (sistemas / aplicativo)\n## se debe contactar con el owner o grupo del fichero.\n## - Si se va a excepcionar nos deben especificar un RISK e IMPACT.\n\n## - Si se va a corregir.\n## Revisar ('authorized_keys'), antes de cualquier cambio.\n\n## Si es de TIPO /C/ (customer)\n## - Se debe excepcionar.\n## Por favor revisar la sección de RISK e IMPACT.\n+-------------------------------------------------------------------------------------+\n\n## --> OPCION 3\n+-------------------------------------------------------------------------------------+\n## Si el fichero authorized_keys, pertenece a otro owner o grupo que no sea root.\n## SI es de tipo /E/. /I/./K/\n## - Si es una cuenta 'externa' y no existe en el servidor, se puede renombrar.\n## - Si la cuenta existe, se debe notificar al owner de la cuenta.\n\n## Se le debe notificar que se ha renombrado el fichero y que si lo utiliza debe,\n## Crear un fichero authorized_keys con una clave tipo rsa de 2048 bit. \n## Revisar ('AUTHORIZED_KEYS'), antes de cualquier cambio.\n+-------------------------------------------------------------------------------------+",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n## LINUX\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p $file_authorized /home/${user^^}/authorized_key_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p $file_authorized /home/${user,,}/authorized_key_`date +%d%m%y_%T`\n\n## AIX\n+-------------------------------------------------------------------------------------+\n## Backup\n+-------------------------------------------------------------------------------------+\ncp -p \"$file_authorized\" /home/$user/authorized_key_`date +%d%m%y_%T`",
        "editar": "## --> OPCION 1\n+-------------------------------------------------------------------------------------+\n## Para ficheros authorized_keys, con owner root.\n+-------------------------------------------------------------------------------------+\n\nmv /home/root/.ssh/authorized_keys /home/root/.ssh/authorized_keys.save\n\n\n## --> OPCION 2 y ## --> OPCION 3\n+-------------------------------------------------------------------------------------+\n## Para otros ficheros authorized_keys.\n## De tipo /F/S/ o sin owner o account externas/internas tipo /E/ o /I/\n+-------------------------------------------------------------------------------------+\n\nmv $file_authorized $file_authorized.save",
        "refrescar": null,
        "evidencia": "## --> OPCION 1\n+-------------------------------------------------------------------------------------+\n## Para ficheros authorized_keys, con owner root.\n+-------------------------------------------------------------------------------------+\nclear\ndate\nhostname\nls -la /home/root/.ssh/authorized_keys\n\n\n## --> OPCION 2 y ## --> OPCION 3\n+-------------------------------------------------------------------------------------+\n## Para otros ficheros authorized_keys.\n## De tipo /F/S/ o sin owner o account externas/internas tipo /E/ o /I/\n+-------------------------------------------------------------------------------------+\nclear\ndate\nhostname\nls -la $file_authorized\ncat $file_authorized",
        "SO": "Linux / Aix"
    },
    {
        "modulo": "Password Requirements/Private Key File Restriction",
        "clave": "AUTHORIZED_KEY",
        "descripcion": "SSH authorized_keys file: \"FICHERO AUTHORIZED KEYS\"; Invalid from section: . \"*º\" or \"*.*.*.*\" or \"0/0\" or \"0.0.0.0/0\" or empty are forbidden values in the \"from=\" parameter",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## En este tipo de desviaciones, las claves publicas (\"authorized_keys\")\n## Deben tener un FROM que especifique el host remoto o direccion IP.\n\n## Antes de seguir, revisar ('AUTHORIZED')\n+-------------------------------------------------------------------------------------+\n## Revisamos si tiene un FROM, que especifica el host remoto o IP\n## Debe ser solo accesible al owner\n+-------------------------------------------------------------------------------------+\n\nls -la $file_authorized\ncat $file_authorized\n\n## PUEDEN EXISTIR 3 OPCIONES DIFERENTES:\n\n## --> OPCION 1\n+-------------------------------------------------------------------------------------+\n## Si el fichero authorized_keys pertenece a la cuenta root, Root no debe tener un fichero authorized_keys.\n## Pasamos directamente a renombrar el fichero authorized_keys para el owner root.\n\n## ('SI HAY DUDAS, consultarlo con el tecnico')\n+-------------------------------------------------------------------------------------+\n\n## --> OPCION 2\n+-------------------------------------------------------------------------------------+\n## Si el fichero authorized_keys es de TIPO /F/ o /S/ (sistemas / aplicativo)\n## Se debe notificar al owner o grupo del fichero.\n\n## - Si se va a excepcionar nos deben especificar un RISK e IMPACT.\n\n## - Si se va a corregir (nos deben facilitar la IP o HOST).\n+-------------------------------------------------------------------------------------+\n## Si es de TIPO /C/ (customer)\n\n## - Se debe excepcionar.\n\n## Revisar RISK e IMPACT.\n+-------------------------------------------------------------------------------------+\n\n## --> OPCION 3\n+-------------------------------------------------------------------------------------+\n## Si el fichero authorized_keys, es de tipo /E/. /I/./K/\n\n## - Si es una cuenta 'externa' y no existe en el servidor, se puede renombrar el fichero authorized_key.\n\n## - Si la cuenta existe, se debe notificar al owner de la cuenta.\n+-------------------------------------------------------------------------------------+",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n## LINUX\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p $file_authorized /home/${user^^}/authorized_key_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p $file_authorized /home/${user,,}/authorized_key_`date +%d%m%y_%T`\n\n## AIX\n+-------------------------------------------------------------------------------------+\n## Backup\n+-------------------------------------------------------------------------------------+\n\ncp -p \"$file_authorized\" /home/$user/authorized_key_`date +%d%m%y_%T`\n",
        "editar": "## --> OPCION 1\n+-------------------------------------------------------------------------------------+\n## Para ficheros authorized_keys, con owner root.\n+-------------------------------------------------------------------------------------+\n\nmv /home/root/.ssh/authorized_keys /home/root/.ssh/authorized_keys.save\n\n\n## --> OPCION 2 y ## --> OPCION 3\n+-------------------------------------------------------------------------------------+\n## Para ficheros authorized_keys, de tipo /F/S/ o sin owner o account externas/internas de tipo /E/ o /I/.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Donde se tengan que renombar el fichero.\n+-------------------------------------------------------------------------------------+\n\nmv $file_authorized $file_authorized.save\n\n+-------------------------------------------------------------------------------------+\n## Donde se tenga que añadir un FROM.\n+-------------------------------------------------------------------------------------+\n\nvi $file_authorized\n\n+-------------------------------------------------------------------------------------+\n## Añadir la línea from=\"IP\", al inicio de cada clave shh-rsa:\n+-------------------------------------------------------------------------------------+\n## EJEMPLO\n\nfrom=\"129.39.41.5,129.39.41.6\" ssh-rsa AAAAB3NzaC1yc2EAAAABIw== !!CZ/S/*ABJ83/IBM/Automation ID!!\n",
        "refrescar": null,
        "evidencia": "## --> OPCION 1\n+-------------------------------------------------------------------------------------+\n## Para ficheros authorized_keys, con owner root.\n+-------------------------------------------------------------------------------------+\nclear\ndate\nhostname\nls -la /home/root/.ssh/authorized_keys\n\n\n## --> OPCION 2 y ## --> OPCION 3\n+-------------------------------------------------------------------------------------+\n## Para ficheros authorized_keys, de tipo /F/S/, sin owner o account externas/internas tipo /E/, /I/ /K/\n+-------------------------------------------------------------------------------------+\nclear\ndate\nhostname\nls -la $file_authorized\ncat $file_authorized",        
        "SO": "Linux"
    },
    {
        "modulo": "AV.1.1.6 Password Requirements",
        "clave": "",
        "descripcion": "## (MODULO RELACIONADO : AV.1.1.7 Password Requirements)\n\n## SSH authorized_keys file: \"FICHERO AUTHORIZED KEYS\"; Invalid from section: . \"*º\" or \"*.*.*.*\" or \"0/0\" or \"0.0.0.0/0\" or empty are forbidden values in the \"from=\" parameter",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## En este tipo de desviaciones, las claves publicas (\"authorized_keys\")\n## Deben tener un FROM que especifique el host remoto o direccion IP.\n\n## Antes de seguir, revisar ('AUTHORIZED')\n+-------------------------------------------------------------------------------------+\n## Revisamos si tiene un FROM, que especifica el host remoto o IP\n## Debe ser solo accesible al owner\n+-------------------------------------------------------------------------------------+\n\nls -la $file_authorized\ncat $file_authorized\n\n## PUEDEN EXISTIR 3 OPCIONES DIFERENTES:\n\n## --> OPCION 1\n+-------------------------------------------------------------------------------------+\n## Si el fichero authorized_keys pertenece a la cuenta root, Root no debe tener un fichero authorized_keys.\n## Pasamos directamente a renombrar el fichero authorized_keys para el owner root.\n\n## ('SI HAY DUDAS, consultarlo con el tecnico')\n+-------------------------------------------------------------------------------------+\n\n## --> OPCION 2\n+-------------------------------------------------------------------------------------+\n## Si el fichero authorized_keys es de TIPO /F/ o /S/ (sistemas / aplicativo)\n## Se debe notificar al owner o grupo del fichero.\n\n## - Si se va a excepcionar nos deben especificar un RISK e IMPACT.\n\n## - Si se va a corregir (nos deben facilitar la IP o HOST).\n+-------------------------------------------------------------------------------------+\n## Si es de TIPO /C/ (customer)\n\n## - Se debe excepcionar.\n\n## Revisar RISK e IMPACT.\n+-------------------------------------------------------------------------------------+\n\n## --> OPCION 3\n+-------------------------------------------------------------------------------------+\n## Si el fichero authorized_keys, es de tipo /E/. /I/./K/\n\n## - Si es una cuenta 'externa' y no existe en el servidor, se puede renombrar el fichero authorized_key.\n\n## - Si la cuenta existe, se debe notificar al owner de la cuenta.\n+-------------------------------------------------------------------------------------+",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n## LINUX\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p $file_authorized /home/${user^^}/authorized_key_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p $file_authorized /home/${user,,}/authorized_key_`date +%d%m%y_%T`\n\n## AIX\n+-------------------------------------------------------------------------------------+\n## Backup\n+-------------------------------------------------------------------------------------+\n\ncp -p \"$file_authorized\" /home/$user/authorized_key_`date +%d%m%y_%T`\n",
        "editar": "## --> OPCION 1\n+-------------------------------------------------------------------------------------+\n## Para ficheros authorized_keys, con owner root.\n+-------------------------------------------------------------------------------------+\n\nmv /home/root/.ssh/authorized_keys /home/root/.ssh/authorized_keys.save\n\n\n## --> OPCION 2 y ## --> OPCION 3\n+-------------------------------------------------------------------------------------+\n## Para ficheros authorized_keys, de tipo /F/S/ o sin owner o account externas/internas de tipo /E/ o /I/.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Donde se tengan que renombar el fichero.\n+-------------------------------------------------------------------------------------+\n\nmv $file_authorized $file_authorized.save\n\n+-------------------------------------------------------------------------------------+\n## Donde se tenga que añadir un FROM.\n+-------------------------------------------------------------------------------------+\n\nvi $file_authorized\n\n+-------------------------------------------------------------------------------------+\n## Añadir la línea from=\"IP\", al inicio de cada clave shh-rsa:\n+-------------------------------------------------------------------------------------+\n## EJEMPLO\n\nfrom=\"129.39.41.5,129.39.41.6\" ssh-rsa AAAAB3NzaC1yc2EAAAABIw== !!CZ/S/*ABJ83/IBM/Automation ID!!\n",
        "refrescar": null,
        "evidencia": "## --> OPCION 1\n+-------------------------------------------------------------------------------------+\n## Para ficheros authorized_keys, con owner root.\n+-------------------------------------------------------------------------------------+\nclear\ndate\nhostname\nls -la /home/root/.ssh/authorized_keys\n\n\n## --> OPCION 2 y ## --> OPCION 3\n+-------------------------------------------------------------------------------------+\n## Para ficheros authorized_keys, de tipo /F/S/, sin owner o account externas/internas tipo /E/, /I/ /K/\n+-------------------------------------------------------------------------------------+\nclear\ndate\nhostname\nls -la $file_authorized\ncat $file_authorized",        
        "SO": "Linux / Aix"
    },
    {
        "modulo": "Identify and Authenticate Users/Public Key Label",
        "clave": "LABEL",
        "descripcion": "SSH authorized_keys file: $file_authorized; Some of the keys have no identifying label",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## En este tipo de desviaciones, las claves publicas(\"authorized_keys\")\n## Deben tener un LABEL que que indetifique a quien pertenece la clave publica\n## Antes de seguir, revisar -* AUTHORIZED_KEYS *-\n\n+-------------------------------------------------------------------------------------+\n## Revisamos si tiene un LABEL que es el GECOS, al final de cada clave `ssh-rsa` y este entre !! y !!\n## El fichero debe ser solo accesible al owner\n+-------------------------------------------------------------------------------------+\n\nls -la $file_authorized\ncat $file_authorized\n\n## PUEDEN EXISTIR 3 OPCIONES DIFERENTES:\n\n## --> OPCION 1\n+-------------------------------------------------------------------------------------+\n## Si el fichero authorized_keys es de root, no debe tener un fichero authorized_keys.\n## Pasamos directamente a renombrar el fichero authorized_keys para owner root.\n## ('SI HAY DUDAS, consultarlo con el tecnico')\n+-------------------------------------------------------------------------------------+\n\n## --> OPCION 2\n+-------------------------------------------------------------------------------------+\n## Corregir el LABEL a las claves publicas, ya sean /C/F/S, /K/I/E/\n+-------------------------------------------------------------------------------------+\n\n## --> OPCION 3\n+-------------------------------------------------------------------------------------+\n## Renombrar los ficheros authorized_keys que tenga owner huerfanos\n+-------------------------------------------------------------------------------------+\n",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n## LINUX\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p $file_authorized /home/${user^^}/authorized_key_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p $file_authorized /home/${user,,}/authorized_key_`date +%d%m%y_%T`\n\n## AIX\n+-------------------------------------------------------------------------------------+\n## Backup\n+-------------------------------------------------------------------------------------+\ncp -p \"$file_authorized\" /home/$user/authorized_key_`date +%d%m%y_%T`\n",
        "editar": "## --> OPCION 1\n+-------------------------------------------------------------------------------------+\n## Para ficheros authorized_keys, con owner root.\n+-------------------------------------------------------------------------------------+\n\nmv /home/root/.ssh/authorized_keys /home/root/.ssh/authorized_keys.save\n\n\n## --> OPCION 2\n+-------------------------------------------------------------------------------------+\n## --- Añadir GECOS de forma AUTOMATICA\n+-------------------------------------------------------------------------------------+\n\nsed -i 's,$,'\" $gecos\"',' \"$file_authorized\"\n\n+-------------------------------------------------------------------------------------+\n## Editar y añadir el GECOS de forma MANUAL\n+-------------------------------------------------------------------------------------+\n\nvi $file_authorized\n\n## Añadir el GECOS de la cuenta al final de la clave 'ssh-rsa' o si existe, debe estar ENTRE !! y !!\n\n## --> OPCION 3\n+-------------------------------------------------------------------------------------+\n## Si no existe la cuenta se puede RENOMBRAR el fichero\n+-------------------------------------------------------------------------------------+\n\nmv $file_authorized $file_authorized.save\n",
        "refrescar": null,
        "evidencia": "+-------------------------------------------------------------------------------------+\n## --> OPCION 1\n+-------------------------------------------------------------------------------------+\nclear\ndate\nhostname\nls -la /home/root/.ssh/authorized_keys\n\n+-------------------------------------------------------------------------------------+\n## --> OPCION 2 & ## --> OPCION 3\n+-------------------------------------------------------------------------------------+\nclear\ndate\nhostname\nls -la $file_authorized\ncat $file_authorized",
        "SO": "Linux"
    },
    {
        "modulo": "AV.1.7.1.2 Identify and Authenticate Users",
        "clave": "",
        "descripcion": "If public-key authentication is used to access the root account, separate private keys must be used for each individual and logs must be maintained showing which individuals have accessed the root account.",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## ERROR DE EXTRACION\n+-------------------------------------------------------------------------------------+\n\nSi PermitRootLogin es yes, se responde con YES\nSi PermitRootLogin es no, se responde con N/A\n\ncat /etc/ssh/sshd_config | grep PermitRootLogin",
        "copia": null,
        "editar": null,
        "refrescar": null,
        "evidencia": null,
        "SO": "Linux"
    },
    {
        "modulo": "AV.1.1.7 Password Requirements",
        "clave": "",
        "descripcion": "## (MODULO RELACIONADO : AV.1.1.6 Password Requirements)\n\n## SSH authorized_keys file: \"FICHERO AUTHORIZED KEYS\"; Invalid from section: . \"*º\" or \"*.*.*.*\" or \"0/0\" or \"0.0.0.0/0\" or empty are forbidden values in the \"from=\" parameter",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## En este tipo de desviaciones, las claves publicas (\"authorized_keys\")\n## Deben tener un FROM que especifique el host remoto o direccion IP.\n\n## Antes de seguir, revisar ('AUTHORIZED')\n+-------------------------------------------------------------------------------------+\n## Revisamos si tiene un FROM, que especifica el host remoto o IP\n## Debe ser solo accesible al owner\n+-------------------------------------------------------------------------------------+\n\nls -la $file_authorized\ncat $file_authorized\n\n## PUEDEN EXISTIR 3 OPCIONES DIFERENTES:\n\n## --> OPCION 1\n+-------------------------------------------------------------------------------------+\n## Si el fichero authorized_keys pertenece a la cuenta root, Root no debe tener un fichero authorized_keys.\n## Pasamos directamente a renombrar el fichero authorized_keys para el owner root.\n\n## ('SI HAY DUDAS, consultarlo con el tecnico')\n+-------------------------------------------------------------------------------------+\n\n## --> OPCION 2\n+-------------------------------------------------------------------------------------+\n## Si el fichero authorized_keys es de TIPO /F/ o /S/ (sistemas / aplicativo)\n## Se debe notificar al owner o grupo del fichero.\n\n## - Si se va a excepcionar nos deben especificar un RISK e IMPACT.\n\n## - Si se va a corregir (nos deben facilitar la IP o HOST).\n+-------------------------------------------------------------------------------------+\n## Si es de TIPO /C/ (customer)\n\n## - Se debe excepcionar.\n\n## Revisar RISK e IMPACT.\n+-------------------------------------------------------------------------------------+\n\n## --> OPCION 3\n+-------------------------------------------------------------------------------------+\n## Si el fichero authorized_keys, es de tipo /E/. /I/./K/\n\n## - Si es una cuenta 'externa' y no existe en el servidor, se puede renombrar el fichero authorized_key.\n\n## - Si la cuenta existe, se debe notificar al owner de la cuenta.\n+-------------------------------------------------------------------------------------+",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n## LINUX\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p $file_authorized /home/${user^^}/authorized_key_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p $file_authorized /home/${user,,}/authorized_key_`date +%d%m%y_%T`\n\n## AIX\n+-------------------------------------------------------------------------------------+\n## Backup\n+-------------------------------------------------------------------------------------+\n\ncp -p \"$file_authorized\" /home/$user/authorized_key_`date +%d%m%y_%T`\n",
        "editar": "## --> OPCION 1\n+-------------------------------------------------------------------------------------+\n## Para ficheros authorized_keys, con owner root.\n+-------------------------------------------------------------------------------------+\n\nmv /home/root/.ssh/authorized_keys /home/root/.ssh/authorized_keys.save\n\n\n## --> OPCION 2 y ## --> OPCION 3\n+-------------------------------------------------------------------------------------+\n## Para ficheros authorized_keys, de tipo /F/S/ o sin owner o account externas/internas de tipo /E/ o /I/.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Donde se tengan que renombar el fichero.\n+-------------------------------------------------------------------------------------+\n\nmv $file_authorized $file_authorized.save\n\n+-------------------------------------------------------------------------------------+\n## Donde se tenga que añadir un FROM.\n+-------------------------------------------------------------------------------------+\n\nvi $file_authorized\n\n+-------------------------------------------------------------------------------------+\n## Añadir la línea from=\"IP\", al inicio de cada clave shh-rsa:\n+-------------------------------------------------------------------------------------+\n## EJEMPLO\n\nfrom=\"129.39.41.5,129.39.41.6\" ssh-rsa AAAAB3NzaC1yc2EAAAABIw== !!CZ/S/*ABJ83/IBM/Automation ID!!\n",
        "refrescar": null,
        "evidencia": "## --> OPCION 1\n+-------------------------------------------------------------------------------------+\n## Para ficheros authorized_keys, con owner root.\n+-------------------------------------------------------------------------------------+\nclear\ndate\nhostname\nls -la /home/root/.ssh/authorized_keys\n\n\n## --> OPCION 2 y ## --> OPCION 3\n+-------------------------------------------------------------------------------------+\n## Para ficheros authorized_keys, de tipo /F/S/, sin owner o account externas/internas tipo /E/, /I/ /K/\n+-------------------------------------------------------------------------------------+\nclear\ndate\nhostname\nls -la $file_authorized\ncat $file_authorized",
        "SO": "Linux / Aix"
    },
    {
        "modulo": "Logging/Logging auth authpriv in external system",
        "clave": "AUTHPRIV",
        "descripcion": "GDPR: On systems that process PI, set syslog to send \"auth\" data to remote server.\nGDPR: On systems that process PI, set syslog to send \"authpriv\" data to remote server.",
        "comprobacion": null,
        "copia": null,
        "editar": null,
        "refrescar": null,
        "evidencia": null,
        "SO": "Linux"
    },
    {
        "modulo": "Network Settings//etc/inetd.conf - ntalk",
        "clave": "ENTRY NTALK",
        "descripcion": "ntalk entry must be removed or disabled in /etc/inetd.conf",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Debe no existir la entrada ntalk en /etc/inetd.conf, o estar comentada.\n+-------------------------------------------------------------------------------------+\n\ncat /etc/inetd.conf | grep -i ntalk\n\n+-------------------------------------------------------------------------------------+\n## Pregunta relacionada con :\n+-------------------------------------------------------------------------------------+\nNetwork Settings//etc/inetd.conf - time\nNetwork Settings//etc/inetd.conf - exec\nNetwork Settings//etc/inetd.conf - kshell",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n## Aix\n+-------------------------------------------------------------------------------------+\n## Backup en HOME\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/inetd.conf /home/${user}/inetd.conf_`date +%d%m%y_%T`",
        "editar": "+-------------------------------------------------------------------------------------+\n## Editar y comentar la linea.\n+-------------------------------------------------------------------------------------+\n\nvi /etc/inetd.conf\n\n+-------------------------------------------------------------------------------------+\n## Editar y comentar las relaciones:\n+-------------------------------------------------------------------------------------+\n\nexec entry must be removed or disabled in /etc/inetd.conf\ntime entry must be removed or disabled in /etc/inetd.conf\nkshell entry must be removed or disabled in /etc/inetd.conf",
        "refrescar": "refresh -s inetd",
        "evidencia": "clear\ndate\nhostname\ncat /etc/inetd.conf | grep -i ntalk\n\n+-------------------------------------------------------------------------------------+\n## Evidencia de las relaciones:\n+-------------------------------------------------------------------------------------+\nclear\ndate\nhostname\ncat /etc/inetd.conf | grep -i exec\ncat /etc/inetd.conf | grep -i ntalk\ncat /etc/inetd.conf | grep -i time\ncat /etc/inetd.conf | grep -i kshell",
        "SO": "Aix"
    },
    {
        "modulo": "Network Settings//etc/inetd.conf - time",
        "clave": "ENTRY TIME",
        "descripcion": "time entry must be removed or disabled in /etc/inetd.conf",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Debe no existir la entrada time en /etc/inetd.conf, o estar comentada.\n+-------------------------------------------------------------------------------------+\n\ncat /etc/inetd.conf | grep -i time\n\n+-------------------------------------------------------------------------------------+\n## Pregunta relacionada con :\n+-------------------------------------------------------------------------------------+\nNetwork Settings//etc/inetd.conf - ntalk\nNetwork Settings//etc/inetd.conf - exec\nNetwork Settings//etc/inetd.conf - kshell",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n## Aix\n+-------------------------------------------------------------------------------------+\n## Backup en HOME\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/inetd.conf /home/${user}/inetd.conf_`date +%d%m%y_%T`",
        "editar": "+-------------------------------------------------------------------------------------+\n## Editar y comentar la linea.\n+-------------------------------------------------------------------------------------+\n\nvi /etc/inetd.conf\n\n+-------------------------------------------------------------------------------------+\n## Editar y comentar las relaciones:\n+-------------------------------------------------------------------------------------+\n\nexec entry must be removed or disabled in /etc/inetd.conf\nntalk entry must be removed or disabled in /etc/inetd.conf\nkshell entry must be removed or disabled in /etc/inetd.conf",
        "refrescar": "refresh -s inetd",
        "evidencia": "clear\ndate\nhostname\ncat /etc/inetd.conf | grep -i time\n\n+-------------------------------------------------------------------------------------+\n## Evidencia de las relaciones:\n+-------------------------------------------------------------------------------------+\nclear\ndate\nhostname\ncat /etc/inetd.conf | grep -i exec\ncat /etc/inetd.conf | grep -i time\ncat /etc/inetd.conf | grep -i ntalk\ncat /etc/inetd.conf | grep -i kshell",
        "SO": "Aix"
    },
    {
        "modulo": "E.1.5.12.31 Network Settings",
        "clave": "ENTRY TIME",
        "descripcion": "time entry must be removed or disabled in /etc/inetd.conf",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Debe no existir la entrada time en /etc/inetd.conf, o estar comentada.\n+-------------------------------------------------------------------------------------+\n\ncat /etc/inetd.conf | grep -i time\n\n+-------------------------------------------------------------------------------------+\n## Pregunta relacionada con :\n+-------------------------------------------------------------------------------------+\nNetwork Settings//etc/inetd.conf - ntalk\nNetwork Settings//etc/inetd.conf - exec\nNetwork Settings//etc/inetd.conf - kshell",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n## Aix\n+-------------------------------------------------------------------------------------+\n## Backup en HOME\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/inetd.conf /home/${user}/inetd.conf_`date +%d%m%y_%T`",
        "editar": "+-------------------------------------------------------------------------------------+\n## Editar y comentar la linea.\n+-------------------------------------------------------------------------------------+\n\nvi /etc/inetd.conf\n\n+-------------------------------------------------------------------------------------+\n## Editar y comentar las relaciones:\n+-------------------------------------------------------------------------------------+\n\nexec entry must be removed or disabled in /etc/inetd.conf\nntalk entry must be removed or disabled in /etc/inetd.conf\nkshell entry must be removed or disabled in /etc/inetd.conf",
        "refrescar": "refresh -s inetd",
        "evidencia": "clear\ndate\nhostname\ncat /etc/inetd.conf | grep -i time\n\n+-------------------------------------------------------------------------------------+\n## Evidencia de las relaciones:\n+-------------------------------------------------------------------------------------+\nclear\ndate\nhostname\ncat /etc/inetd.conf | grep -i exec\ncat /etc/inetd.conf | grep -i time\ncat /etc/inetd.conf | grep -i ntalk\ncat /etc/inetd.conf | grep -i kshell",
        "SO": "Aix"
    },
    {
        "modulo": "Network Settings//etc/inetd.conf - exec",
        "clave": "ENTRY EXEC",
        "descripcion": "exec entry must be removed or disabled in /etc/inetd.conf",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Debe no existir la entrada exec en /etc/inetd.conf, o estar comentada.\n+-------------------------------------------------------------------------------------+\n\ncat /etc/inetd.conf | grep -i exec\n\n+-------------------------------------------------------------------------------------+\n## Pregunta relacionada con :\n+-------------------------------------------------------------------------------------+\nNetwork Settings//etc/inetd.conf - ntalk\nNetwork Settings//etc/inetd.conf - time\nNetwork Settings//etc/inetd.conf - kshell",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n## Aix\n+-------------------------------------------------------------------------------------+\n## Backup en HOME\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/inetd.conf /home/${user}/inetd.conf_`date +%d%m%y_%T`",
        "editar": "+-------------------------------------------------------------------------------------+\n## Editar y comentar la linea.\n+-------------------------------------------------------------------------------------+\n\nvi /etc/inetd.conf\n\n+-------------------------------------------------------------------------------------+\n## Editar y comentar las relaciones:\n+-------------------------------------------------------------------------------------+\n\ntime entry must be removed or disabled in /etc/inetd.conf\nntalk entry must be removed or disabled in /etc/inetd.conf\nkshell entry must be removed or disabled in /etc/inetd.conf",
        "refrescar": "refresh -s inetd",
        "evidencia": "clear\ndate\nhostname\ncat /etc/inetd.conf | grep -i exec\n\n+-------------------------------------------------------------------------------------+\n## Evidencia de las relaciones:\n+-------------------------------------------------------------------------------------+\nclear\ndate\nhostname\ncat /etc/inetd.conf | grep -i exec\ncat /etc/inetd.conf | grep -i time\ncat /etc/inetd.conf | grep -i ntalk\ncat /etc/inetd.conf | grep -i kshell",
        "SO": "Aix"
    },
    {
        "modulo": "Network Settings//etc/inetd.conf - kshell",
        "clave": "ENTRY KSHELL",
        "descripcion": "kshell entry must be removed or disabled in /etc/inetd.conf",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Debe no existir la entrada kshell en /etc/inetd.conf, o estar comentada.\n+-------------------------------------------------------------------------------------+\n\ncat /etc/inetd.conf | grep -i kshell\n\n+-------------------------------------------------------------------------------------+\n## Pregunta relacionada con :\n+-------------------------------------------------------------------------------------+\nNetwork Settings//etc/inetd.conf - ntalk\nNetwork Settings//etc/inetd.conf - time\nNetwork Settings//etc/inetd.conf - exec",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n## Aix\n+-------------------------------------------------------------------------------------+\n## Backup en HOME\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/inetd.conf /home/${user}/inetd.conf_`date +%d%m%y_%T`",
        "editar": "+-------------------------------------------------------------------------------------+\n## Editar y comentar la linea.\n+-------------------------------------------------------------------------------------+\n\nvi /etc/inetd.conf\n\n+-------------------------------------------------------------------------------------+\n## Editar y comentar las relaciones:\n+-------------------------------------------------------------------------------------+\n\ntime entry must be removed or disabled in /etc/inetd.conf\nntalk entry must be removed or disabled in /etc/inetd.conf\nexec entry must be removed or disabled in /etc/inetd.conf",
        "refrescar": "refresh -s inetd",
        "evidencia": "clear\ndate\nhostname\ncat /etc/inetd.conf | grep -i kshell\n\n+-------------------------------------------------------------------------------------+\n## Evidencia de las relaciones:\n+-------------------------------------------------------------------------------------+\nclear\ndate\nhostname\ncat /etc/inetd.conf | grep -i kshell\ncat /etc/inetd.conf | grep -i time\ncat /etc/inetd.conf | grep -i ntalk\ncat /etc/inetd.conf | grep -i exec",
        "SO": "Aix"
    },
    {
        "modulo": "Network Settings//etc/inittab - piobe",
        "clave": "PIOBE",
        "descripcion": "File /etc/inittab have piobe service.",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Son servicios de impresion, debe salir la linea comentada o vacio\n+-------------------------------------------------------------------------------------+\n\nlsitab piobe\n\n+-------------------------------------------------------------------------------------+\n## Relacionado con los modulos:\n+-------------------------------------------------------------------------------------+\n\nNetwork Settings/\\etc\\inittab - qdaemon\nlsitab qdaemon\n\nNetwork Settings/\\etc\\inittab - writesrv\nlsitab writesrv\n\n+-------------------------------------------------------------------------------------+\n## Ademas debemos comprobar si no hay colas de impresion\n+-------------------------------------------------------------------------------------+\nenq\n\n// enq: (FATAL ERROR): 0781-372 There are no queues defined in the /etc/qconfig file. //\n\n+-------------------------------------------------------------------------------------+\n## Si hacemos un cat /etc/qconfig y no tiene nada, o no hay colas de impresión definidas y se podría parar.\n## Si salen colas de IMPRESION PREGUNTAR ANTES DE PARAR.\n+-------------------------------------------------------------------------------------+\n\ncat /etc/qconfig | grep -v \"^*\"\n\n// debe salir vacio, o si el resultado del cat, salen por delante *, son solo comentarios.\"CUALQUIER DUDA PREGUNTAR\" //",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n## Aix\n+-------------------------------------------------------------------------------------+\n## Backup en HOME\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/inetd.conf /home/${user}/inetd.conf_`date +%d%m%y_%T`",
        "editar": "+-------------------------------------------------------------------------------------+\n## Eliminar la entrada:\n+-------------------------------------------------------------------------------------+\n\nrmitab piobe\n\n+-------------------------------------------------------------------------------------+\n## Eliminar las entradas relacionadas:\n+-------------------------------------------------------------------------------------+\n\nrmitab qdaemon\nrmitab writesrv",
        "refrescar": null,
        "evidencia": "clear\ndate\nuname -a\nlsitab piobe\n\n\n+-------------------------------------------------------------------------------------+\n## Evidencia de las relaciones:\n+-------------------------------------------------------------------------------------+\nclear\ndate\nuname -a\nlsitab qdaemon\nlsitab writesrv\nlsitab piobe",
        "SO": "Aix"
    },
    {
        "modulo": "Network Settings//etc/inittab - qdaemon",
        "clave": "QDAEMON",
        "descripcion": "File /etc/inittab have qdaemon service.",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Son servicios de impresion, debe salir la linea comentada o vacio\n+-------------------------------------------------------------------------------------+\n\nlsitab qdaemon\n\n+-------------------------------------------------------------------------------------+\n## Relacionado con los modulos:\n+-------------------------------------------------------------------------------------+\n\nNetwork Settings/\\etc\\inittab - piobe\nlsitab piobe\n\nNetwork Settings/\\etc\\inittab - writesrv\nlsitab writesrv\n\n+-------------------------------------------------------------------------------------+\n## Ademas debemos comprobar si no hay colas de impresion\n+-------------------------------------------------------------------------------------+\nenq\n\n// enq: (FATAL ERROR): 0781-372 There are no queues defined in the /etc/qconfig file. //\n\n+-------------------------------------------------------------------------------------+\n## Si hacemos un cat /etc/qconfig y no tiene nada, o no hay colas de impresión definidas y se podría parar.\n## Si salen colas de IMPRESION PREGUNTAR ANTES DE PARAR.\n+-------------------------------------------------------------------------------------+\n\ncat /etc/qconfig | grep -v \"^*\"\n\n// debe salir vacio, o si el resultado del cat, salen por delante *, son solo comentarios.\"CUALQUIER DUDA PREGUNTAR\" //",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n## Aix\n+-------------------------------------------------------------------------------------+\n## Backup en HOME\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/inetd.conf /home/${user}/inetd.conf_`date +%d%m%y_%T`",
        "editar": "+-------------------------------------------------------------------------------------+\n## Eliminar la entrada:\n+-------------------------------------------------------------------------------------+\n\nrmitab qdaemon\n\n+-------------------------------------------------------------------------------------+\n## Eliminar las entradas relacionadas:\n+-------------------------------------------------------------------------------------+\n\nrmitab piobe\nrmitab writesrv",
        "refrescar": null,
        "evidencia": "clear\ndate\nuname -a\nlsitab qdaemon\n\n\n+-------------------------------------------------------------------------------------+\n## Evidencia de las relaciones:\n+-------------------------------------------------------------------------------------+\nclear\ndate\nuname -a\nlsitab piobe\nlsitab writesrv\nlsitab qdaemon",
        "SO": "Aix"
    },
    {
        "modulo": "Network Settings//etc/inittab - writesrv",
        "clave": "WRITESRV",
        "descripcion": "File /etc/inittab have writesrv service.",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Son servicios de impresion, debe salir la linea comentada o vacio\n+-------------------------------------------------------------------------------------+\n\nlsitab writesrv\n\n+-------------------------------------------------------------------------------------+\n## Relacionado con los modulos:\n+-------------------------------------------------------------------------------------+\n\nNetwork Settings/\\etc\\inittab - piobe\nlsitab piobe\n\nNetwork Settings/\\etc\\inittab - qdaemon\nlsitab qdaemon\n\n+-------------------------------------------------------------------------------------+\n## Ademas debemos comprobar si no hay colas de impresion\n+-------------------------------------------------------------------------------------+\nenq\n\n// enq: (FATAL ERROR): 0781-372 There are no queues defined in the /etc/qconfig file. //\n\n+-------------------------------------------------------------------------------------+\n## Si hacemos un cat /etc/qconfig y no tiene nada, o no hay colas de impresión definidas y se podría parar.\n## Si salen colas de IMPRESION PREGUNTAR ANTES DE PARAR.\n+-------------------------------------------------------------------------------------+\n\ncat /etc/qconfig | grep -v \"^*\"\n\n// debe salir vacio, o si el resultado del cat, salen por delante *, son solo comentarios.\"CUALQUIER DUDA PREGUNTAR\" //",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n## Aix\n+-------------------------------------------------------------------------------------+\n## Backup en HOME\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/inetd.conf /home/${user}/inetd.conf_`date +%d%m%y_%T`",
        "editar": "+-------------------------------------------------------------------------------------+\n## Eliminar la entrada:\n+-------------------------------------------------------------------------------------+\n\nrmitab writesrv\n\n+-------------------------------------------------------------------------------------+\n## Eliminar las entradas relacionadas:\n+-------------------------------------------------------------------------------------+\n\nrmitab piobe\nrmitab qdaemon",
        "refrescar": null,
        "evidencia": "clear\ndate\nuname -a\nlsitab writesrv\n\n\n+-------------------------------------------------------------------------------------+\n## Evidencia de las relaciones:\n+-------------------------------------------------------------------------------------+\nclear\ndate\nuname -a\nlsitab piobe\nlsitab writesrv\nlsitab qdaemon",
        "SO": "Aix"
    },
    {
        "modulo": "Network Settings/default core dumps restriction",
        "clave": "CORE DUMPS",
        "descripcion": "core dumps should be disabled by default. Current settings: stanza=default, attribute=core, value=2097151\n\ncore dumps should be disabled by default. Current settings: stanza=default, attribute=core_hard, value=",
        "comprobacion": null,
        "copia": null,
        "editar": "chsec -f /etc/security/limits -s default -a core=0 -a core_hard=0\nchdev -l sys0 -a fullcore=false",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\nlssec -f /etc/security/limits -s default -a core -a core_hard\nlsattr -El sys0 -a fullcore\n\n+-------------------------------------------------------------------------------------+\n#El comando lssec, debe salir de la siguiente manera:\n+-------------------------------------------------------------------------------------+\n#//default core=0 core_hard=0\n\n+-------------------------------------------------------------------------------------+\n#El comando lsattrm, debe salir de la siguiente manera:\n+-------------------------------------------------------------------------------------+\n#//fullcore false Enable full CORE dump True",
        "SO": "Aix"
    },
    {
        "modulo": "Network Settings/Disable NFS server",
        "clave": "NFS",
        "descripcion": "NFS server enabled, it must be disabled.",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## No es un servicio requerido, por lo que se puede deshabilitar en servidores que no son NIM MASTER.\n+-------------------------------------------------------------------------------------+\n\nlslpp -L | grep bos.sysmgt.nim.master\n\n+-------------------------------------------------------------------------------------+\n## Si no es un NIM MASTER, se puede comprobar que NFS server no este habilitado\n+-------------------------------------------------------------------------------------+\n\nlslpp -L |grep bos.net.nfs.server\n\n+-------------------------------------------------------------------------------------+\n## Debe salir vacio en /etc/exports\n+-------------------------------------------------------------------------------------+\n\ncat /etc/exports\n\n+-------------------------------------------------------------------------------------+\n## En el caso de tener shares/filesystem, contactar con el SOPORTE TECNICO.\n+-------------------------------------------------------------------------------------+",
        "copia": null,
        "editar": "installp -u bos.net.nfs.server",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\nlslpp -L |grep bos.net.nfs.server",
        "SO": "Aix"
    },
    {
        "modulo": "Network Settings/Disable NIS client",
        "clave": "NIS",
        "descripcion": "Fileset bos.net.nis.client installed. NIS client enabled, it must be disabled.",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Debe no existir nis.client\n+-------------------------------------------------------------------------------------+\n\nlslpp -L |grep \"bos.net.nis.client\"\n\n+-------------------------------------------------------------------------------------+\n## Debe estar inoperative\n+-------------------------------------------------------------------------------------+\n\nstopsrc -g yp",
        "copia": null,
        "editar": "installp -u bos.net.nis.client",
        "refrescar": null,
        "evidencia": "clear\ndate\nuname -a\nlslpp -L |grep \"bos.net.nis.client\"",
        "SO": "Aix"
    },
    {
        "modulo": "Network Settings/On syslog clients, disable remote message collection",
        "clave": "SYSLOGD",
        "descripcion": "syslogd must be run with the -r flag",
        "comprobacion": "/usr/sbin/syslogd , debe tener un `-r` al final",
        "copia": null,
        "editar": "chssys -s syslogd -a \"-r\"",
        "refrescar": "stopsrc -s syslogd; sleep 1; startsrc -s syslogd",
        "evidencia": "clear\ndate\nuname -a\nps -ef |grep \"syslogd\"\n\n// El distintivo -r debe estar presente al final de la salida.//",
        "SO": "Aix"
    },
    {
        "modulo": "Network Settings/Prohibited Processes",
        "clave": "INETD",
        "descripcion": "INETD Process XXXXX prohibited if not required to support application\nRPC Process XXXXX prohibited if not required to support application",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Comentar los procesos/servicios en /etc/inetd.conf\n+-------------------------------------------------------------------------------------+\n\ncat /etc/inetd.conf | grep -i cmsd\ncat /etc/inetd.conf | grep -i dtspcd\ncat /etc/inetd.conf | grep -i ttdbserver\n\n+-------------------------------------------------------------------------------------+\n## Relacionado con:\n+-------------------------------------------------------------------------------------+\n\nNetwork Settings/\\etc\\inetd.conf - ntalk\nNetwork Settings/\\etc\\inetd.conf - exec\nNetwork Settings/\\etc\\inetd.conf - time\n\n+-------------------------------------------------------------------------------------+\n## Otros procesos/servicios no comunes, REVISAR '- * SERVICE * -':\n+-------------------------------------------------------------------------------------+\n\ncat /etc/inetd.conf | grep -i \"$service\"\n\n+-------------------------------------------------------------------------------------+\n## Servicios no comunes como FTP, Telnet etc etc.\n## Se pueden comprobar de la siguiente manera.\n+-------------------------------------------------------------------------------------+\n---\n## FTP, se puede comprobar que no haya conexiones ftp al servidor y ver que tipo de cuenta es ya sea /C/F/S/.\n+-------------------------------------------------------------------------------------+\n\nlast\n\n+-------------------------------------------------------------------------------------+\n---\n## TELNET, se puede comprobar que no exista ninguna shell `/bin/false`, para FTP.\n+-------------------------------------------------------------------------------------+\n\ncat /etc/passwd | grep -i \"\/bin/false\"\n\n+-------------------------------------------------------------------------------------+\n## Cualquier duda, consultarlo con los tecnicos.\n+-------------------------------------------------------------------------------------+",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n## Aix\n+-------------------------------------------------------------------------------------+\n## Backup en HOME\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/inetd.conf /home/${user}/inetd.conf_`date +%d%m%y_%T`",
        "editar": "+-------------------------------------------------------------------------------------+\n## Editar y comentar las lineas de los procesos/servicios.\n+-------------------------------------------------------------------------------------+\n\nvi /etc/inetd.conf\n\n+-------------------------------------------------------------------------------------+\n## Editar y comentar las relaciones, si es necesario:\n+-------------------------------------------------------------------------------------+\n\nexec entry must be removed or disabled in /etc/inetd.conf\ntime entry must be removed or disabled in /etc/inetd.conf\nntalk entry must be removed or disabled in /etc/inetd.conf\n",
        "refrescar": "refresh -s inetd",
        "evidencia": "clear\ndate\nhostname\ncat /etc/inetd.conf | grep -i cmsd\ncat /etc/inetd.conf | grep -i ttdbserver\ncat /etc/inetd.conf | grep -i dtspcd\n\n+-------------------------------------------------------------------------------------+\n## Evidencia de otros servicios y procesos :\n+-------------------------------------------------------------------------------------+\nclear\ndate\nhostname\ncat /etc/inetd.conf | grep -i \"$service\"\n\n+-------------------------------------------------------------------------------------+\n## Evidencia de las relaciones:\n+-------------------------------------------------------------------------------------+\nclear\ndate\nhostname\ncat /etc/inetd.conf | grep -i cmsd\ncat /etc/inetd.conf | grep -i ttdbserver\ncat /etc/inetd.conf | grep -i dtspcd\ncat /etc/inetd.conf | grep -i ntalk\ncat /etc/inetd.conf | grep -i exec\ncat /etc/inetd.conf | grep -i time",
        "SO": "Aix"
    },
    {
        "modulo": "Network Settings/X-server access control",
        "clave": "X-SERVER",
        "descripcion": "Fileset X11.apps.config must not own file /usr/lpp/X11/bin/xhost.",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## El fileset xhost no deberia instalarse.\n+-------------------------------------------------------------------------------------+\n\nlslpp -w /usr/lpp/X11/bin/xhost",
        "copia": null,
        "editar": "installp -g -u  X11.apps.config",
        "refrescar": null,
        "evidencia": "clear\ndate\nuname -a\nlslpp -w /usr/lpp/X11/bin/xhost",
        "SO": "Aix"
    },
    {
        "modulo": "E.1.5.11.1 Network Settings",
        "clave": "X-SERVER",
        "descripcion": "Fileset X11.apps.config must not own file /usr/lpp/X11/bin/xhost.",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## El fileset xhost no deberia instalarse.\n+-------------------------------------------------------------------------------------+\n\nlslpp -w /usr/lpp/X11/bin/xhost",
        "copia": null,
        "editar": "installp -g -u  X11.apps.config",
        "refrescar": null,
        "evidencia": "clear\ndate\nuname -a\nlslpp -w /usr/lpp/X11/bin/xhost",
        "SO": "Aix"
    },
    {
        "modulo": "Password Requirements/Automatic Logoff /etc/csh.login autologout",
        "clave": "AUTOLOGOUT",
        "descripcion": "/etc/csh.login Set systems to terminate a session after 360 minutes of inactivity. File must contain \"set autologout=360\". A shorter time frame may be specified.",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## En /etc/csh.login, al final del SCRIPT de UMASK\n## Debe tener un autologout\n(\"autologout solo debe estar implementado en '/etc/csh.login'\")\n+-------------------------------------------------------------------------------------+\n\ncat /etc/csh.login | grep -i autologout",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/csh.login /home/$user/csh.login_`date +%d%m%y_%T`",
        "editar": "+-------------------------------------------------------------------------------------+## Editar y Añadir al final de SCRIPT de UMASK\n+-------------------------------------------------------------------------------------+\n\nvi /etc/csh.login\n\nset autologout=360",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\ncat /etc/csh.login | grep -i autologout",
        "SO": "Aix"
    },
    {
        "modulo": "Password Requirements/Automatic Logoff /etc/profile TMOUT",
        "clave": "TMOUT",
        "descripcion": "/etc/profile Set systems to terminate a session after 21600 seconds of inactivity. File must  contain \"TMOUT=21600\" followed by \"export TMOUT\". A shorter time frame may be specified.",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## En /etc/profile, al final del SCRIPT\n## Debe tener un TMOUT\n+-------------------------------------------------------------------------------------+\n\ncat /etc/profile | grep -i TMOUT\n\n+-------------------------------------------------------------------------------------+\n## SET muestra el valor por defecto\n+-------------------------------------------------------------------------------------+\n\nset | grep OUT",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup en HOME\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/profile /home/$user/profile_`date +%d%m%y_%T`",
        "editar": "+-------------------------------------------------------------------------------------+\n## Editar y Añadir al final del SCRIPT\n+-------------------------------------------------------------------------------------+\n\nvi /etc/profile\n\nTMOUT=21600\nexport TMOUT",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\ncat /etc/profile | grep -i TMOUT\nset | grep OUT",
        "SO": "Aix"
    },
    {
        "modulo": "Password Requirements/Password histexpire - System Default",
        "clave": "HISTEXPIRE",
        "descripcion": "Invalid system default histexpire set to 0, must be not less than 105",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## El parametro histexpire, debe ser 105, por defecto y por usuario.\n## Una vez cambiado a default, se corrigen para las demas cuentas, puede quedar root o alguna cuenta sin cambiar, por lo que se puede cambiar manual.\n+-------------------------------------------------------------------------------------+\n\nlssec -f /etc/security/user -s default -a histexpire",
        "copia": null,
        "editar": "chsec -f /etc/security/user -s default -a histexpire=105\nchsec -f /etc/security/user -s root -a histexpire=105",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\nlssec -f /etc/security/user -s default -a histexpire\nlssec -f /etc/security/user -s root -a histexpire",
        "SO": "Aix"
    },
    {
        "modulo": "E.1.1.3.2 Password Requirements",
        "clave": "HISTEXPIRE",
        "descripcion": "Invalid system default histexpire set to 0, must be not less than 105",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## El parametro histexpire, debe ser 105, por defecto y por usuario.\n## Una vez cambiado a default, se corrigen para las demas cuentas, puede quedar root o alguna cuenta sin cambiar, por lo que se puede cambiar manual.\n+-------------------------------------------------------------------------------------+\n\nlssec -f /etc/security/user -s default -a histexpire",
        "copia": null,
        "editar": "chsec -f /etc/security/user -s default -a histexpire=105\nchsec -f /etc/security/user -s root -a histexpire=105",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\nlssec -f /etc/security/user -s default -a histexpire\nlssec -f /etc/security/user -s root -a histexpire",
        "SO": "Aix"
    },
    {
        "modulo": "Protecting Resources-OSRs/OSR /var/adm/cron files restrictions",
        "clave": "/VAR/ADM/CRON",
        "descripcion": "/var/adm/cron/XXXXX, Owner: root, Group: sys, Permissions: -rw-r--r---, must be --- for other. Should be owned by privileged owner and group.",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Ficheros que cuelgan en /var/adm/cron/, deben ser propiedad de root o bin y no debe tener permisos en OTHER\n+-------------------------------------------------------------------------------------+\n\nls -l /var/adm/cron/",
        "copia": null,
        "editar": "chmod -R o-r,o-w,o-x /var/adm/cron/",
        "refrescar": null,
        "evidencia": "clear\ndate\nuname -a\nls -l /var/adm/cron/",
        "SO": "Aix"
    },
    {
        "modulo": "Protecting Resources-OSRs/OSR /var/ct/RMstart.log restrictions",
        "clave": "/VAR/CT/RMSTART.LOG",
        "descripcion": "/var/ct/RMstart.log, Owner: root, Group: system, Permissions: 0644, must be 640 or more restrictive. Should be owned by privileged owner and group.",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Fichero /var/ct/RMstart.log, no debe tener permisos en OTHER\n+-------------------------------------------------------------------------------------+\n\nls -l /var/ct/RMstart.log",
        "copia": null,
        "editar": "chmod 0640 /var/ct/RMstart.log",
        "refrescar": null,
        "evidencia": "clear\ndate\nuname -a\nls -la /var/ct/RMstart.log",
        "SO": "Aix"
    },
    {
        "modulo": "Protecting Resources-OSRs/OSR /var/spool/cron/crontabs files restrictions",
        "clave": "/VAR/SPOOL/CRON/CRONTABS/",
        "descripcion": "/var/spool/cron/crontabs/XXXXX, Owner: $usuario, Group: $grupo, Permissions: -rw-r--r---, settings for other must be --- (0).",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Ficheros que cuelgan en /var/spool/cron/crontabs/, deben ser propiedad de root, adm, sys etc etc y no debe tener permisos en OTHER\n+-------------------------------------------------------------------------------------+\n\nls -l /var/spool/cron/crontabs/",
        "copia": null,
        "editar": "chmod o-r,o-w,o-x /var/spool/cron/crontabs/*",
        "refrescar": null,
        "evidencia": "clear\ndate\nuname -a\nls -l /var/spool/cron/crontabs/",
        "SO": "Aix"
    },
    {
        "modulo": "Protecting Resources-OSRs/OSR /var/tmp/hostmibd.log restrictions",
        "clave": "/VAR/TMP/HOSTMIBD.LOG",
        "descripcion": "/var/tmp/hostmibd.log, Owner: root, Group: system, Permissions: 0644, must be 640 or more restrictive. Should be owned by privileged owner and group.",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Fichero /var/tmp/hostmibd.log, no debe tener permisos en OTHER\n+-------------------------------------------------------------------------------------+\n\nls -l /var/tmp/hostmibd.log",
        "copia": null,
        "editar": "chmod 0640 /var/tmp/hostmibd.log",
        "refrescar": null,
        "evidencia": "clear\ndate\nuname -a\nls -l /var/tmp/hostmibd.log",
        "SO": "Aix"
    },
    {
        "modulo": "Protecting Resources-OSRs/smit.transaction Restrictions",
        "clave": "SMIT.TRANSACTION",
        "descripcion": "Invalid Permissions or Ownership for File: /smit.transaction, Owner: root, Text Permissions: -rw-r--r---, must only be readable or writeable by root. Should be owned by root.",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Desvio similar al modulo : \n+-------------------------------------------------------------------------------------+\n\nProtecting Resources-OSRs/smit.log Restrictions\nProtecting Resources-OSRs/smit.script Restrictions\n",
        "copia": null,
        "editar": "chmod g-r,o-r /smit.transaction\n\n+-------------------------------------------------------------------------------------+\n## Corregir similares:\n+-------------------------------------------------------------------------------------+\n\nchmod g-r,o-r /smit.script\nchmod g-r,o-r /smit.log",
        "refrescar": null,
        "evidencia": "clear\ndate\nuname -a\nls -ls /smit.log\nls -ls /smit.script\nls -ls /smit.transaction",
        "SO": "Aix"
    },
    {
        "modulo": "Password Requirements/NULL Passphrase",
        "clave": "IDRSA",
        "descripcion": "Private key $file_idrsa is not encrypted",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## En este tipo de desviaciones, las claves privadas(\"id_rsa\")\n## Deben tener una frase de paso (passphrase) : \"Proc-Type: 4,ENCRYPTED\"\n\n## Puede no tener un passphrase, siempre que la clave_publica(authorized_keys), tenga un FROM.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Guardamos en la variable, el fichero id_rsa a revisar\n## Antes de seguir, revisar -* ID_RSA *-\n+-------------------------------------------------------------------------------------+\n\nfile_idrsa=\"\"\n\n+-------------------------------------------------------------------------------------+\n## Revisamos si tiene una FRASE DE PASO\n## Debe ser solo accesible al owner\n+-------------------------------------------------------------------------------------+\n\nls -la $file_idrsa\ncat $file_idrsa\n\n## PUEDEN EXISTIR 3 OPCIONES DIFERENTES:\n\n## --> OPCION 1\n+-------------------------------------------------------------------------------------+\n## Si el fichero id_rsa es de root, no debe tener un fichero id_rsa.\n## Pasamos directamente a renombrar el fichero id_rsa para owner root.\n## ('SI HAY DUDAS, consultarlo con el tecnico')\n+-------------------------------------------------------------------------------------+\n\n## --> OPCION 2\n+-------------------------------------------------------------------------------------+\n## Si el fichero id_rsa, pertenece a otro owner o grupo que no sea root.\n## Si es de TIPO /F/S (sistemas / aplicativo)\n## se debe contactar con el owner o grupo del fichero.\n## - Si se va a excepcionar nos deben especificar un RISK e IMPACT.\n\n## - Si se va a corregir.\n## Revisar ('ID_RSA'), antes de cualquier cambio.\n\n## Si es de TIPO /C/ (customer)\n## - Se debe excepcionar.\n## Por favor revisar la sección de RISK e IMPACT.\n+-------------------------------------------------------------------------------------+\n\n## --> OPCION 3\n+-------------------------------------------------------------------------------------+\n## Si el fichero id_rsa, pertenece a otro owner o grupo que no sea root.\n## Si es de tipo /E/. /I/\n## - Si es una cuenta 'externa' y no existe en el servidor, se puede renombrar.\n## - Si la cuenta existe, se debe notificar al owner de la cuenta.\n\n## Se le debe notificar que se ha renombrado el fichero y que si lo utiliza debe,\n## Crear un fichero id_rsa con una frase de paso (passphrase).  \n## Revisar ('ID_RSA'), antes de cualquier cambio.\n+-------------------------------------------------------------------------------------+",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n## LINUX\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p $file_idrsa /home/${user^^}/id_rsa_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p $file_idrsa /home/${user,,}/id_rsa_`date +%d%m%y_%T`\n\n##AIX\n+-------------------------------------------------------------------------------------+\n## Backup\n+-------------------------------------------------------------------------------------+\ncp -p \"$file_idrsa\" /home/$user/id_rsa_`date +%d%m%y_%T`",
        "editar": "## --> OPCION 1\n+-------------------------------------------------------------------------------------+\n## Para ficheros id_rsa, con owner root\n+-------------------------------------------------------------------------------------+\n\nmv /.ssh/id_rsa /.ssh/id_rsa.save\n\n\n## --> OPCION 2\n+-------------------------------------------------------------------------------------+\n## Para otros ficheros id_rsa.\n## De tipo /F/S/.\n## Para implementar una FRASE DE PASO, se debe eliminar el fichero y crear uno nuevo si no recuerda si puso una passphrase\n\n## Al crear con la opcion -P (ssh-keygen -t rsa -P \"frase_depaso\")\n\n## Si no se indica la opcion, al crear la clave privada lo pregunta : (Enter passphrase (empty for no passphrase):).\n+-------------------------------------------------------------------------------------+\n\nrm $file_idrsa\n\n+-------------------------------------------------------------------------------------+\n## Si recuerda la frase de paso (passphrase), o es vacia, se puede crear o modificar con la siguientes opciones\n+-------------------------------------------------------------------------------------+\n\nssh-keygen -o -p -f keyfile\n\n## --> OPCION 3\n+-------------------------------------------------------------------------------------+\n## Para otros ficheros id_rsa, sin owner o account externas.\n## De tipo /E/I/\n\n## Si no existe la cuenta se puede renombrar\n\n## Si existe la cuenta, se le debe indicar que debe crear una nueva clave privada o modifcar e implementar un frase de paso (passphrase)(\"OPCION 2\")\n+-------------------------------------------------------------------------------------+\n\nmv $file_idrsa $file_idrsa.save",
        "refrescar": null,
        "evidencia": "## --> OPCION 1\n+-------------------------------------------------------------------------------------+\n## Para ficheros id_rsa, con owner root.\n+-------------------------------------------------------------------------------------+\nclear\ndate\nhostname\nls -la /.ssh/id_rsa\nls -la /.ssh/id_rsa.save\n\n\n## --> OPCION 2\n+-------------------------------------------------------------------------------------+\n## Para otros ficheros id_rsa.\n## De tipo /F/S/.\n+-------------------------------------------------------------------------------------+\nclear\ndate\nuname -a\ncat $file_idrsa | grep -i 'ENCRYPTED' \n\n\n## --> OPCION 3\n+-------------------------------------------------------------------------------------+\n## Para otros ficheros id_rsa, sin owner o account externas.\n## De tipo /E/I/.\n+-------------------------------------------------------------------------------------+\nclear\ndate\nuname -a\nls -la $file_idrsa\nls -la $file_idrsa.save",
        "SO": "Aix"
    },
    {
        "modulo": "System Settings/MaxAuthTries Restriction",
        "clave": "MAXAUTHTRIES",
        "descripcion": "SSH Config File: /etc/ssh/sshd_config; Invalid setting (value: -1) in parameter 'MaxAuthTries': must be set to 5 or less.",
        "comprobacion": "## Antes de corregir se debe comprobar que no estén los valores correctos por defecto\n\n+-------------------------------------------------------------------------------------+\n## Valor por defecto correcto es : 5\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Muestra el valor por defecto\n+-------------------------------------------------------------------------------------+\n\n/usr/sbin/sshd -T|grep -i MaxAuthTries\n\n+-------------------------------------------------------------------------------------+\n## Valor definido en el servidor, no debe estar comentado(#), o no debe estar vació\n+-------------------------------------------------------------------------------------+\n\ncat /etc/ssh/sshd_config | grep -i MaxAuthTries",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n## LINUX\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS - LINUX - \n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/${user^^}/sshd_config_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas - LINUX -\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/${user,,}/sshd_config_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup en HOME - AIX -\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/$user/sshd_config_`date +%d%m%y_%T`",
        "editar": "+-------------------------------------------------------------------------------------+\n## Añadir el valor 5, al parámetro MaxAuthTries\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Debe quedar algo asi:\n\nMaxAuthTries 5\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Editar\n+-------------------------------------------------------------------------------------+\n\nvi /etc/ssh/sshd_config",
        "refrescar": "+-------------------------------------------------------------------------------------+\n## LINUX\n+-------------------------------------------------------------------------------------+\n\nsystemctl stop sshd\nsystemctl start sshd\n\n+-------------------------------------------------------------------------------------+\n## AIX\n+-------------------------------------------------------------------------------------+\n\nstopsrc -s sshd;sleep 2;startsrc -s sshd",
        "evidencia": "+-------------------------------------------------------------------------------------+\n## LINUX / AIX\n+-------------------------------------------------------------------------------------+\nclear\ndate\nhostname\n/usr/sbin/sshd -T|grep -i MaxAuthTries\ncat /etc/ssh/sshd_config | grep -i MaxAuthTries",
        "SO": "Linux / Aix"
    },
    {
        "modulo": "Password Requirements//etc/profile IBMsinit sh",
        "clave": "TMOUT IBMSINIT.SH",
        "descripcion": "/etc/profile should not set/reset the time out control after '. /etc/profile.d/IBMsinit.sh' invocation.\n\n/etc/profile must trigger an invocation of '. /etc/profile.d/IBMsinit.sh', and does not set/reset the time out control after that invocation.",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## No deben existir 2 controles TMOUT en el servidor.\n\n## Revisar en /etc/profile, si tiene un TMOUT definido, se debe quitar\n\n## Si no existe la llamada a a IBMSinit.sh, se debe añadir\n+-------------------------------------------------------------------------------------+\n\ncat /etc/profile | egrep -i \"TMOUT|IBMsinit.sh\"\n\n+-------------------------------------------------------------------------------------+\n## En /etc/profile.d/IBMsinit.sh, al final del SCRIPT de UMASK\n## Debe tener un TMOUT:\n+-------------------------------------------------------------------------------------+\n\ncat /etc/profile.d/IBMsinit.sh",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/profile.d/IBMsinit.sh /home/${user^^}/IBMsinit.sh_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/profile.d/IBMsinit.sh /home/${user,,}/IBMsinit.sh_`date +%d%m%y_%T`\n",
        "editar": "+-------------------------------------------------------------------------------------+\n## Eliminar/Comentar la entrada TMOUT en /etc/profile.\n\n## Añadir '. /etc/profile.d/IBMsinit.sh', por debajo de un UMASK\n+-------------------------------------------------------------------------------------+\n\nvi /etc/profile",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\ncat /etc/profile | egrep -i \"TMOUT|IBMSinit.sh\"\ncat /etc/profile.d/IBMsinit.sh",
        "SO": "Linux"
    },
    {
        "modulo": "Password Requirements/Automatic Logoff IBMsinit sh TMOUT",
        "clave": "TMOUT",
        "descripcion": "/etc/profile.d/IBMsinit.sh Default: Set systems to terminate a session after 21600 seconds of inactivity. File must  contain \"TMOUT=21600\" followed by \"export TMOUT\". A shorter time frame may be specified.",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## En /etc/profile.d/IBMsinit.sh, al final del SCRIPT de UMASK\n## Debe tener un TMOUT\n(\"TMOUT solo debe estar implementado en 'IBMsinit.sh'\")\n+-------------------------------------------------------------------------------------+\n\ncat /etc/profile.d/IBMsinit.sh\n\n+-------------------------------------------------------------------------------------+\n## SET muestra el valor por defecto\n+-------------------------------------------------------------------------------------+\n\nset | grep OUT",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/profile.d/IBMsinit.sh /home/${user^^}/IBMsinit.sh_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/profile.d/IBMsinit.sh /home/${user,,}/IBMsinit.sh_`date +%d%m%y_%T`\n",
        "editar": "+-------------------------------------------------------------------------------------+\n## Editar y Añadir al final del SCRIPT de UMASK\n+-------------------------------------------------------------------------------------+\n\nvi /etc/profile.d/IBMsinit.sh\n\nTMOUT=21600\nexport TMOUT",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\ncat /etc/profile.d/IBMsinit.sh\nset | grep OUT",
        "SO": "Linux"
    },
    {
        "modulo": "Password Requirements/Automatic Logoff support shells",
        "clave": "SHELL LOGINS",
        "descripcion": "/usr/bin/tmux.\n/bin/tmux.\nEnsure that /etc/shells only allows users to select shells which support time out.",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Si los shells están indicados como desaparecidos, añádalos a /etc/shells.\n## Si cualquier shell se indica como no conforme, elimínelas.\n+-------------------------------------------------------------------------------------+\n\ncat /etc/shells | grep -i tmux",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/shells /home/${user^^}/shells_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/shells /home/${user,,}/shells__`date +%d%m%y_%T`\n",
        "editar": "+-------------------------------------------------------------------------------------+\n## Comentar las shells que no dan soporte a time out\n+-------------------------------------------------------------------------------------+\n\nvi /etc/shells",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\ncat /etc/shells | grep -i tmux\n",
        "SO": "Linux"
    },
    {
        "modulo": "Password Requirements/Login Retries",
        "clave": "PAM_TALLY",
        "descripcion": "Non of the Login Retrie options was found in file:\n/etc/pam.d/password-auth\n/etc/pam.d/system-auth",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Hace referencia al 'pam_tally2.so' en RHEL 7, y al 'pam_faillock.so'  en RHEL 8.\n+-------------------------------------------------------------------------------------+\n\n## Saber que versión de RHEL es:\ncat /etc/*release\n\n#-*** Saber que PAM_TALLY USA (RHEL 7) ****-#\nls -ltr /lib64/security/pam_tally*\n\n#-*** Saber que PAM_FAILLOCK USA (RHEL 8) ****-#\nls -la /usr/sbin/faillock\n\n+-------------------------------------------------------------------------------------+\n##--- RHEL 7('system-auth','password-auth')\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Los ficheros del PAM, deben tener los parámetros:\n\n## - `auth        required      pam_tally2.so deny=5`\n## - `account     required      pam_tally2.so`\n+-------------------------------------------------------------------------------------+\n\ncat /etc/pam.d/system-auth | grep pam_tally\ncat /etc/pam.d/password-auth | grep pam_tally\n\n+-------------------------------------------------------------------------------------+\n##--- RHEL 8 ('system-auth','password-auth')\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Los ficheros del PAM, deben tener los parámetros:\n\n## - `auth        required        pam_faillock.so preauth silent deny=5 unlock_time=0`\n## - `auth        [default=die] pam_faillock.so authfail deny=5 unlock_time=0`\n\n## - `account     required      pam_faillock.so`\n+-------------------------------------------------------------------------------------+\n\ncat /etc/pam.d/system-auth | grep pam_faillock.so\ncat /etc/pam.d/password-auth | grep pam_faillock.so\n\n",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/pam.d/system-auth /home/${user^^}/system-auth_`date +%d%m%y_%T`\n\ncp -p /etc/pam.d/password-auth /home/${user^^}/password-auth_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/pam.d/system-auth /home/${user,,}/system-auth_`date +%d%m%y_%T`\n\ncp -p /etc/pam.d/password-auth /home/${user,,}/password-auth_`date +%d%m%y_%T`\n",
        "editar": "+-------------------------------------------------------------------------------------+\n##--- RHEL 7 ('system-auth','password-auth')\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Añadir en el modulo 'auth required', el parámetro 'pam_tally2.so'\n## Se debe añadir en la primero linea del modulo auth\n## ('se aconseja remplazar la linea del modulo')\n+-------------------------------------------------------------------------------------+\n\nvi /etc/pam.d/system-auth\n\nauth        required      pam_tally2.so deny=5\n\n+-------------------------------------------------------------------------------------+\n## Añadir en el modulo 'account required', el parámetro 'pam_tally2.so'.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Se debe añadir en la primera linea del modulo account.\n## ('se aconseja remplazar la linea del modulo').\n+-------------------------------------------------------------------------------------+\n\naccount     required      pam_tally2.so\n\n+-------------------------------------------------------------------------------------+\n## Lo mismo con 'password-auth'\n+-------------------------------------------------------------------------------------+\n\nvi /etc/pam.d/password-auth\n\n+-------------------------------------------------------------------------------------+\n##--- RHEL 8 ('system-auth','password-auth')\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Añadir en el modulo 'auth required', el parámetro 'pam_faillock.so'\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Se debe añadir en la primera linea del modulo auth.\n## ('se aconseja remplazar la linea del modulo').\n+-------------------------------------------------------------------------------------+\n\nvi /etc/pam.d/system-auth\n\nauth        required        pam_faillock.so preauth silent deny=5 unlock_time=0\n\n+-------------------------------------------------------------------------------------+\n## Ademas se debe añadir la siguiente linea, por encima de 'auth required pam_deny.so'\n+-------------------------------------------------------------------------------------+\n\nauth        [default=die] pam_faillock.so authfail deny=5 unlock_time=0\n\n+-------------------------------------------------------------------------------------+\n## Añadir en el modulo 'account required', el parámetro 'pam_faillock.so'.\n## Se debe añadir en la primera linea del modulo account.\n## ('se aconseja remplazar la linea del modulo').\n+-------------------------------------------------------------------------------------+\n\naccount     required      pam_faillock.so\n\n+-------------------------------------------------------------------------------------+\n## Lo mismo con 'password-auth'\n+-------------------------------------------------------------------------------------+\n\nvi /etc/pam.d/password-auth\n\n",
        "refrescar": null,
        "evidencia": "+-------------------------------------------------------------------------------------+\n##--- RHEL 7('system-auth','password-auth')\n+-------------------------------------------------------------------------------------+\nclear\ndate;hostname\ncat /etc/*release | grep -i release\ncat /etc/pam.d/system-auth | egrep \"pam_tally\" \ncat /etc/pam.d/password-auth | egrep \"pam_tally\"\n\n+-------------------------------------------------------------------------------------+\n##--- RHEL 8 ('system-auth','password-auth')\n+-------------------------------------------------------------------------------------+\nclear\ndate;hostname\ncat /etc/*release | grep -i release\ncat /etc/pam.d/system-auth | egrep \"pam_faillock\" \ncat /etc/pam.d/password-auth | egrep \"pam_faillock\"",
        "SO": "Linux"
    },
    {
        "modulo": "Password Requirements/Password MIN Length and complexity",
        "clave": "MINLEN",
        "descripcion": "Incorrect System Default minimum password length or password complexity rules. Minimum password length should be set to 8 or more secure, in file \n/etc/pam.d/password-auth\n/etc/pam.d/system-auth.\nIt should be set through pam_cracklib.so or pam_pwquality.so. For more information about password length or password complexity rules see matrix coverage document.",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Hace referencia al 'minlen' en RHEL 7 y RHEL 8.\n+-------------------------------------------------------------------------------------+\n\n## Saber que versión de RHEL es:\ncat /etc/*release\n\n#-***# Saber que PAM_TALLY USA (RHEL 7)#****-#\nls -ltr /lib64/security/pam_tally*\n\n#-*** Saber que PAM_FAILLOCK USA (RHEL 8)****-#\nls -la /usr/sbin/faillock\n\n+-------------------------------------------------------------------------------------+\n##--- RHEL 7 & RHEL 8 ('system-auth','password-auth')\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Los ficheros del PAM para RHEL 7, deben tener en el modulo 'password    required      pam_cracklib.so', el parámetro 'minlen=15'\n+-------------------------------------------------------------------------------------+\n\ncat /etc/pam.d/system-auth | grep minlen\ncat /etc/pam.d/password-auth | grep minlen\n\n+-------------------------------------------------------------------------------------+\n## Los ficheros del PAM para RHEL 8, deben tener en el modulo 'password    required      pam_pwquality.so', el parámetro 'minlen=15'\n+-------------------------------------------------------------------------------------+\n\ncat /etc/pam.d/system-auth | grep minlen\ncat /etc/pam.d/password-auth | grep minlen",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/pam.d/system-auth /home/${user^^}/system-auth_`date +%d%m%y_%T`\n\ncp -p /etc/pam.d/password-auth /home/${user^^}/password-auth_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/pam.d/system-auth /home/${user,,}/system-auth_`date +%d%m%y_%T`\n\ncp -p /etc/pam.d/password-auth /home/${user,,}/password-auth_`date +%d%m%y_%T`",
        "editar": "+-------------------------------------------------------------------------------------+\n##--- RHEL 7 & RHEL 8 ('system-auth','password-auth')\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Añadir en el modulo 'password    required      pam_cracklib.so', el parámetro 'minlen=15'.\n## ('se aconseja remplazar toda la linea, del modulo 'password    required      pam_cracklib.so', por encima de un modulo ' password    sufficient pam_unix.so').\n+-------------------------------------------------------------------------------------+\n\nvi /etc/pam.d/system-auth\n\n+-------------------------------------------------------------------------------------+\n--- RHEL 7\n+-------------------------------------------------------------------------------------+\n\npassword    required      pam_cracklib.so try_first_pass retry=3 minlen=15 dcredit=-1 ucredit=0 lcredit=-1 ocredit=0 reject_username\n\n+-------------------------------------------------------------------------------------+\n--- RHEL 8\n+-------------------------------------------------------------------------------------+\n\npassword    required      pam_pwquality.so try_first_pass retry=3 minlen=15 dcredit=-1 ucredit=0 lcredit=-1 ocredit=0 reject_username enforce_for_root\n\n+-------------------------------------------------------------------------------------+\n## Lo mismo con 'password-auth'\n+-------------------------------------------------------------------------------------+\n\nvi /etc/pam.d/password-auth",
        "refrescar": null,
        "evidencia": "clear\ndate;hostname\ncat /etc/*release | grep -i release\ncat /etc/pam.d/system-auth | egrep \"minlen\" \ncat /etc/pam.d/password-auth | egrep \"minlen\"",
        "SO": "Linux"
    },
    {
        "modulo": "Password Requirements/Password shadow specification",
        "clave": "EMPTY",
        "descripcion": "Account: $account have \"empty\" (null) password. In /etc/shadow  password (second field) cannot be assigned the null value.",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Las cuentas no deben tener un valor nulo, en el segundo campo de /etc/shadow\n## Valida para todas las cuentas, ya sean /C/F/S/\n+-------------------------------------------------------------------------------------+\n\naccount=\"\"\n\ncat /etc/shadow | grep $account",
        "copia": null,
        "editar": "+-------------------------------------------------------------------------------------+\n## Añadir el valor ya sea `!, !!, *`, a la cuenta en el segundo campo.\n## Hay que remplazar $account, por la cuenta a corregir.\n+-------------------------------------------------------------------------------------+\n\npasswd -l $account\n",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\ncat /etc/shadow | grep \"$account\"\n",
        "SO": "Linux"
    },
    {
        "modulo": "IZ.1.9.1.3 Protecting Resources - User Resources",
        "clave": "UMASK IBMSINIT.SH",
        "descripcion": "File /etc/profile.d/IBMsinit.sh must exist, be readable by all users, and contain at least:\nif [ $UID -gt 199 ]; then\numask 077\nfi",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Igual al MODULO : \n+-------------------------------------------------------------------------------------+\n\nAD.1.9.1.3 Protecting Resources - User Resources",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/profile.d/IBMsinit.sh /home/${user^^}/IBMsinit.sh_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/profile.d/IBMsinit.sh /home/${user,,}/IBMsinit.sh_`date +%d%m%y_%T`",
        "editar": "+-------------------------------------------------------------------------------------+\n## Creamos fichero y asignamos los permisos correctos.\n+-------------------------------------------------------------------------------------+\n\ntouch /etc/profile.d/IBMsinit.sh\nchmod 0755 /etc/profile.d/IBMsinit.sh\n\n+-------------------------------------------------------------------------------------+\n## Editar y añadir el siguiente SCRIPT:\n+-------------------------------------------------------------------------------------+\n\nvi /etc/profile.d/IBMsinit.sh\n\n#--------- begin IBMsinit.sh --------#\nif [ $UID -gt 199 ]; then\numask 077\nfi\n#--------- end IBMsinit.sh  ---------#\n\n+-------------------------------------------------------------------------------------+\n## Ademas debemos implementar la invocacion a la llamada del fichero.\n## La invocacion se implementa despues de un script de UMASK.\n+-------------------------------------------------------------------------------------+\n\nvi /etc/profile\n\n. /etc/profile.d/IBMsinit.sh",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\ncat /etc/profile.d/IBMsinit.sh\ncat /etc/profile  | grep -i  IBMsinit.sh\nls -l /etc/profile.d/IBMsinit.sh",
        "SO": "Linux"
    },
    {
        "modulo": "IZ.1.9.1.4 Protecting Resources - User Resources",
        "clave": "UMASK IBMSINIT.CSH",
        "descripcion": "File /etc/profile.d/IBMsinit.csh must exist, be readable by all users, and contain at least:\nif [ $UID -gt 199 ]; then\numask 077\nfi",
        "comprobacion": "+-------------------------------------------------------------------------------------+\n## Igual al MODULO : \n+-------------------------------------------------------------------------------------+\n\nAD.1.9.1.4 Protecting Resources - User Resources",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/profile.d/IBMsinit.csh /home/${user^^}/IBMsinit.csh_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/profile.d/IBMsinit.csh /home/${user,,}/IBMsinit.csh_`date +%d%m%y_%T`\n",
        "editar": "+-------------------------------------------------------------------------------------+\n## Creamos fichero y asignamos los permisos correctos.\n+-------------------------------------------------------------------------------------+\n\ntouch /etc/profile.d/IBMsinit.csh\nchmod 0755 /etc/profile.d/IBMsinit.csh\n\n+-------------------------------------------------------------------------------------+\n## Editar y añadir el siguiente SCRIPT:\n+-------------------------------------------------------------------------------------+\n\nvi /etc/profile.d/IBMsinit.csh\n\n#--------- end IBMsinit.csh  ---------#\nif ($uid > 199) then\n    umask 077\nendif\n#--------- end IBMsinit.csh  ---------#\n\n+-------------------------------------------------------------------------------------+\n## Ademas debemos implementar la invocacion a la llamada del fichero.\n## La invocacion se implementa en la ultima linea.\n+-------------------------------------------------------------------------------------+\n\nvi  /etc/csh.login\n\nsource /etc/profile.d/IBMsinit.csh",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\ncat /etc/profile.d/IBMsinit.csh\ncat /etc/csh.login  | grep -i  IBMsinit.csh\nls -l /etc/profile.d/IBMsinit.csh",
        "SO": "Linux"
    },
    {
        "modulo": "Encryption/Permitted Ciphers",
        "clave": "CIPHERS",
        "descripcion": "Cipher aes128-ctr is not available\nCipher aes192-ctr is not available\nCipher aes256-ctr is not available",
        "comprobacion": "## Antes de corregir se debe comprobar que no estén los valores correctos por defecto\n\n+-------------------------------------------------------------------------------------+\n## Valor por defecto correcto es : \n## ciphers aes128-ctr,aes192-ctr,aes256-ctr,chacha20-poly1305@openssh.com,aes128-gcm@openssh.com,aes256-gcm@openssh.com\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Muestra el valor por defecto\n+-------------------------------------------------------------------------------------+\n\n/usr/sbin/sshd -T|grep -i ciphers\n\n+-------------------------------------------------------------------------------------+\n## Valor definido en el servidor, no debe estar comentado(#), o no debe estar vació\n+-------------------------------------------------------------------------------------+\n\ncat /etc/ssh/sshd_config | grep -i ciphers\n\n+-------------------------------------------------------------------------------------+\n-- Si es un RHEL 8\n## Se debe comprobar que este descomentado la linea : CRYPTO_POLICY\n+-------------------------------------------------------------------------------------+\n\ncat /etc/*release\ncat /etc/sysconfig/sshd | grep CRYPTO_POLICY\n",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n## LINUX\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/${user^^}/sshd_config_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n--- RHEL 8, con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/sysconfig/sshd /home/${user^^}/sshd._`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/${user,,}/sshd_config_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n--- RHEL 8, con HOME en minúscula\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/sysconfig/sshd /home/${user,,}/sshd._`date +%d%m%y_%T`\n\n\n## AIX\n+-------------------------------------------------------------------------------------+\n## Backup\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/$user/sshd_config_`date +%d%m%y_%T`\n",
        "editar": "+-------------------------------------------------------------------------------------+\n## Añadir mínimo estos 3 cifrados POR DELANTE, `Ciphers aes128-ctr,aes192-ctr,aes256-ctr`\n\n## Debe estar debajo de: \n## Ciphers and keying\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Editar, Añadir o Remplazar (se recomienda, remplazar la linea): \n\nCiphers aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com,chacha20-poly1305@openssh.com\n+-------------------------------------------------------------------------------------+\n\nvi /etc/ssh/sshd_config\n\n+-------------------------------------------------------------------------------------+\n## Para RHEL 8, Editar Y Descomentar CRYPTO_POLICY=\n+-------------------------------------------------------------------------------------+\n\nvi /etc/sysconfig/sshd\n",
        "refrescar": "+-------------------------------------------------------------------------------------+\n## LINUX\n+-------------------------------------------------------------------------------------+\n\nsystemctl stop sshd\nsystemctl start sshd\n\n+-------------------------------------------------------------------------------------+\n## AIX\n+-------------------------------------------------------------------------------------+\n\nstopsrc -s sshd;sleep 2;startsrc -s sshd\n",
        "evidencia": "+-------------------------------------------------------------------------------------+\n## LINUX / AIX\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\n/usr/sbin/sshd -T|grep -i ciphers\ncat /etc/ssh/sshd_config | grep -i ciphers\n\n+-------------------------------------------------------------------------------------+\n--- RHEL 8\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\n/usr/sbin/sshd -T|grep -i ciphers\ncat /etc/ssh/sshd_config | grep -i ciphers\ncat /etc/sysconfig/sshd | grep CRYPTO_POLICY\nsystemctl status sshd\n",
        "SO": "Linux / Aix"
    },
    {
        "modulo": "Logging/Log Verbosity Shared ID",
        "clave": "LOGLEVEL",
        "descripcion": "Config File: /etc/ssh/sshd_config; Invalid setting (value: !default!) in parameter 'LogLevel': must be set to VERBOSE or higher.",
        "comprobacion": "## Antes de corregir se debe comprobar que no estén los valores correctos por defecto\n\n+-------------------------------------------------------------------------------------+\n## Valor por defecto correcto es : \nINFO\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Muestra el valor por defecto\n+-------------------------------------------------------------------------------------+\n\n/usr/sbin/sshd -T|grep -i loglevel\n\n+-------------------------------------------------------------------------------------+\n## Valor definido en el servidor, no debe estar comentado(#), o no debe estar vació\n+-------------------------------------------------------------------------------------+\n\ncat /etc/ssh/sshd_config | grep -i loglevel",
        "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n## LINUX\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/${user^^}/sshd_config_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/${user,,}/sshd_config_`date +%d%m%y_%T`\n\n\n## AIX\n+-------------------------------------------------------------------------------------+\n## Backup\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/$user/sshd_config_`date +%d%m%y_%T`",
        "editar": "+-------------------------------------------------------------------------------------+\n## Editar y añadir LogLevel INFO, si esta comentado (#), descomentar \n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Debe quedar algo asi:\n\nLogLevel INFO\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Editar\n+-------------------------------------------------------------------------------------+\n\nvi /etc/ssh/sshd_config",
        "refrescar": "+-------------------------------------------------------------------------------------+\n## LINUX\n+-------------------------------------------------------------------------------------+\n\nsystemctl stop sshd\nsystemctl start sshd\n\n+------------------------------------------------------------------------------------+\n## AIX\n+-------------------------------------------------------------------------------------+\n\nstopsrc -s sshd;sleep 2;startsrc -s sshd",
        "evidencia": "clear\ndate\nhostname\n/usr/sbin/sshd -T|grep -i loglevel\ncat /etc/ssh/sshd_config | grep -i loglevel",
        "SO": "Linux / Aix"
    },
    {
        "modulo": "E.1.5.22.4 Network Settings",
        "clave": "SENDMAIL",
        "descripcion": "Entry in /etc/rc.tcpip must be removed or disabled. : service sendmail",
        "comprobacion": "grep -i sendmail /etc/rc.tcpip|grep -v ^#",
        "copia": null,
        "editar": "chrctcp -d sendmail",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\ngrep -i sendmail /etc/rc.tcpip|grep -v ^#",
        "SO": "Aix"
    }
]

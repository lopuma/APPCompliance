[
    {
        "modulo": "Protecting Resources-OSRs/Log File Restrictions",
        "clave": "WTMP",
        "descripcion": "Invalid Permissions or Ownership for log file: /var/log/wtmp;   -rw-rw-r--.;  owner:  root;   group:  utmp. For more information see rule description.",
        "comprobacion": "## Se le debe quitar W al grupo.\n\n+-------------------------------------------------------------------------------+\n## Comprobar que en logrotate.conf, tenga permisosa 0644\n+-------------------------------------------------------------------------------+\n\ncat /etc/logrotate.conf | grep -w wtmp -A4",
        "copia": "+-------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------+\n\ncp -p /etc/logrotate.conf /home/${user^^}/logrotate.conf_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------+\n\ncp -p /etc/logrotate.conf /home/${user,,}/logrotate.conf_`date +%d%m%y_%T`",
        "editar": "+-------------------------------------------------------------------------------+\n## Quitar permisos\n+-------------------------------------------------------------------------------+\n\nchmod g-w /var/log/wtmp\n\n+-------------------------------------------------------------------------------+\n## Dejar esta linea para REHL 7:\n+-------------------------------------------------------------------------------+\n\n## Editar:\n\nvi /lib/tmpfiles.d/var.conf\n\n## Debe quedar la linea asi:\n\nf /var/log/wtmp 0644 root utmp -\n\n+-------------------------------------------------------------------------------+\n## Dejar esta linea para REHL 6\n+-------------------------------------------------------------------------------+\n\n## Editar:\n\nvi /etc/rc.sysinit\n\n## Dejar la linea asi:\n\nchmod 0644 /var/run/utmp /var/log/wtmp\n\n+-------------------------------------------------------------------------------+\n## Corregir los permisos en logrotate.conf, en create de wtmp\n+-------------------------------------------------------------------------------+\n\nvi /etc/logrotate.conf\n\n+-------------------------------------------------------------------------------+\n## Modificar los permisos de 0664, a 0644, al fichero /var/log/wtmp\n+-------------------------------------------------------------------------------+",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\nls -la /var/log/wtmp\ncat /lib/tmpfiles.d/var.conf | grep -w wtmp\ncat /etc/logrotate.conf | grep -w wtmp -A4",
        "SO": "Linux"
    },
    {
        "modulo": "protecting Resources-OSRs/SUDO Command WW Permissions",
        "clave": "COMMAND",
        "descripcion": "Invalid WW permissions for command file/directory: $fdSUDO  Permissions: drwxr-xrwx  Permissions for OTHER must be set to r-x or more stringent.",
        "comprobacion": "+-------------------------------------------------------------------------------+\n## Cambiar permisos al fichero/directorio del comando que se ejecuta en SUDOERS\n## Antes de seguir, buscar el file/directory en - * COMMAND * -\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Localizar la plantilla de SUDO, que tenga implementada el file/directory\n## Debemos mirar en la plantilla, si el file/directory, no se crean con los permisos de W en OTHER\n+-------------------------------------------------------------------------------+\n\ncd /etc/sudoers.d/\n\ngrep -i \"$fdSUDO\" *\n\n## Hacer un cat de la plantilla de SUDO, y comprobar que no tenga un comando para crear permisos w en other.\n\n+-------------------------------------------------------------------------------+\n## Comprobar los permisos del file/directory:\n## No deben tener permisos de ESCRITURA en  OTHER\n## Si es de tipo /C/, se debe excepcionar: revisar RISK e IMPACT\n+-------------------------------------------------------------------------------+\n\nls -ld $fdSUDO",
        "copia": null,
        "editar": "+-------------------------------------------------------------------------------+\n## Quitar permisos de W a other al file/directory de SUDO\n+-------------------------------------------------------------------------------+\n\nchmod o-w $fdSUDO",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\nls -ld $fdSUDO",
        "SO": "Linux"
    },
    {
        "modulo": "Business Use Notice/Business Use Notice Required",
        "clave": "BUN",
        "descripcion": "Missing or Incorrect Business Use Notice. It should be set in /etc/motd",
        "comprobacion": "##Debe tener el BUN actual.",
        "copia": null,
        "editar": "vi /etc/motd\n\n##añadir / remplazar :\n\nAdvertencia Legal\nEn cumplimiento de la Ley Organica de Proteccion de Datos de Caracter Personal 15/99, los datos de caracter personal extraidos de los Sistemas de Informacion estan sujetos a las siguientes consideraciones:\n- Solo se utilizaran para el proposito indicado en el objeto de la extraccion.\n- Se eliminaran fisicamente de cualquier soporte personal en que se hayan almacenados una vez finalizada la tarea para la que fueron extraidos.\n- No se extraeran de las instalaciones fisicas donde residen.\nORANGE ESPAGNE informa al empleado que los recursos informaticos puestos a su disposicion, tales como correo electronico y acceso a Internet, son una herramienta de trabajo facilitada por Orange, por lo que su uso estara limitado a las funciones asociadas al desarrollo de la actividad profesional del usuario.\nEs responsabilidad del usuario de los Sistemas de Informacion el cumplimiento de las consideraciones indicadas.",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\ncat /etc/motd",
        "SO": "Linux"
    },
    {
        "modulo": "Encryption/Password Encryption Required",
        "clave": "SHA512",
        "descripcion": "/etc/pam.d/password-auth.\n/etc/pam.d/system-auth.\nAny file in /etc/pam.d containing \"password sufficient pam_unix.so\" stanza must carry the \"sha512 shadow\" options.\n\nIncorrect or missing pam_unix.so module stanza. For more information see coverage matrix document",
        "comprobacion": "+-------------------------------------------------------------------------------+\n## Hace referencia al parametro 'sha512 shadow ' en RHEL7 y RHEL8.\n+-------------------------------------------------------------------------------+\n\n## Saber que versión de RHEL es:\ncat /etc/*release\n\n#-*** Saber que PAM_TALLY USA ****-#\nls -ltr /lib64/security/pam_tally*\n\n#-*** Saber que PAM_FAILLOCK USA ****-#\nls -la /usr/sbin/faillock\n\n+-------------------------------------------------------------------------------+\n##--- RHEL 7 & RHEL 8 ('system-auth','password-auth')\n## Los ficheros del PAM, deben tener en el modulo 'password    sufficient    pam_unix.so', el parámetro 'sha512 shadow '\n## Ademas deben ser LINK de 'system-auth-ac', 'password-auth-ac'.\n+-------------------------------------------------------------------------------+\n\ncat /etc/pam.d/system-auth | egrep \"sha512|shadow\"\ncat /etc/pam.d/password-auth | egrep \"sha512|shadow\"\nls -la /etc/pam.d/system-auth\nls -la /etc/pam.d/password-auth\n\n+-------------------------------------------------------------------------------+\n## Ficheros del pam.d, que no son editables, y se pueden mover al home.\n## Ficheros .ori, .bck, .backup, o todo aquel que sea una copia de, 'system-auth', 'password-auth', o de 'system-auth-ac', 'password-auth-ac'\n+-------------------------------------------------------------------------------+\ncd /etc/pam.d/\nls -la system-*\nls -la password-*\n\n+-------------------------------------------------------------------------------+\n## Mover los backups al home, y hacer link entre 'system-auth' y 'system-auth-ac', o 'password-auth' y 'password-auth-ac', si es necesario:\n+-------------------------------------------------------------------------------+\n\nrm -r system-auth\nln -s system-auth-ac system-auth\n\nrm -r password-auth\nln -s password-auth-ac password-auth\n\n+-------------------------------------------------------------------------------+\n## Modulo similiar : 'Password Requirements/Password History'\n+-------------------------------------------------------------------------------+",
        "copia": "+-------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------+\n\ncp -p /etc/pam.d/system-auth /home/${user^^}/system-auth_`date +%d%m%y_%T`\n\ncp -p /etc/pam.d/password-auth /home/${user^^}/password-auth_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------+\n\ncp -p /etc/pam.d/system-auth /home/${user,,}/system-auth_`date +%d%m%y_%T`\n\ncp -p /etc/pam.d/password-auth /home/${user,,}/password-auth_`date +%d%m%y_%T`\n",
        "editar": "+-------------------------------------------------------------------------------+\n##--- RHEL 7 & RHEL 8 ('system-auth','password-auth')\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Añadir en el modulo 'password    sufficient    pam_unix.so', el parámetro 'sha512 shadow'.\n## ('se aconseja remplazar toda la linea, del modulo 'password    sufficient    pam_unix.so').\n+-------------------------------------------------------------------------------+\n\nvi /etc/pam.d/system-auth\n\npassword    sufficient    pam_unix.so remember=5 use_authtok sha512 shadow try_first_pass\n\n+-------------------------------------------------------------------------------+\n## Lo mismo con 'password-auth'\n+-------------------------------------------------------------------------------+\n\nvi /etc/pam.d/password-auth\n",
        "refrescar": null,
        "evidencia": "+-------------------------------------------------------------------------------+\n##--- RHEL 7 & RHEL 8 ('system-auth','password-auth')\n+-------------------------------------------------------------------------------+\nclear\ndate;hostname\ncat /etc/*release | grep -i release\ncat /etc/pam.d/system-auth | egrep \"sha512|shadow\"\ncat /etc/pam.d/password-auth | egrep \"sha512|shadow\"\n",
        "SO": "Linux"
    },
    {
        "modulo": "Password Requirements/Acceptance of the null password with nullok parameter",
        "clave": "NULLOK",
        "descripcion": "PAM service: '/etc/pam.d/password-auth', '/etc/pam.d/system-auth'   use pam_unix.so auth module with \"nullok\" parameter. This parameter is forbidden as it allows acceptance of the null password.",
        "comprobacion": "+-------------------------------------------------------------------------------+\n## Hace referencia al parametro 'nullok' en RHEL7 y RHEL8.\n+-------------------------------------------------------------------------------+\n\n## Saber que versión de RHEL es:\ncat /etc/*release\n\n+-------------------------------------------------------------------------------+\n##--- RHEL 7 & RHEL 8 ('system-auth','password-auth')\n## Los ficheros del PAM, NO deben tener en el parametro 'nullok', en los diferentes modulos\n+-------------------------------------------------------------------------------+\n\ncat /etc/pam.d/system-auth | grep \"nullok\"\ncat /etc/pam.d/password-auth | grep \"nullok\"",
        "copia": "+-------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------+\n\ncp -p /etc/pam.d/system-auth /home/${user^^}/system-auth_`date +%d%m%y_%T`\n\ncp -p /etc/pam.d/password-auth /home/${user^^}/password-auth_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------+\n\ncp -p /etc/pam.d/system-auth /home/${user,,}/system-auth_`date +%d%m%y_%T`\n\ncp -p /etc/pam.d/password-auth /home/${user,,}/password-auth_`date +%d%m%y_%T`",
        "editar": "+-------------------------------------------------------------------------------+\n##--- RHEL 7 & RHEL 8 ('system-auth','password-auth')\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Eliminar el parametro 'nullok', en los diferentes modulos del pam.d.\n+-------------------------------------------------------------------------------+\n\nvi /etc/pam.d/system-auth\n\n+-------------------------------------------------------------------------------+\n## Lo mismo con 'password-auth'\n+-------------------------------------------------------------------------------+\n\nvi /etc/pam.d/password-auth\n",
        "refrescar": null,
        "evidencia": "clear\ndate;hostname\ncat /etc/*release | grep -i release\ncat /etc/pam.d/system-auth | grep \"nullok\"\ncat /etc/pam.d/password-auth | grep \"nullok\"\n",
        "SO": "Linux"
    },
    {
        "modulo": "Network Settings/TCP Configuration Files Restrictions",
        "clave": "SYSCTL",
        "descripcion": "Incorrect /etc/sysctl.conf",
        "comprobacion": "+-------------------------------------------------------------------------------+\n##  Para servidores de con servicio RAC para BBDD, se debe excepcionar\n\n## Revisar RISK e IMPACT:\n\nGENERICO / SYSCTL / FT\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+## Servidores con servicios RAC para BBDD:\n+-------------------------------------------------------------------------------+\n\n- AOTLXPRPRT10003\n",        "copia": null,
        "editar": "+-------------------------------------------------------------------------------+\n## Para hacer el cambio:\n+-------------------------------------------------------------------------------+\n\n/sbin/sysctl -w net.ipv4.conf.all.secure_redirects=0\n/sbin/sysctl -w net.ipv4.conf.default.secure_redirects=0\n/sbin/sysctl -w net.ipv4.conf.all.log_martians=1\n/sbin/sysctl -w net.ipv4.conf.default.log_martians=1\n/sbin/sysctl -w net.ipv4.conf.all.rp_filter=1\n/sbin/sysctl -w net.ipv4.conf.default.rp_filter=1\n/sbin/sysctl -w net.ipv6.conf.all.accept_ra=0\n/sbin/sysctl -w net.ipv6.conf.default.accept_ra=0\n/sbin/sysctl -w net.ipv6.conf.all.accept_redirects=0\n/sbin/sysctl -w net.ipv6.conf.default.accept_redirects=0\n/sbin/sysctl -w net.ipv4.ip_forward=0\n/sbin/sysctl -w net.ipv4.conf.default.accept_source_route=0\n/sbin/sysctl -w net.ipv4.conf.all.accept_source_route=0",
        "refrescar": "sysctl -p",
        "evidencia": "clear\ndate\nhostname\n/sbin/sysctl -a |grep -i \"net.ipv4.conf.all.accept_source_route\"\n/sbin/sysctl -a |grep -i \"net.ipv4.conf.all.secure_redirects\"\n/sbin/sysctl -a |grep -i \"net.ipv4.conf.default.secure_redirects\"\n/sbin/sysctl -a |grep -i \"net.ipv4.conf.all.log_martians\"\n/sbin/sysctl -a |grep -i \"net.ipv4.conf.default.log_martians\"\n/sbin/sysctl -a |grep -i \"net.ipv4.conf.all.rp_filter\"\n/sbin/sysctl -a |grep -i \"net.ipv4.conf.default.rp_filter\"\n/sbin/sysctl -a |grep -i \"net.ipv4.conf.default.accept_source_route\"\n/sbin/sysctl -a |grep -i \"net.ipv6.conf.all.accept_ra\"\n/sbin/sysctl -a |grep -i \"net.ipv6.conf.default.accept_ra\"\n/sbin/sysctl -a |grep -i \"net.ipv6.conf.all.accept_redirects\"\n/sbin/sysctl -a |grep -i \"net.ipv6.conf.default.accept_redirects\"\n/sbin/sysctl -a |grep -i \"net.ipv4.ip_forward\"",
        "SO": "Linux"
    },
    {
        "modulo": "Password Requirements/SSH PermitRootLogin Restriction",
        "clave": "PERMITROOTLOGIN",
        "descripcion": "Invalid setting (value: yes) for sshd (processPID: 4714) in parameter 'PermitRootLogin': must be set to one of 'no', 'without-password', 'nopwd', 'forced-commands-only', 'prohibit-password'.",
        "comprobacion": "## Antes de corregir se debe comprobar que no estén los valores correctos por defecto o no este excepcionado el parametro para dicho servidor\n\n+-------------------------------------------------------------------------------+\n## Valor por defecto correcto es : No\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Muestra el valor por defecto\n+-------------------------------------------------------------------------------+\n\n/usr/sbin/sshd -T|grep -i PermitRootLogin\n\n+-------------------------------------------------------------------------------+\n## Valor definido en el servidor, no debe estar comentado(#), o no debe estar vació\n+-------------------------------------------------------------------------------+\n\ncat /etc/ssh/sshd_config | grep -i PermitRootLogin",
        "copia": "+-------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n## LINUX\n+-------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/${user^^}/sshd_config_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/${user,,}/sshd_config_`date +%d%m%y_%T`",
        "editar": "+-------------------------------------------------------------------------------+\n## Añadir el valor No, al parámetro PermitRootLogin\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Debe quedar algo asi:\n\nPermitRootLogin No\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Editar\n+-------------------------------------------------------------------------------+\n\nvi /etc/ssh/sshd_config",
        "refrescar": "+-------------------------------------------------------------------------------+\n## LINUX\n+-------------------------------------------------------------------------------+\n\nsystemctl stop sshd\nsystemctl start sshd\n\n+-------------------------------------------------------------------------------+\n## AIX\n+-------------------------------------------------------------------------------+\n\nstopsrc -s sshd;sleep 2;startsrc -s sshd",
        "evidencia": "+-------------------------------------------------------------------------------+\n## LINUX / AIX\n+-------------------------------------------------------------------------------+\nclear\ndate\nhostname\n/usr/sbin/sshd -T|grep -i PermitRootLogin\ncat /etc/ssh/sshd_config | grep -i PermitRootLogin",
        "SO": "Linux / Aix"
    },
    {
        "modulo": "Password Requirements/Password MAX Age /etc/shadow",
        "clave": "MAXAGE",
        "descripcion": null,
        "comprobacion": null,
        "copia": null,
        "editar": null,
        "refrescar": null,
        "evidencia": null,
        "SO": "Linux"
    },
    {
        "modulo": "Password Requirements/Password MIN Age Shadow",
        "clave": "MINAGE",
        "descripcion": "Account $account has invalid Password Min Age setting of null  should be set to Customer Required Setting: 1. Account Type: Customer",
        "comprobacion": "+-------------------------------------------------------------------------------+\n## Todas las cuentas, ya sean /C/F/S, deben tener el MINAGE a 1.\n+-------------------------------------------------------------------------------+",        
        "copia": null,
        "editar": "+-------------------------------------------------------------------------------+\n## Guardamos en la variable, la cuenta a aplicar MINAGE\n## Copiar la cuenta(entre las \"\")\n+-------------------------------------------------------------------------------+\n\naccount=\"\"\n\ncat /etc/passwd | grep -i $account\n\n+-------------------------------------------------------------------------------+\n## Cambiar MIANGE a 1\n+-------------------------------------------------------------------------------+\n\nchage -m 1 $account",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\nchage -l $account\ncat /etc/passwd | grep -i $account",
        "SO": "Linux"
    },
    {
        "modulo": "Protecting Resources-OSRs/IBMsinit Permission Restriction",
        "clave": "OSRIBMSINIT",
        "descripcion": "Invalid permissions for /etc/profile.d/IBMsinit.csh, /etc/profile.d/IBMsinit.sh\nOwner: root, Group: root, Permissions: -rw-r--r--. should be for  \"other\"  of r-x, for \"group\"  of r-x",
        "comprobacion": "+-------------------------------------------------------------------------------+\n## Deben existir /etc/profile.d/IBMsinit.sh, /etc/profile.d/IBMsinit.csh y con permisos 755.\n+-------------------------------------------------------------------------------+\n\nls -l /etc/profile.d/IBMsinit.sh\nls -l /etc/profile.d/IBMsinit.csh\n\n+-------------------------------------------------------------------------------+\n## Relacionado con :\n+-------------------------------------------------------------------------------+\n\nAD.1.9.1.3 Protecting Resources - User Resources\nAD.1.9.1.4 Protecting Resources - User Resources\nProtecting Resources-User Resources//etc/profile File Restriction",
        "copia": "",
        "editar": "+-------------------------------------------------------------------------------+\n## Creamos fichero y asignamos los permisos correctos.\n+-------------------------------------------------------------------------------+\n\ntouch /etc/profile.d/IBMsinit.sh\nchmod 0755 /etc/profile.d/IBMsinit.sh\n\ntouch /etc/profile.d/IBMsinit.csh\nchmod 0755 /etc/profile.d/IBMsinit.csh\n\n",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\nls -l /etc/profile.d/IBMsinit.sh\nls -l /etc/profile.d/IBMsinit.csh",
        "SO": "Linux"
    },
    {
        "modulo": "Protecting Resources-mixed/Ensure sticky bit is set on all world-writable directories",
        "clave": "STICKY",
        "descripcion": "Sticky bit is not set on world-writable directory: $directory",
        "comprobacion": "+-------------------------------------------------------------------------------+\n## Aplica a directorios y sub-directorios\n+-------------------------------------------------------------------------------+\n\n## El desvio trata de aplicar sticky a directorios y sub-directorios, pero en este desvio corregiremos permisos de escritura en OTHER.\n\n+-------------------------------------------------------------------------------+\n## Hay que tener en cuenta el tipo de owner que pertenece, cada directorio BASE.\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Ya sea de tipo '/C/F/S'\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Si es /C/, se pasa a excepcion con RISK e IMPACT\n## por favor revisar la seccion de RISK e IMPACT\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Si es de tipo /F/S/, se debe preguntar al owner, si podemos modificar los permisos\n## Revisar ('PERMISSIONS'), antes de cualquier cambio.\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Buscar y comprobar los directorios a cambiar permisos. \n+-------------------------------------------------------------------------------+\n\n## DIRECTORIOS FORMA RECURVISA:\n\necho  \"directorios con permisos w en other : \";find $directory -type d -perm -o=wx | wc -l\nfind $directory -type d -perm -o=wx | xargs -l ls -ld\n\n## DIRECTORIOS FORMA INDIVIDUAL:\n---\nls -ld $directory\n\n+-------------------------------------------------------------------------------+\n## Pregunta RELACIONADAS\n+-------------------------------------------------------------------------------+\n\nProtecting Resources-OSRs/OSR \\TMP Files Restrictions\nProtecting Resources-OSRs/OSR \\OPT Files Restrictions\nProtecting Resources-OSRs/OSR \\ETC Restrictions\nProtecting Resources-OSRs/OSR \\VAR Files Restrictions",
        "copia": null,
        "editar": "+-------------------------------------------------------------------------------+\n## Se puede quitar de forma 'RECURSIVA' o por 'INDIVIDUAL'\n\n## $directory : es la variable del directorio raiz a cambiar permisos.\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Asi quitamos de permisos de W a Other, en los directorios('RECURSIVO'):\n+-------------------------------------------------------------------------------+\n\nfind $directory -type d -perm -o=wx -exec chmod o-w {} \\;\n\n+-------------------------------------------------------------------------------+\n## Asi quitamos permisos, de W a other de forma('INDIVIDUAL'):\n+-------------------------------------------------------------------------------+\n\nchmod o-w $directory",
        "refrescar": null,
        "evidencia": "+-------------------------------------------------------------------------------+\n## De forma ('RECURSIVA'):\n+-------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nfind $directory -type d -perm -o=wx | wc -l\nls -ld $directory\n\n+-------------------------------------------------------------------------------+\n## De forma ('INDIVIDUAL'):\n+-------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -ld $directory",
        "SO": "Linux"
    },
    {
        "modulo": "System Settings/SELinux AppArmor install requirement",
        "clave": "SELINUX",
        "descripcion": "SELinux or AppArmor should be installed and enabled",
        "comprobacion": "\n## 2 - DOC, Revisar RISK e IMPACT",
        "copia": null,
        "editar": null,
        "refrescar": null,
        "evidencia": null,
        "SO": "Linux"
    },
    {
        "modulo": "Protecting Resources-OSRs/OSR /VAR Files Restrictions",
        "clave": "OSRVAR",
        "descripcion": "Invalid permissions for $fileVAR  Octal permissions: 0777  Text Permissions: -rwxrwxrwx;  May not have execute permissions on any files and no write for others.",
        "comprobacion": "+-------------------------------------------------------------------------------+\n## Aplica a ficheros del directorio /VAR\n+-------------------------------------------------------------------------------+\n\n## El desvio trata de quitarle escritura a OTHER, a ficheros que tienen escritura y ejecucion que cuelgan en el directorio /VAR y sub-directorios.\n\n+-------------------------------------------------------------------------------+\n## Hay que tener en cuenta el tipo de owner que pertenece, cada fichero o directorio BASE.\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Ya sea de tipo '/C/F/S/'\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Si es /C/, se pasa a excepcion con RISK e IMPACT\n(Por favor revisar la seccion de RISK e IMPACT)\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Si es de tipo /F/S/, se debe preguntar al owner, si podemos modificar los permisos\n## Revisar ('PERMISSIONS'), antes de cualquier cambio.\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Buscar y comprobar los fichero a cambiar permisos.\n+-------------------------------------------------------------------------------+\n\n## FICHEROS FORMA RECURVISA:\n---\necho \"ficheros con permisos w en other : \";find $fileVAR -type f -perm -o=wx | wc -l\nfind $fileVAR -type f -perm -o=wx | xargs -l ls -l\n\n## FICHERO\n---\nls -l $fichero\n\n+-------------------------------------------------------------------------------+\n## Pregunta RELACIONADAS\n+-------------------------------------------------------------------------------+\n\nProtecting Resources-mixed/Ensure sticky bit is set on all world-writable directories",        "copia": null,
        "editar": "+-------------------------------------------------------------------------------+\n## Se puede quitar de forma 'RECURSIVA' o por 'INDIVIDUAL'\n\n## VARIABLES:\n## $fileVAR : es la variable del directorio base de los ficheros a cambiar permisos.\n## $fichero : es la variable, del fichero a cambiar permiso.\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Asi quitamos de permisos de W a Other, en los ficheros('RECURSIVO'):\n+-------------------------------------------------------------------------------+\n\nfind $fileVAR -type f -perm -o=wx -exec chmod o-w {} \\;\n\n+-------------------------------------------------------------------------------+\n## Asi quitamos permisos, de W a other de forma('INDIVIDUAL'):\n+-------------------------------------------------------------------------------+\n\nchmod o-w $fichero",        
        "refrescar": null,
        "evidencia": "+-------------------------------------------------------------------------------+\n## De forma ('RECURSIVA'):\n+-------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nfind $fileVAR -type f -perm -o=wx | wc -l\nls -ld $fileVAR\n\n+-------------------------------------------------------------------------------+\n## De forma('INDIVIDUAL'):\n+-------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -l $fichero",        "SO": "Linux"
    },
    {
        "modulo": "Protecting Resources-OSRs/OSR /TMP Files Restrictions",
        "clave": "OSRTMP",
        "descripcion": "Invalid permissions for $fileTMP  Octal permissions: 0777  Text Permissions: -rwxrwxrwx-;  May not have execute permissions on any files and no write for others.",
        "comprobacion": "+-------------------------------------------------------------------------------+\n## Aplica a ficheros del directorio /TMP\n+-------------------------------------------------------------------------------+\n\n## El desvio trata de quitarle escritura a OTHER, a ficheros que tienen escritura y ejecucion que cuelgan en el directorio /TMP y sub-directorios.\n\n+-------------------------------------------------------------------------------+\n## Hay que tener en cuenta el tipo de owner que pertenece, cada fichero o directorio BASE.\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Ya sea de tipo '/C/F/S/'\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Si es /C/, se pasa a excepcion con RISK e IMPACT\n(Por favor revisar la seccion de RISK e IMPACT)\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Si es de tipo /F/S/, si podemos modificar los permisos de W a OTHER\n## Revisar ('PERMISSIONS'), antes de cualquier cambio.\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Buscar y comprobar los fichero a cambiar permisos.\n+-------------------------------------------------------------------------------+\n\n## FICHEROS FORMA RECURVISA:\n---\necho \"ficheros con permisos W en OTHER : \";find /tmp/ -type f -perm -o=wx | wc -l\n\n##Listar\n\nfind /tmp/ -type f -perm -o=wx | xargs -l ls -l\n\n## FICHERO INDIVIDUAL\n---\nls -l /tmp/$fichero\n\n+-------------------------------------------------------------------------------+\n## Pregunta RELACIONADAS\n+-------------------------------------------------------------------------------+\n\nProtecting Resources-mixed/Ensure sticky bit is set on all world-writable directories",
        "copia": null,
        "editar": "+-------------------------------------------------------------------------------+\n## Se puede quitar de forma 'RECURSIVA' o por 'INDIVIDUAL'\n\n## VARIABLES:\n## $fichero : es la variable, del fichero a cambiar permiso.\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Asi quitamos de permisos de W a Other, en los ficheros('RECURSIVO'):\n+-------------------------------------------------------------------------------+\n\nfind /tmp/ -type f -perm -o=wx -exec chmod o-w {} \\;\n\n+-------------------------------------------------------------------------------+\n## Asi quitamos permisos, de W a other de forma('INDIVIDUAL'):\n+-------------------------------------------------------------------------------+\n\nchmod o-w $fichero",        
        "refrescar": null,
        "evidencia": "+-------------------------------------------------------------------------------+\n## De forma ('RECURSIVA'):\n+-------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nfind /tmp/ -type f -perm -o=wx | wc -l\nls -ld /tmp/\n\n+-------------------------------------------------------------------------------+\n## De forma('INDIVIDUAL'):\n+-------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -l $fichero",
        "SO": "Aix"
    },
    {
        "modulo": "Protecting Resources-OSRs/OSR /OPT Files Restrictions",
        "clave": "OSROPT",
        "descripcion": "Invalid permissions for $fileOPT, Octal permissions: 0777, Text Permissions: -rwxrwxrwx;  May not have execute permissions on any files and no write for others.",
        "comprobacion": "+-------------------------------------------------------------------------------+\n## Aplica a ficheros del directorio /OPT\n+-------------------------------------------------------------------------------+\n\n## El desvio trata de quitarle escritura a OTHER, a ficheros que tienen escritura y ejecucion que cuelgan en el directorio /OPT y sub-directorios.\n\n+-------------------------------------------------------------------------------+\n## Hay que tener en cuenta el tipo de owner que pertenece, cada fichero o directorio BASE.\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Ya sea de tipo '/C/F/S/'\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Si es /C/, se pasa a excepcion con RISK e IMPACT\n(Por favor revisar la seccion de RISK e IMPACT)\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Si es de tipo /F/S/, se debe preguntar al owner, si podemos modificar los permisos\n## Revisar ('PERMISSIONS'), antes de cualquier cambio.\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Buscar y comprobar los fichero a cambiar permisos.\n+-------------------------------------------------------------------------------+\n\n## FICHEROS FORMA RECURVISA:\n---\necho \"ficheros con permisos w en other : \";find $fileOPT -type f -perm -o=wx | wc -l\nfind $fileOPT -type f -perm -o=wx | xargs -l ls -l\n\n## FICHERO\n---\nls -l $fichero\n\n+-------------------------------------------------------------------------------+\n## Pregunta RELACIONADAS\n+-------------------------------------------------------------------------------+\n\nProtecting Resources-mixed/Ensure sticky bit is set on all world-writable directories",
        "copia": null,
        "editar": "+-------------------------------------------------------------------------------+\n## Se puede quitar de forma 'RECURSIVA' o por 'INDIVIDUAL'\n\n## VARIABLES:\n## $fileOPT : es la variable del directorio base de los ficheros a cambiar permisos.\n## $fichero : es la variable, del fichero a cambiar permiso.\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Asi quitamos de permisos de W a Other, en los ficheros('RECURSIVO'):\n+-------------------------------------------------------------------------------+\n\nfind $fileOPT -type f -perm -o=wx -exec chmod o-w {} \\;\n\n+-------------------------------------------------------------------------------+\n## Asi quitamos permisos, de W a other de forma('INDIVIDUAL'):\n+-------------------------------------------------------------------------------+\n\nchmod o-w $fichero",
        "refrescar": null,
        "evidencia": "+-------------------------------------------------------------------------------+\n## De forma ('RECURSIVA'):\n+-------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nfind $fileOPT -type f -perm -o=wx | wc -l\nls -ld $fileOPT\n\n+-------------------------------------------------------------------------------+\n## De forma('INDIVIDUAL'):\n+-------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -l $fichero",
        "SO": "Aix"
    },
    {
        "modulo": "Protecting Resources-OSRs/OSR /ETC Restrictions",
        "clave": "OSRETC",
        "descripcion": "OSR Invalid Owner or Group: directoryETC / fileETC  Owner: ??  Group: ??  Permissions: -rwxr-xr-x  Settings for other must be r-x or more stringent. Must be owned by privileged Owner and Group",
        "comprobacion": "+-------------------------------------------------------------------------------+\n## Aplica a ficheros/directorios, sub-directorios, del directorio /ETC\n+-------------------------------------------------------------------------------+\n\n## El desvio trata de cambiar el owner y el grupo a GRUPOS y USUARIOS privilegiados(seccion 5.0), en ficheros / directorios -sub-directorios que cuelgan de /ETC.\n\n## Ademas de quitarle, permisos de escritura a other, a ficheros / directorios, sub-directorios, si existen dichos permisos.\n\n+-------------------------------------------------------------------------------+\n## Hay que tener en cuenta el tipo de owner que pertenece, cada fichero o directorio BASE.\n\n## Ya sea de tipo '/C/F/S'\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Si es /C/, se pasa a excepcion con RISK e IMPACT\n(por favor revisar la seccion de RISK e IMPACT)\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Si es de tipo /F/S/, se debe preguntar al ownern de la cuenta, si podemos modificar los permisos\n## Revisar ('PERMISSIONS'), antes de cualquier cambio.\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Buscar y comprobar los fichero y directorios a cambiar permisos. \n+-------------------------------------------------------------------------------+\n\n## DIRECTORIOS / FICHEROS FORMA RECURVISA con permisos W en OTHER:\n\necho \"directorios con permisos de w en OTHER: \";find $directory -type d -perm -o=w | wc -l\nfind $directory -type d -perm -o=w| xargs -l ls -ld\n\necho \"ficheros con permisos de w en OTHER: \";find $fileETC -type f -perm -o=w | wc -l\nfind $fileETC -type f -perm -o=w| xargs -l ls -ld\n\n## DIRECTORIOS / FICHEROS FORMA INDIVIDUAL:\n---\nls -l $fichero\nls -ld $directory\n\n+-------------------------------------------------------------------------------+\n## Pregunta RELACIONADAS\n+-------------------------------------------------------------------------------+\n\nProtecting Resources-mixed/Ensure sticky bit is set on all world-writable directories",
        "copia": null,
        "editar": "+-------------------------------------------------------------------------------+\n## Se puede cambiar el owner y el grupo de forma 'RECURSIVA' o por 'INDIVIDUAL'\n## Se puede cambiar permisos W en OTHER de forma 'RECURSIVA' o por 'INDIVIDUAL'\n\n## VARIABLES\n## $directory : es la variable del directorio BASE a cambiar permisos en directorios(RECURSIVO).\n## $fileETC : es la variable del directorio BASE a cambiar permisos en ficheros(RECURSIVO).\n## $fichero : es la vaariable del fichero a cambiar permisos(INDIVIDUAL).\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Asi cambiamos permisos de W a OTHER, en los directorios/ficheros ('RECURSIVO'):\n## Nota : pide confirmacion ('yes' or 'no').\n+-------------------------------------------------------------------------------+\n---\n## DIRECTORIOS:\n\nfind $directory -type d -perm -o=w -ok chmod o-w {} \\;\n\n---\n## FICHEROS:\n\nfind $fileETC -type f -perm -o=w -ok chmod o-w {} \\;\n\n+-------------------------------------------------------------------------------+\n## Asi cambiamos permisos de W a OTHER, de forma('INDIVIDUAL'):\n+-------------------------------------------------------------------------------+\n\nchmod o-w $fichero\n\n+-------------------------------------------------------------------------------+\n## Para cambiar cambiar a usuarios y grupo privilegiados, se debe saber a que grupo y usuario se debe cambiar.\n+-------------------------------------------------------------------------------+",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\nls -ld $directory\nls -l $fileETC",
        "SO": "Linux"
    },
    {
        "modulo": "Protecting Resources-OSRs/OSR /USR Restrictions",
        "clave": "OSRUSR",
        "descripcion": "OSR Invalid Owner or Group: directoryUSR / fileUSR  Owner: ??  Group: ??  Permissions: -rwxr-xr-x  Settings for other must be r-x or more stringent. Must be owned by privileged Owner and Group",
        "comprobacion": "+-------------------------------------------------------------------------------+\n## Aplica a ficheros/directorios, sub-directorios, del directorio /USR\n+-------------------------------------------------------------------------------+\n\n## El desvio trata de cambiar el owner y el grupo, a ficheros / directorios que cuelgan en el directorio /USR y sub-directorios.\n## Ademas de quitarle, permisos de escritura a other, a ficheros / directorios, sub-directorios, si existen.\n\n+-------------------------------------------------------------------------------+\n## Hay que tener en cuenta el tipo de owner que pertenece, cada fichero o directorio BASE.\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Ya sea de tipo '/C/F/S'\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Si es /C/, se pasa a excepcion con RISK e IMPACT\n## por favor revisar la seccion de RISK e IMPACT\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Si es de tipo /F/S/, se debe preguntar al owner, si podemos modificar los permisos\n## Revisar ('PERMISSIONS'), antes de cualquier cambio.\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Buscar y comprobar los fichero y directorios a cambiar permisos. \n+-------------------------------------------------------------------------------+\n\n## DIRECTORIOS / FICHEROS FORMA RECURVISA:\n---\necho \"directorios / ficheros con owner o grupo no compliance: \";find $directory -user $usuario -or -group $grupo | wc -l\nfind $directory -user $usuario -or -group $grupo | xargs -l ls -ld\n\n## DIRECTORIOS / FICHEROS FORMA INDIVIDUAL:\n---\nls -l $directory\nls -ld $directory\n\n+-------------------------------------------------------------------------------+\n## Pregunta RELACIONADAS\n+-------------------------------------------------------------------------------+\n\nProtecting Resources-mixed/Ensure sticky bit is set on all world-writable directories",
        "copia": null,
        "editar": "+-------------------------------------------------------------------------------+\n## Se puede cambiar el owner y el grupo de forma 'RECURSIVA' o por 'INDIVIDUAL'\n## $directory : es la variable del directorio BASE a cambiar permisos.\n## $fileTMP : es la variable del fichero a cambiar owner y group o directorio de los ficheros.\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Es cambiar de owner y grupo a grupos y usuarios privilegiados y darles permisos de lectura,ejecucion a other/grupo\n## Asi cambiamos el owner y el group, en los directorios/ficheros ('RECURSIVO'):\n## Nota : pide confirmacion ('yes' or 'no').\n+-------------------------------------------------------------------------------+\n\nfind $directory -user $usuario -ok chown root:root {} \\; -exec chmod 755 {} \\;\nfind $directory -group $grupo -ok chown root:root {} \\; -exec chmod 755 {} \\;\n\n+-------------------------------------------------------------------------------+\n## Asi cambiamos el owner y el group, de forma('individual'):\n+-------------------------------------------------------------------------------+\n\nchown root:root $directory;chmod 755 $directory\nchown root:root $fileUSR;chmod 755 $fileUSR",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\nls -ld $directory\nls -l $directory",
        "SO": "Linux"
    },
    {
        "modulo": "Protecting Resources-OSRs/OSR /etc/crontab Restrictions",
        "clave": "OSRCRONTAB",
        "descripcion": "/etc/crontab  Owner: root  Group: root  Permissions: -rw-r--r--.  should have \"rw- --- ---\" permissions (or more restrictive). Must be owned by user and group \"root\"",
        "comprobacion": "+-------------------------------------------------------------------------------+\n## Se cambian los permisos a : 600\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Pregunta relacionadas :\n+-------------------------------------------------------------------------------+\n\nProtecting Resources-OSRs/OSR /etc/crontab Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.hourly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.daily Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.weekly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.monthly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.d Restrictions\n",
        "copia": null,
        "editar": "chmod 600 /etc/crontab\n\n+-------------------------------------------------------------------------------+\n## Editar todas la relaciones\n+-------------------------------------------------------------------------------+\n\nchmod 600 /etc/crontab\nchmod 600 /etc/cron.hourly \nchmod 600 /etc/cron.daily \nchmod 600 /etc/cron.weekly \nchmod 600 /etc/cron.monthly \nchmod 600 /etc/cron.d",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\nls -ld /etc/crontab\n\n+-------------------------------------------------------------------------------+\n## Evidencia de todas las relaciones\n+-------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -ld /etc/crontab\nls -ld /etc/cron.hourly \nls -ld /etc/cron.daily \nls -ld /etc/cron.weekly \nls -ld /etc/cron.monthly \nls -ld /etc/cron.d",
        "SO": "Linux"
    },
    {
        "modulo": "Protecting Resources-OSRs/OSR /etc/cron.hourly Restrictions",
        "clave": "OSRHOURLY",
        "descripcion": "/etc/cron.hourly  Owner: root  Group: root  Permissions: drwxr-xr-x.  should have \"rwx --- ---\" permissions (or more restrictive). Must be owned by user and group \"root\"",
        "comprobacion": "+-------------------------------------------------------------------------------+\n## Se cambian los permisos a : 600\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Pregunta relacionadas :\n+-------------------------------------------------------------------------------+\n\nProtecting Resources-OSRs/OSR /etc/crontab Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.hourly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.daily Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.weekly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.monthly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.d Restrictions\n",
        "copia": null,
        "editar": "chmod 600 /etc/cron.hourly\n\n+-------------------------------------------------------------------------------+\n## Editar todas la relaciones\n+-------------------------------------------------------------------------------+\n\nchmod 600 /etc/crontab\nchmod 600 /etc/cron.hourly \nchmod 600 /etc/cron.daily \nchmod 600 /etc/cron.weekly \nchmod 600 /etc/cron.monthly \nchmod 600 /etc/cron.d",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\nls -ld /etc/cron.hourly\n\n+-------------------------------------------------------------------------------+\n## Evidencia de todas las relaciones\n+-------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -ld /etc/crontab\nls -ld /etc/cron.hourly \nls -ld /etc/cron.daily \nls -ld /etc/cron.weekly \nls -ld /etc/cron.monthly \nls -ld /etc/cron.d",
        "SO": "Linux"
    },
    {
        "modulo": "Protecting Resources-OSRs/OSR /etc/cron.daily Restrictions",
        "clave": "OSRDAILY",
        "descripcion": "/etc/cron.daily  Owner: root  Group: root  Permissions: drwxr-xr-x.  should have \"rwx --- ---\" permissions (or more restrictive). Must be owned by user and group \"root\"",
        "comprobacion": "+-------------------------------------------------------------------------------+\n## Se cambian los permisos a : 600\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Pregunta relacionadas :\n+-------------------------------------------------------------------------------+\n\nProtecting Resources-OSRs/OSR /etc/crontab Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.hourly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.daily Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.weekly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.monthly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.d Restrictions\n",
        "copia": null,
        "editar": "chmod 600 /etc/cron.daily\n\n+-------------------------------------------------------------------------------+\n## Editar todas la relaciones\n+-------------------------------------------------------------------------------+\n\nchmod 600 /etc/crontab\nchmod 600 /etc/cron.hourly \nchmod 600 /etc/cron.daily \nchmod 600 /etc/cron.weekly \nchmod 600 /etc/cron.monthly \nchmod 600 /etc/cron.d",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\nls -ld /etc/cron.daily\n\n+-------------------------------------------------------------------------------+\n## Evidencia de todas las relaciones\n+-------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -ld /etc/crontab\nls -ld /etc/cron.hourly \nls -ld /etc/cron.daily \nls -ld /etc/cron.weekly \nls -ld /etc/cron.monthly \nls -ld /etc/cron.d",
        "SO": "Linux"
    },
    {
        "modulo": "Protecting Resources-OSRs/OSR /etc/cron.weekly Restrictions",
        "clave": "OSRWEEKLY",
        "descripcion": "/etc/cron.weekly  Owner: root  Group: root  Permissions: drwxr-xr-x.  should have \"rwx --- ---\" permissions (or more restrictive). Must be owned by user and group \"root\"",
        "comprobacion": "+-------------------------------------------------------------------------------+\n## Se cambian los permisos a : 600\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Pregunta relacionadas :\n+-------------------------------------------------------------------------------+\n\nProtecting Resources-OSRs/OSR /etc/crontab Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.hourly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.daily Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.weekly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.monthly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.d Restrictions\n",
        "copia": null,
        "editar": "chmod 600 /etc/cron.weekly\n\n+-------------------------------------------------------------------------------+\n## Editar todas la relaciones\n+-------------------------------------------------------------------------------+\n\nchmod 600 /etc/crontab\nchmod 600 /etc/cron.hourly \nchmod 600 /etc/cron.daily \nchmod 600 /etc/cron.weekly \nchmod 600 /etc/cron.monthly \nchmod 600 /etc/cron.d",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\nls -ld /etc/cron.weekly\n\n+-------------------------------------------------------------------------------+\n## Evidencia de todas las relaciones\n+-------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -ld /etc/crontab\nls -ld /etc/cron.hourly \nls -ld /etc/cron.daily \nls -ld /etc/cron.weekly \nls -ld /etc/cron.monthly \nls -ld /etc/cron.d",
        "SO": "Linux"
    },
    {
        "modulo": "Protecting Resources-OSRs/OSR /etc/cron.monthly Restrictions",
        "clave": "OSRMONTHLY",
        "descripcion": "/etc/cron.monthly  Owner: root  Group: root  Permissions: drwxr-xr-x.  should have \"rwx --- ---\" permissions (or more restrictive). Must be owned by user and group \"root\"",
        "comprobacion": "+-------------------------------------------------------------------------------+\n## Se cambian los permisos a : 600\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Pregunta relacionadas :\n+-------------------------------------------------------------------------------+\n\nProtecting Resources-OSRs/OSR /etc/crontab Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.hourly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.daily Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.weekly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.monthly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.d Restrictions\n",
        "copia": null,
        "editar": "chmod 600 /etc/cron.monthly\n\n+-------------------------------------------------------------------------------+\n## Editar todas la relaciones\n+-------------------------------------------------------------------------------+\n\nchmod 600 /etc/crontab\nchmod 600 /etc/cron.hourly \nchmod 600 /etc/cron.daily \nchmod 600 /etc/cron.weekly \nchmod 600 /etc/cron.monthly \nchmod 600 /etc/cron.d",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\nls -ld /etc/cron.monthly\n\n+-------------------------------------------------------------------------------+\n## Evidencia de todas las relaciones\n+-------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -ld /etc/crontab\nls -ld /etc/cron.hourly \nls -ld /etc/cron.daily \nls -ld /etc/cron.weekly \nls -ld /etc/cron.monthly \nls -ld /etc/cron.d",
        "SO": "Linux"
    },
    {
        "modulo": "Protecting Resources-OSRs/OSR /etc/cron.d Restrictions",
        "clave": "OSRCRON.D",
        "descripcion": "/etc/cron.d  Owner: root  Group: root  Permissions: drwxr-xr-x.  should have \"rwx --- ---\" permissions (or more restrictive). Must be owned by user and group \"root\"",
        "comprobacion": "+-------------------------------------------------------------------------------+\n## Se cambian los permisos a : 600\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Pregunta relacionadas :\n+-------------------------------------------------------------------------------+\n\nProtecting Resources-OSRs/OSR /etc/crontab Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.hourly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.daily Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.weekly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.monthly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.d Restrictions\n",
        "copia": null,
        "editar": "chmod 600 /etc/cron.d\n\n+-------------------------------------------------------------------------------+\n## Editar todas la relaciones\n+-------------------------------------------------------------------------------+\n\nchmod 600 /etc/crontab\nchmod 600 /etc/cron.hourly \nchmod 600 /etc/cron.daily \nchmod 600 /etc/cron.weekly \nchmod 600 /etc/cron.monthly \nchmod 600 /etc/cron.d",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\nls -ld /etc/cron.d\n\n+-------------------------------------------------------------------------------+\n## Evidencia de todas las relaciones\n+-------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -ld /etc/crontab\nls -ld /etc/cron.hourly \nls -ld /etc/cron.daily \nls -ld /etc/cron.weekly \nls -ld /etc/cron.monthly \nls -ld /etc/cron.d",
        "SO": "Linux"
    },
    {
        "modulo": "AD.1.9.1.3 Protecting Resources - User Resources",
        "clave": "IBMSINIT.SH",
        "descripcion": "File /etc/profile.d/IBMsinit.sh must exist, be readable by all users, and contain at least:\nif [ $UID -gt 199 ]; then\numask 077\nfi",
        "comprobacion": "+-------------------------------------------------------------------------------+\n## Debe existir y con permisos 755 :\n+-------------------------------------------------------------------------------+\n\nls -la /etc/profile.d/IBMsinit.sh\n\n+-------------------------------------------------------------------------------+\n## Debe debe tener el script de UMASK:\n\nif [ $UID -gt 199 ]; then\numask 077\nfi\n\n+-------------------------------------------------------------------------------+\n\ncat /etc/profile.d/IBMsinit.sh\n\n+-------------------------------------------------------------------------------+\n## Debe tener implementado la invocacion a la llamada del fichero.\n. /etc/profile.d/IBMsinit.sh\n+-------------------------------------------------------------------------------+\n\ncat /etc/profile | grep -i \"IBMsinit.sh\"",        "copia": "+-------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------+\n\ncp -p /etc/profile.d/IBMsinit.sh /home/${user^^}/IBMsinit.sh_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------+\n\ncp -p /etc/profile.d/IBMsinit.sh /home/${user,,}/IBMsinit.sh_`date +%d%m%y_%T`",
        "editar": "+-------------------------------------------------------------------------------+\n## Creamos fichero y asignamos los permisos correctos.\n+-------------------------------------------------------------------------------+\n\ntouch /etc/profile.d/IBMsinit.sh\nchmod 0755 /etc/profile.d/IBMsinit.sh\n\n+-------------------------------------------------------------------------------+\n## Editar y añadir el siguiente SCRIPT:\n+-------------------------------------------------------------------------------+\n\nvi /etc/profile.d/IBMsinit.sh\n\n#--------- begin IBMsinit.sh ---------#\nif [ $UID -gt 199 ]; then\numask 077\nfi\n#--------- end IBMsinit.sh  ---------#\n\n+-------------------------------------------------------------------------------+\n## Ademas debemos implementar la invocacion a la llamada del fichero.\n## La invocacion se implementa despues de un script de UMASK.\n+-------------------------------------------------------------------------------+\n\nvi /etc/profile\n\n. /etc/profile.d/IBMsinit.sh",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\ncat /etc/profile.d/IBMsinit.sh\ncat /etc/profile  | grep -i  IBMsinit.sh\nls -l /etc/profile.d/IBMsinit.sh",
        "SO": "Linux"
    },
    {
        "modulo": "AD.1.9.1.4 Protecting Resources - User Resources",
        "clave": "IBMSINIT.CSH",
        "descripcion": "File /etc/profile.d/IBMsinit.csh must exist, be readable by all users, and contain at least:\nif ($uid > 199) then\n    umask 077\nendif",
        "comprobacion": "+-------------------------------------------------------------------------------+\n## Debe existir y con permisos 755 :\n+-------------------------------------------------------------------------------+\n\nls -la /etc/profile.d/IBMsinit.csh\n\n+-------------------------------------------------------------------------------+\n## Debe debe tener el script de UMASK:\n\nif ($uid > 199) then\n    umask 077\nendif\n\n+-------------------------------------------------------------------------------+\n\ncat /etc/profile.d/IBMsinit.csh\n\n+-------------------------------------------------------------------------------+\n## Debe tener implementado la invocacion a la llamada del fichero.\nsource /etc/profile.d/IBMsinit.csh\n+-------------------------------------------------------------------------------+\n\ncat /etc/csh.login | grep -i \"IBMsinit.csh\"",          "copia": "+-------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------+\n\ncp -p /etc/profile.d/IBMsinit.csh /home/${user^^}/IBMsinit.csh_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------+\n\ncp -p /etc/profile.d/IBMsinit.csh /home/${user,,}/IBMsinit.csh_`date +%d%m%y_%T`\n",
        "editar": "+-------------------------------------------------------------------------------+\n## Creamos fichero y asignamos los permisos correctos.\n+-------------------------------------------------------------------------------+\n\ntouch /etc/profile.d/IBMsinit.csh\nchmod 0755 /etc/profile.d/IBMsinit.csh\n\n+-------------------------------------------------------------------------------+\n## Editar y añadir el siguiente SCRIPT:\n+-------------------------------------------------------------------------------+\n\nvi /etc/profile.d/IBMsinit.csh\n\n#--------- begin IBMsinit.csh ---------#\nif ($uid > 199) then\n    umask 077\nendif\n#--------- end IBMsinit.csh  ---------#\n\n+-------------------------------------------------------------------------------+\n## Ademas debemos implementar la invocacion a la llamada del fichero.\n## La invocacion se implementa en la ultima linea.\n+-------------------------------------------------------------------------------+\n\nvi  /etc/csh.login\n\nsource /etc/profile.d/IBMsinit.csh",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\ncat /etc/profile.d/IBMsinit.csh\ncat /etc/csh.login  | grep -i  IBMsinit.csh\nls -l /etc/profile.d/IBMsinit.csh",
        "SO": "Linux"
    },
    {
        "modulo": "Protecting Resources-User Resources//etc/profile File Restriction",
        "clave": "INVOCATION.SH",
        "descripcion": "File does not  trigger an invocation of line . /etc/profile.d/IBMsinit.sh",
        "comprobacion": "+-------------------------------------------------------------------------------+\n## Debe existir la llamada a IBMsinit.sh, en /etc/profile\n+-------------------------------------------------------------------------------+\n\ncat /etc/profile | grep -i IBMsinit.sh\n\n+-------------------------------------------------------------------------------+\n## Relacionado con :\n+-------------------------------------------------------------------------------+\n\nAD.1.9.1.3 Protecting Resources - User Resources\nAD.1.9.1.4 Protecting Resources - User Resources\nProtecting Resources-OSRs/IBMsinit Permission Restriction",
        "copia": null,
        "editar": "+-------------------------------------------------------------------------------+\n## Añadir la linea : . /etc/profile.d/IBMsinit.sh\n## Despues de un script UMASK\n+-------------------------------------------------------------------------------+\n\nvi /etc/profile\n\n. /etc/profile.d/IBMsinit.sh",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\ncat /etc/profile | grep -i IBMsinit.sh",
        "SO": "Linux"
    },
    {
        "modulo": "Password Requirements/Password change date in the past",
        "clave": "",
        "descripcion": "",
        "comprobacion": "",
        "copia": "",
        "editar": "",
        "refrescar": "",
        "evidencia": "",
        "SO": "Linux"
    }
]
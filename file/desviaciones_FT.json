[
    {
        "modulo": "Protecting Resources-OSRs/Log File Restrictions",
        "clave": "WTMP",
        "descripcion": "Invalid Permissions or Ownership for log file: /var/log/wtmp;   -rw-rw-r--.;  owner:  root;   group:  utmp. For more information see rule description.",
        "comprobacion": "## Se le debe quitar W al grupo.\n\n+-------------------------------------------------------------------------------+\n## Comprobar que en logrotate.conf, tenga permisosa 0644\n+-------------------------------------------------------------------------------+\n\ncat /etc/logrotate.conf | grep -w wtmp -A4",
        "copia": "## Obtener usuario logueado:\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------+\n\ncp -p /etc/logrotate.conf /home/${user^^}/logrotate.conf_`date +%d%m%y`\n\n+-------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------+\n\ncp -p /etc/logrotate.conf /home/${user,,}/logrotate.conf_`date +%d%m%y`",
        "editar": "+-------------------------------------------------------------------------------+\n## Quitar permisos\n+-------------------------------------------------------------------------------+\n\nchmod g-w /var/log/wtmp\n\n+-------------------------------------------------------------------------------+\n## Dejar esta linea para REHL 7:\n+-------------------------------------------------------------------------------+\n\n## Editar:\n\nvi /lib/tmpfiles.d/var.conf\n\n## Debe quedar la linea asi:\n\nf /var/log/wtmp 0644 root utmp -\n\n+-------------------------------------------------------------------------------+\n## Dejar esta linea para REHL 6\n+-------------------------------------------------------------------------------+\n\n## Editar:\n\nvi /etc/rc.sysinit\n\n## Dejar la linea asi:\n\nchmod 0644 /var/run/utmp /var/log/wtmp\n\n+-------------------------------------------------------------------------------+\n## Corregir los permisos en logrotate.conf, en create de wtmp\n+-------------------------------------------------------------------------------+\n\nvi /etc/logrotate.conf\n\n+-------------------------------------------------------------------------------+\n## Modificar los permisos de 0664, a 0644, al fichero /var/log/wtmp\n+-------------------------------------------------------------------------------+",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\nls -la /var/log/wtmp\ncat /lib/tmpfiles.d/var.conf | grep -w wtmp\ncat /etc/logrotate.conf | grep -w wtmp -A4",
        "SO": "Linux"
    },
    {
        "modulo": "Protecting Resources-mixed/Ensure sticky bit is set on all world-writable directories",
        "clave": "STICKY",
        "descripcion": "Sticky bit is not set on world-writable directory: $directory",
        "comprobacion": "+-------------------------------------------------------------------------------+\n## Hay que tener en cuenta el tipo de owner que pertenece, cada directorio / RAIZ.\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Ya sea de tipo '/C/F/S'\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Si es /C/, se pasa a excepcion con RISK e IMPACT\n## por favor revisar la seccion de RISK e IMPACT\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Si es de tipo /F/S/, se debe preguntar al owner, si podemos modificar los permisos\n## Revisar ('DIRECTORY'), antes de cualquier cambio.\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Guardamos en la variable, el directorio a revisar\n+-------------------------------------------------------------------------------+\n\ndirectory=\"\"",
        "copia": "",
        "editar": "+-------------------------------------------------------------------------------+\n## Se puede quitar de forma 'recursiva' o por 'individual'\n## $directory : es la variable del directorio raiz a cambiar permisos.\n+-------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------+\n## Asi quitamos de permisos de W a Other, en los directorios('recursivo'):\n+-------------------------------------------------------------------------------+\n\nfind $directory -type d -perm -o=w -exec chmod o-w {} +\n\n+-------------------------------------------------------------------------------+\n## Asi quitamos de permisos de W a Other, en los ficheros('recursivo'):\n+-------------------------------------------------------------------------------+\n\nfind $directory -type f -perm -o=w -exec chmod o-w {} +\n\n+-------------------------------------------------------------------------------+\n## Asi quitamos permisos, de W a other de forma('individual'):\n+-------------------------------------------------------------------------------+\n\nchmod o-w $directory",
        "refrescar": "",
        "evidencia": "+-------------------------------------------------------------------------------+\n## De forma ('recursiva'):\n+-------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nfind $directory -type d -perm -o=wx | wc -l\nfind $directory -type f -perm -o=wx | wc -l\nls -ld $directory\n\n+-------------------------------------------------------------------------------+\n## De forma('individual'):\n+-------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -ld $directory",
        "SO": "Linux"
    },
    {
        "modulo": "protecting Resources-OSRs/SUDO Command WW Permissions",
        "clave": "COMMAND",
        "descripcion": "Invalid WW permissions for command file/directory: $fd_sudo  Permissions: drwxr-xrwx  Permissions for OTHER must be set to r-x or more stringent.",
        "comprobacion": "+-------------------------------------------------------------------------------+\n## Guardamos en la variable fd_sudo, el file/directory a cambiar permisos\n## Antes de seguir, buscar el file/directory en - * COMMAND * -\n+-------------------------------------------------------------------------------+\n\nfd_sudo=\"\"\n\n+-------------------------------------------------------------------------------+\n## Localizar la plantilla de SUDO, que tenga implementada el file/directory\n## Debemos mirar en la plantilla, si el file/directory, no se crean con los permisos de W en OTHER\n+-------------------------------------------------------------------------------+\n\ncd /etc/sudoers.d/\n\ngrep -irw $fd_sudo\n\n+-------------------------------------------------------------------------------+\n## Comprobar los permisos del file/directory:\n## No deben tener permisos de ESCRITURA en  OTHER\n## Si es de tipo /C/, se debe excepcionar: revisar RISK e IMPACT\n+-------------------------------------------------------------------------------+\n\nls -ld $fd_sudo",
        "copia": null,
        "editar": "+-------------------------------------------------------------------------------+\n## Quitar permisos de W a other al file/directory de SUDO\n+-------------------------------------------------------------------------------+\n\nchmod o-w $fd_sudo",
        "refrescar": null,
        "evidencia": "clear\ndate\nhostname\nls -ld $fd_sudo",
        "SO": "Linux"
    }
]